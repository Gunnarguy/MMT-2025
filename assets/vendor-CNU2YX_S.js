import{r as v,R as Ue}from"./react-TFhZ49XI.js";import{a as Me}from"./leaflet-DtPDPQxn.js";import{r as $e}from"./react-dom-DWW9Ss7k.js";var z={exports:{}},B={};var ae;function Fe(){return ae||(ae=1,(function(e){function t(c,f){var u=c.length;c.push(f);e:for(;0<u;){var w=u-1>>>1,_=c[w];if(0<a(_,f))c[w]=f,c[u]=_,u=w;else break e}}function n(c){return c.length===0?null:c[0]}function r(c){if(c.length===0)return null;var f=c[0],u=c.pop();if(u!==f){c[0]=u;e:for(var w=0,_=c.length,I=_>>>1;w<I;){var x=2*(w+1)-1,G=c[x],T=x+1,L=c[T];if(0>a(G,u))T<_&&0>a(L,G)?(c[w]=L,c[T]=u,w=T):(c[w]=G,c[x]=u,w=x);else if(T<_&&0>a(L,u))c[w]=L,c[T]=u,w=T;else break e}}return f}function a(c,f){var u=c.sortIndex-f.sortIndex;return u!==0?u:c.id-f.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var y=[],i=[],h=1,p=null,b=3,d=!1,m=!1,g=!1,O=!1,E=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;function D(c){for(var f=n(i);f!==null;){if(f.callback===null)r(i);else if(f.startTime<=c)r(i),f.sortIndex=f.expirationTime,t(y,f);else break;f=n(i)}}function M(c){if(g=!1,D(c),!m)if(n(y)!==null)m=!0,P||(P=!0,j());else{var f=n(i);f!==null&&F(M,f.startTime-c)}}var P=!1,R=-1,ee=5,te=-1;function ne(){return O?!0:!(e.unstable_now()-te<ee)}function $(){if(O=!1,P){var c=e.unstable_now();te=c;var f=!0;try{e:{m=!1,g&&(g=!1,W(R),R=-1),d=!0;var u=b;try{t:{for(D(c),p=n(y);p!==null&&!(p.expirationTime>c&&ne());){var w=p.callback;if(typeof w=="function"){p.callback=null,b=p.priorityLevel;var _=w(p.expirationTime<=c);if(c=e.unstable_now(),typeof _=="function"){p.callback=_,D(c),f=!0;break t}p===n(y)&&r(y),D(c)}else r(y);p=n(y)}if(p!==null)f=!0;else{var I=n(i);I!==null&&F(M,I.startTime-c),f=!1}}break e}finally{p=null,b=u,d=!1}f=void 0}}finally{f?j():P=!1}}}var j;if(typeof Z=="function")j=function(){Z($)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,He=re.port2;re.port1.onmessage=$,j=function(){He.postMessage(null)}}else j=function(){E($,0)};function F(c,f){R=E(function(){c(e.unstable_now())},f)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(c){c.callback=null},e.unstable_forceFrameRate=function(c){0>c||125<c?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<c?Math.floor(1e3/c):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(c){switch(b){case 1:case 2:case 3:var f=3;break;default:f=b}var u=b;b=f;try{return c()}finally{b=u}},e.unstable_requestPaint=function(){O=!0},e.unstable_runWithPriority=function(c,f){switch(c){case 1:case 2:case 3:case 4:case 5:break;default:c=3}var u=b;b=c;try{return f()}finally{b=u}},e.unstable_scheduleCallback=function(c,f,u){var w=e.unstable_now();switch(typeof u=="object"&&u!==null?(u=u.delay,u=typeof u=="number"&&0<u?w+u:w):u=w,c){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=u+_,c={id:h++,callback:f,priorityLevel:c,startTime:u,expirationTime:_,sortIndex:-1},u>w?(c.sortIndex=u,t(i,c),n(y)===null&&c===n(i)&&(g?(W(R),R=-1):g=!0,F(M,u-w))):(c.sortIndex=_,t(y,c),m||d||(m=!0,P||(P=!0,j()))),c},e.unstable_shouldYield=ne,e.unstable_wrapCallback=function(c){var f=b;return function(){var u=b;b=f;try{return c.apply(this,arguments)}finally{b=u}}}})(B)),B}var se;function ct(){return se||(se=1,z.exports=Fe()),z.exports}function oe(e,t){const n=v.useRef(t);v.useEffect(function(){t!==n.current&&e.attributionControl!=null&&(n.current!=null&&e.attributionControl.removeAttribution(n.current),t!=null&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}const Ge=1;function it(e){return Object.freeze({__version:Ge,map:e})}function ut(e,t){return Object.freeze({...e,...t})}const ce=v.createContext(null);function V(){const e=v.use(ce);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function ie(e){function t(n,r){const{instance:a,context:s}=e(n).current;v.useImperativeHandle(r,()=>a);const{children:o}=n;return o==null?null:Ue.createElement(ce,{value:s},o)}return v.forwardRef(t)}function ze(e){function t(n,r){const[a,s]=v.useState(!1),{instance:o}=e(n,s).current;v.useImperativeHandle(r,()=>o),v.useEffect(function(){a&&o.update()},[o,a,n.children]);const l=o._contentNode;return l?$e.createPortal(n.children,l):null}return v.forwardRef(t)}function Be(e){function t(n,r){const{instance:a}=e(n).current;return v.useImperativeHandle(r,()=>a),null}return v.forwardRef(t)}function K(e,t){const n=v.useRef(void 0);v.useEffect(function(){return t!=null&&e.instance.on(t),n.current=t,function(){n.current!=null&&e.instance.off(n.current),n.current=null}},[e,t])}function Q(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}function Xe(e,t){return function(r,a){const s=V(),o=e(Q(r,s),s);return oe(s.map,r.attribution),K(o.current,r.eventHandlers),t(o.current,s,r,a),o}}function lt(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function H(e,t){return t==null?function(r,a){const s=v.useRef(void 0);return s.current||(s.current=e(r,a)),s}:function(r,a){const s=v.useRef(void 0);s.current||(s.current=e(r,a));const o=v.useRef(r),{instance:l}=s.current;return v.useEffect(function(){o.current!==r&&(t(l,r,o.current),o.current=r)},[l,r,t]),s}}function ue(e,t){v.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){t.layerContainer?.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function le(e){return function(n){const r=V(),a=e(Q(n,r),r);return oe(r.map,n.attribution),K(a.current,n.eventHandlers),ue(a.current,r),a}}function Je(e,t){const n=v.useRef(void 0);v.useEffect(function(){if(t.pathOptions!==n.current){const a=t.pathOptions??{};e.instance.setStyle(a),n.current=a}},[e,t])}function Ve(e){return function(n){const r=V(),a=e(Q(n,r),r);return K(a.current,n.eventHandlers),ue(a.current,r),Je(a.current,n),a}}function ft(e,t){const n=H(e,t),r=le(n);return ie(r)}function pt(e,t){const n=H(e),r=Xe(n,t);return ze(r)}function dt(e,t){const n=H(e,t),r=Ve(n);return ie(r)}function yt(e,t){const n=H(e,t),r=le(n);return Be(r)}function ht(e,t,n){const{opacity:r,zIndex:a}=t;r!=null&&r!==n.opacity&&e.setOpacity(r),a!=null&&a!==n.zIndex&&e.setZIndex(a)}var X=function(e,t){return X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])},X(e,t)};function fe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");X(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var q=function(){return q=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},q.apply(this,arguments)};function pe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function de(e,t,n,r){var a=arguments.length,s=a<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s}function ye(e,t){return function(n,r){t(n,r,e)}}function he(e,t,n,r,a,s){function o(E){if(E!==void 0&&typeof E!="function")throw new TypeError("Function expected");return E}for(var l=r.kind,y=l==="getter"?"get":l==="setter"?"set":"value",i=!t&&e?r.static?e:e.prototype:null,h=t||(i?Object.getOwnPropertyDescriptor(i,r.name):{}),p,b=!1,d=n.length-1;d>=0;d--){var m={};for(var g in r)m[g]=g==="access"?{}:r[g];for(var g in r.access)m.access[g]=r.access[g];m.addInitializer=function(E){if(b)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(E||null))};var O=(0,n[d])(l==="accessor"?{get:h.get,set:h.set}:h[y],m);if(l==="accessor"){if(O===void 0)continue;if(O===null||typeof O!="object")throw new TypeError("Object expected");(p=o(O.get))&&(h.get=p),(p=o(O.set))&&(h.set=p),(p=o(O.init))&&a.unshift(p)}else(p=o(O))&&(l==="field"?a.unshift(p):h[y]=p)}i&&Object.defineProperty(i,r.name,h),b=!0}function be(e,t,n){for(var r=arguments.length>2,a=0;a<t.length;a++)n=r?t[a].call(e,n):t[a].call(e);return r?n:void 0}function me(e){return typeof e=="symbol"?e:"".concat(e)}function we(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function ve(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function _e(e,t,n,r){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(h){try{i(r.next(h))}catch(p){o(p)}}function y(h){try{i(r.throw(h))}catch(p){o(p)}}function i(h){h.done?s(h.value):a(h.value).then(l,y)}i((r=r.apply(e,t||[])).next())})}function ge(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,a,s,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(i){return function(h){return y([i,h])}}function y(i){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(n=0)),n;)try{if(r=1,a&&(s=i[0]&2?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[i[0]&2,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return n.label++,{value:i[1],done:!1};case 5:n.label++,a=i[1],i=[0];continue;case 7:i=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(i[0]===6||i[0]===2)){n=0;continue}if(i[0]===3&&(!s||i[1]>s[0]&&i[1]<s[3])){n.label=i[1];break}if(i[0]===6&&n.label<s[1]){n.label=s[1],s=i;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(i);break}s[2]&&n.ops.pop(),n.trys.pop();continue}i=t.call(e,n)}catch(h){i=[6,h],a=0}finally{r=s=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}var U=Object.create?(function(e,t,n,r){r===void 0&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}):(function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]});function Oe(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&U(t,e,n)}function A(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Y(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),a,s=[],o;try{for(;(t===void 0||t-- >0)&&!(a=r.next()).done;)s.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function Ee(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Y(arguments[t]));return e}function Te(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),a=0,t=0;t<n;t++)for(var s=arguments[t],o=0,l=s.length;o<l;o++,a++)r[a]=s[o];return r}function Pe(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,s;r<a;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}function C(e){return this instanceof C?(this.v=e,this):new C(e)}function je(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),a,s=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),a[Symbol.asyncIterator]=function(){return this},a;function o(d){return function(m){return Promise.resolve(m).then(d,p)}}function l(d,m){r[d]&&(a[d]=function(g){return new Promise(function(O,E){s.push([d,g,O,E])>1||y(d,g)})},m&&(a[d]=m(a[d])))}function y(d,m){try{i(r[d](m))}catch(g){b(s[0][3],g)}}function i(d){d.value instanceof C?Promise.resolve(d.value.v).then(h,p):b(s[0][2],d)}function h(d){y("next",d)}function p(d){y("throw",d)}function b(d,m){d(m),s.shift(),s.length&&y(s[0][0],s[0][1])}}function Se(e){var t,n;return t={},r("next"),r("throw",function(a){throw a}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(a,s){t[a]=e[a]?function(o){return(n=!n)?{value:C(e[a](o)),done:!1}:s?s(o):o}:s}}function Ce(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof A=="function"?A(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(l,y){o=e[s](o),a(l,y,o.done,o.value)})}}function a(s,o,l,y){Promise.resolve(y).then(function(i){s({value:i,done:l})},o)}}function Re(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var Ke=Object.create?(function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}):function(e,t){e.default=t},J=function(e){return J=Object.getOwnPropertyNames||function(t){var n=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[n.length]=r);return n},J(e)};function Ne(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n=J(e),r=0;r<n.length;r++)n[r]!=="default"&&U(t,e,n[r]);return Ke(t,e),t}function De(e){return e&&e.__esModule?e:{default:e}}function Ie(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)}function xe(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n}function Le(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function ke(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,a;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(a=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");a&&(r=function(){try{a.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var Qe=typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function qe(e){function t(s){e.error=e.hasError?new Qe(s,e.error,"An error was suppressed during disposal."):s,e.hasError=!0}var n,r=0;function a(){for(;n=e.stack.pop();)try{if(!n.async&&r===1)return r=0,e.stack.push(n),Promise.resolve().then(a);if(n.dispose){var s=n.dispose.call(n.value);if(n.async)return r|=2,Promise.resolve(s).then(a,function(o){return t(o),a()})}else r|=1}catch(o){t(o)}if(r===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return a()}function Ae(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,r,a,s,o){return r?t?".jsx":".js":a&&(!s||!o)?n:a+s+"."+o.toLowerCase()+"js"}):e}const Ye={__extends:fe,__assign:q,__rest:pe,__decorate:de,__param:ye,__esDecorate:he,__runInitializers:be,__propKey:me,__setFunctionName:we,__metadata:ve,__awaiter:_e,__generator:ge,__createBinding:U,__exportStar:Oe,__values:A,__read:Y,__spread:Ee,__spreadArrays:Te,__spreadArray:Pe,__await:C,__asyncGenerator:je,__asyncDelegator:Se,__asyncValues:Ce,__makeTemplateObject:Re,__importStar:Ne,__importDefault:De,__classPrivateFieldGet:Ie,__classPrivateFieldSet:xe,__classPrivateFieldIn:Le,__addDisposableResource:ke,__disposeResources:qe,__rewriteRelativeImportExtension:Ae},We=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:ke,get __assign(){return q},__asyncDelegator:Se,__asyncGenerator:je,__asyncValues:Ce,__await:C,__awaiter:_e,__classPrivateFieldGet:Ie,__classPrivateFieldIn:Le,__classPrivateFieldSet:xe,__createBinding:U,__decorate:de,__disposeResources:qe,__esDecorate:he,__exportStar:Oe,__extends:fe,__generator:ge,__importDefault:De,__importStar:Ne,__makeTemplateObject:Re,__metadata:ve,__param:ye,__propKey:me,__read:Y,__rest:pe,__rewriteRelativeImportExtension:Ae,__runInitializers:be,__setFunctionName:we,__spread:Ee,__spreadArray:Pe,__spreadArrays:Te,__values:A,default:Ye},Symbol.toStringTag,{value:"Module"})),bt=Me(We);var N=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Ze(e,t,n){const r=new URL(t,e);if(n)for(const[a,s]of Object.entries(n))s!==void 0&&r.searchParams.set(a,s);return r.toString()}async function et(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function tt(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:n,path:r,query:a,body:s,headers:o}){const l=Ze(e.baseUrl,r,a),y=await et(e.auth),i=await t(l,{method:n,headers:{...s?{"Content-Type":"application/json"}:{},...y,...o},body:s?JSON.stringify(s):void 0}),h=await i.text(),p=(i.headers.get("content-type")||"").includes("application/json"),b=p&&h?JSON.parse(h):h;if(!i.ok){const d=p?b:void 0,m=d?.error;throw new N(m?.message??`Request failed with status ${i.status}`,{status:i.status,icebergType:m?.type,icebergCode:m?.code,details:d})}return{status:i.status,headers:i.headers,data:b}}}}function k(e){return e.join("")}var nt=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:k(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(e,t){const n={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${k(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${k(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${k(e.namespace)}`}),!0}catch(t){if(t instanceof N&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(n){if(n instanceof N&&n.status===409)return;throw n}}};function S(e){return e.join("")}var rt=class{constructor(e,t="",n){this.client=e,this.prefix=t,this.accessDelegation=n}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables`,body:t,headers:n})).data.metadata}async updateTable(e,t){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(n){if(n instanceof N&&n.status===404)return!1;throw n}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(n){if(n instanceof N&&n.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw n}}},mt=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const n=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=tt({baseUrl:n,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new nt(this.client,t),this.tableOps=new rt(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};export{mt as I,ce as L,_e as _,ft as a,lt as b,it as c,dt as d,ut as e,pt as f,yt as g,ht as h,bt as i,pe as j,ct as r,V as u,Q as w};
