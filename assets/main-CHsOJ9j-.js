import{j as e,r as i}from"./react-TFhZ49XI.js";import{c as Mt}from"./react-dom-DsMqZ5-k.js";import{L as Qe}from"./leaflet-DtPDPQxn.js";import{c as St}from"./supabase-BoO8gozo.js";import{M as Je,T as Xe,P as Ze,a as et,b as tt,u as at}from"./react-leaflet-CemhJ2VY.js";import{D as st,c as ot,a as nt,u as Ct,S as it,v as rt,b as lt,C as ct}from"./dnd-kit-DJ0dgYez.js";import"./vendor-DXeJoHR3.js";delete Qe.Icon.Default.prototype._getIconUrl;Qe.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});function At({activeView:t,onViewChange:a,tripStats:s,templates:l,selectedTemplateId:m,onLoadTemplate:u,onSaveTemplate:c,syncStatus:g,user:p,onSignOut:n}){return e.jsxs("header",{className:"header",children:[e.jsxs("div",{className:"header-brand",children:[e.jsxs("div",{className:"brand-title",children:[e.jsx("h1",{children:"MMT 2025"}),e.jsx("span",{className:"tagline",children:"Girls Trip to New England"}),g&&e.jsxs("span",{className:`sync-badge ${g}`,title:g==="synced"?"All changes saved to cloud":g==="syncing"?"Syncing changes...":g==="offline"?"Working offline":"",children:[g==="synced"&&"â˜ï¸ Synced",g==="syncing"&&"â³ Syncing...",g==="offline"&&"ðŸ“´ Offline"]})]}),e.jsx("p",{className:"brand-subtitle",children:"Plan, remix, and build the trip that feels perfect."})]}),e.jsxs("div",{className:"header-nav",children:[e.jsx("button",{type:"button",className:`nav-btn ${t==="moms"?"active":""}`,onClick:()=>a("moms"),children:"Mom's Route"}),e.jsx("button",{type:"button",className:`nav-btn ${t==="builder"?"active":""}`,onClick:()=>a("builder"),children:"Build & Customize"})]}),e.jsx("div",{className:"header-actions",children:t==="builder"&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"template-select",value:m||"",onChange:f=>f.target.value&&u(f.target.value),children:[e.jsx("option",{value:"",children:"Load a template..."}),l.map(f=>e.jsxs("option",{value:f.id,children:[f.emoji," ",f.name]},f.id))]}),e.jsx("button",{type:"button",className:"btn-primary",onClick:c,children:"Save as Template"})]})}),e.jsxs("div",{className:"header-stats",children:[e.jsxs("span",{className:"stat-chip",children:[s.days," days"]}),e.jsxs("span",{className:"stat-chip",children:[s.activities," activities"]})]}),p&&e.jsxs("div",{className:"header-user",children:[e.jsxs("span",{className:"user-email",title:p.email,children:["ðŸ‘¤ ",p.email.split("@")[0]]}),e.jsx("button",{type:"button",className:"btn-signout",onClick:n,title:"Sign out",children:"Sign Out"})]})]})}const Tt="https://miihwxxgqyyotptiihej.supabase.co",dt="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1paWh3eHhncXl5b3RwdGlpaGVqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY4ODg0MDEsImV4cCI6MjA4MjQ2NDQwMX0.lq2BH0iG1891KyvhCcJ0cHJunuLRTcDtk2W1jvQ0V5w",be=!!dt,U=be?St(Tt,dt):null,Bt=["italgalpal@gmail.com","mikaelahostetler@gmail.com","gunnarguy@me.com"];function ye(t){return Bt.includes(t?.toLowerCase())}async function Et(t){if(!U)return{data:null,error:new Error("Supabase not configured")};if(!ye(t))return{data:null,error:new Error("This email is not authorized to access this trip planner.")};const{data:a,error:s}=await U.auth.signInWithOtp({email:t,options:{emailRedirectTo:window.location.origin+window.location.pathname}});return{data:a,error:s}}async function Rt(){return U?await U.auth.signOut():{error:null}}async function Lt(){return U?await U.auth.getSession():{data:{session:null},error:null}}function Dt(t){return U?U.auth.onAuthStateChange(t):{data:{subscription:{unsubscribe:()=>{}}}}}const De="mmt_shared_trip",ut="mmt-2025-maine";async function It(t=ut){if(!U)return{data:null,error:new Error("Supabase not configured")};const{data:a,error:s}=await U.from(De).select("id,state,updated_at").eq("id",t).maybeSingle();return{data:a,error:s}}async function Fe(t,a=ut){if(!U)return{data:null,error:new Error("Supabase not configured")};const{data:s,error:l}=await U.from(De).upsert({id:a,state:t},{onConflict:"id"}).select("id,state,updated_at").single();return{data:s,error:l}}function Ot(t,a){if(!U)return{unsubscribe:()=>{}};const s=U.channel(`shared-trip:${t}`).on("postgres_changes",{event:"*",schema:"public",table:De,filter:`id=eq.${t}`},l=>{a?.(l)}).subscribe();return{unsubscribe:()=>{U.removeChannel(s)}}}function Pt(){const[t,a]=i.useState(""),[s,l]=i.useState("idle"),[m,u]=i.useState(""),c=async g=>{if(g.preventDefault(),l("sending"),u(""),!ye(t)){l("error"),u("Sorry, this email isn't on the guest list! ðŸ¦ž");return}const{error:p}=await Et(t);p?(l("error"),u(p.message)):l("sent")};return e.jsxs("div",{className:"login-screen",children:[e.jsxs("div",{className:"login-card",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("span",{className:"login-emoji",children:"ðŸ¦ž"}),e.jsx("h1",{children:"Maine Mom Trip 2025"}),e.jsx("p",{className:"login-subtitle",children:"Family-only access"})]}),s==="sent"?e.jsxs("div",{className:"login-success",children:[e.jsx("span",{className:"success-emoji",children:"âœ‰ï¸"}),e.jsx("h2",{children:"Check your email!"}),e.jsxs("p",{children:["We sent a magic link to ",e.jsx("strong",{children:t})]}),e.jsx("p",{className:"login-hint",children:"Click the link in the email to sign in. It might take a minute!"}),e.jsx("button",{className:"btn-outline login-btn",onClick:()=>l("idle"),children:"Try a different email"})]}):e.jsxs("form",{onSubmit:c,className:"login-form",children:[e.jsx("label",{htmlFor:"email",children:"Enter your email to get access:"}),e.jsx("input",{id:"email",type:"email",placeholder:"your@email.com",value:t,onChange:g=>a(g.target.value),required:!0,disabled:s==="sending",autoFocus:!0}),s==="error"&&e.jsx("div",{className:"login-error",children:m}),e.jsx("button",{type:"submit",className:"btn-primary login-btn",disabled:s==="sending",children:s==="sending"?"â³ Sending...":"ðŸ” Send Magic Link"}),e.jsx("p",{className:"login-hint",children:"Only family members can access this trip planner. If you're not on the list, ask Gunnar!"})]})]}),e.jsx("div",{className:"login-footer",children:e.jsx("span",{children:"ðŸŒŠ Planning adventures since 2025"})})]})}const R={title:"Girls Trip to New England",subtitle:"Suggested drive-first adventure with tons of flexibility",themeLine:"Lobsters - Leaves - Love",travelWindow:"Late September to October 2025",overview:{duration:"7-9 days",totalMiles:"~780 miles",driveTime:"~16 hours total",flyIn:"Boston (BOS)",flyOut:"Albany (ALB) or Boston (BOS)"},warnings:[{title:"Leaf-peeping surge",detail:"Late September weekends bring heavy traffic across New England."},{title:"This is a suggested route",detail:"Stop, hike, or swap days as you want. Nothing is locked in."},{title:"Flex days baked in",detail:"If a place feels too rushed, add a night and slide the rest."}],ribbonStops:[{id:"boston",name:"Boston",nights:"1-2",drive:"Arrive",emoji:"ðŸ™ï¸"},{id:"portland",name:"Portland",nights:"1",drive:"2 hrs",emoji:"ðŸ¦ž"},{id:"chelsea",name:"Chelsea",nights:"1-2",drive:"3.5 hrs",emoji:"ðŸ"},{id:"montreal",name:"Montreal",nights:"2",drive:"2.5 hrs",emoji:"ðŸ¥¯"},{id:"saratoga",name:"Saratoga",nights:"1",drive:"4 hrs",emoji:"ðŸ”ï¸"},{id:"albany",name:"Albany",nights:"Fly out",drive:"1.5 hrs",emoji:"âœˆï¸"}],featuredMoments:[{title:"First lobster in Boston",detail:"Lean into history, walkable neighborhoods, and the first iconic roll.",stopId:"boston"},{title:"Sally's Vermont retreat",detail:"Stay on the property, walk the land, and slow the pace for a day.",stopId:"chelsea"},{title:"International detour",detail:"Montreal for bagels, smoked meat, and a full city reset.",stopId:"montreal"}],stops:[{id:"boston",title:"Boston, MA",dayRange:"Days 1-2",nights:"1-2 nights",driveTime:"Arrival base",notes:"Use the arrival day and perhaps the next day for touring the city and eating some lobster.",momQuote:"The city is full of history, of course.",location:"Boston, MA",activities:["landmark-freedom-trail","lobster-neptune"],lodging:"lodge-godfrey-boston",highlights:["Walkable neighborhoods","Freedom Trail","Classic seafood"]},{id:"portland",title:"Coastal drive to Portland, ME",dayRange:"Day 3",nights:"1 night",driveTime:"About 2 hours",notes:"Drive up the coast to Portland and stay one night. Route 1 is the slow and scenic option.",momQuote:"Hit the harbor towns along the way.",location:"Portland, ME",activities:["drive-route-1-coast","town-ogunquit","town-kennebunkport","lobster-clam-shack","lobster-chauncey","town-portland-old-port"],lodging:"lodge-press-portland",highlights:["Harbor towns","Coastal lobster shacks","Old Port stroll"]},{id:"chelsea",title:"Chelsea, VT via Concord, NH",dayRange:"Days 4-5",nights:"1-2 nights",driveTime:"About 3.5 hours",notes:"Stay a night at Sally's in Chelsea. Concord can just be a stopping place on the way.",momQuote:"We can do some serious walking or hiking right on the property.",location:"Chelsea, VT",activities:["drive-kancamagus","hike-sabbaday-falls","foliage-hancock-overlook","landmark-albany-covered-bridge","hike-sallys-property","foliage-chelsea-vermont"],lodging:"lodge-sallys",highlights:["Kancamagus Highway","Property hikes","Vermont foliage"]},{id:"montreal",title:"Montreal, QC via Burlington, VT",dayRange:"Days 6-7",nights:"2 nights",driveTime:"About 2.5 hours",notes:"Burlington is a nice stopping place on the way up. Montreal is the main city adventure.",momQuote:"Explore Montreal. Bagels, smoked meat, Mount Royal, poutine.",location:"Montreal, QC",activities:["food-cold-hollow","food-ben-jerrys","landmark-notre-dame","food-st-viateur","food-schwartzs","hike-mount-royal","food-la-banquise"],lodging:"lodge-petit-montreal",highlights:["Old Montreal","Bagel crawl","Mount Royal views"]},{id:"saratoga",title:"Adirondacks to Saratoga Springs, NY",dayRange:"Day 8",nights:"1 night",driveTime:"About 4 hours",notes:"Drive via Lake Placid if you want the detour before Saratoga Springs.",momQuote:"This is the optional continuation before heading to Albany.",location:"Saratoga Springs, NY",activities:["foliage-lake-placid","drive-whiteface"],lodging:"lodge-adelphi-saratoga",highlights:["Lake Placid detour","Adirondack peaks","Historic downtown"]},{id:"albany",title:"Albany, NY departure",dayRange:"Day 9",nights:"Fly out",driveTime:"About 1.5 hours",notes:"Fly home from Albany or keep driving toward Stockbridge/Boston.",momQuote:"We can stop and fly home from Albany.",location:"Albany, NY",activities:[],lodging:null,highlights:["Easy fly-out","Gateway to Berkshires"]}],foliage:{peakWindows:["Late September in high elevations","Early to mid October in Vermont","Mid October in coastal Maine"],bestDrives:["Kancamagus Highway","Route 100 in Vermont","Coastal Route 1"]},budget:{tiers:[{name:"Budget",range:"$175-250 per day",detail:"Mix of casual meals, free hikes, and simple lodging."},{name:"Comfort",range:"$275-375 per day",detail:"Better lodging plus a few splurge meals."},{name:"Treat-Yourself",range:"$400+ per day",detail:"Boutique hotels, tours, and big food moments."}],tips:["Book lodging early for foliage season.","Save splurges for Boston and Montreal.","Pack snacks for scenic drives."]},packing:{weatherNote:"Expect crisp mornings, warm afternoons, and surprise rain. Layers win.",essentials:["Comfortable walking shoes","Light rain jacket","Daypack","Portable charger","Refillable water bottle"],extras:["Camera or good phone lens","Cozy sweater","Binoculars for foliage","Picnic blanket","Reusable tote"]},alternatives:[{title:"Berkshires finish",detail:"Continue to Stockbridge, MA for Ice Glen and Laura's Tower hikes before Boston.",addsDays:1,flyOut:"Boston (BOS)",activities:["hike-ice-glen"]},{title:"Finger Lakes extension",detail:"Explore the Finger Lakes region with wineries and waterfalls.",addsDays:2,flyOut:"Albany (ALB)",activities:[]},{title:"Massachusetts detour",detail:"Spend extra days in western Massachusetts and fly out of Boston.",addsDays:1,flyOut:"Boston (BOS)",activities:[]},{title:"Southern dip",detail:"Dip into Connecticut or Rhode Island if you want more coastal time.",addsDays:1,flyOut:"Providence (PVD) or Boston (BOS)",activities:[]}],wildcards:["Alternate trips could be Carolinas, Virginia, Tennessee, or Kentucky.","Another idea: Southern Illinois, Kentucky, Missouri loop.","Or switch coasts and do a west coast northern route."]},Z={lobster:{id:"lobster",name:"Lobster Spots",icon:"ðŸ¦ž",color:"#9b7dd4",description:"The best lobster rolls and seafood shacks"},town:{id:"town",name:"Harbor Towns",icon:"âš“",color:"#8b6bba",description:"Charming coastal villages to explore"},hike:{id:"hike",name:"Hikes & Nature",icon:"ðŸ¥¾",color:"#7b5caa",description:"Trails, waterfalls, and outdoor adventures"},drive:{id:"drive",name:"Scenic Drives",icon:"ðŸš—",color:"#8a6dc2",description:"Beautiful routes through mountains and coast"},foliage:{id:"foliage",name:"Foliage Spots",icon:"ðŸ",color:"#9878cc",description:"Best fall color viewing locations"},city:{id:"city",name:"Cities",icon:"ðŸ™ï¸",color:"#7b5caa",description:"Major city destinations"},food:{id:"food",name:"Food & Dining",icon:"ðŸ½ï¸",color:"#9b7dd4",description:"Restaurants, cafes, and food experiences"},landmark:{id:"landmark",name:"Landmarks",icon:"ðŸ“¸",color:"#8b6bba",description:"Must-see attractions and photo spots"},lodging:{id:"lodging",name:"Lodging",icon:"ðŸ¨",color:"#8a6dc2",description:"Hotels, B&Bs, and places to stay"},custom:{id:"custom",name:"Custom",icon:"â­",color:"#9878cc",description:"Places you add yourself"}},$t={boston:{id:"boston",name:"Boston Area",state:"MA"},maine_coast:{id:"maine_coast",name:"Maine Coast",state:"ME"},portland:{id:"portland",name:"Portland Area",state:"ME"},white_mountains:{id:"white_mountains",name:"White Mountains",state:"NH"},vermont:{id:"vermont",name:"Vermont",state:"VT"},montreal:{id:"montreal",name:"Montreal",state:"QC"},adirondacks:{id:"adirondacks",name:"Adirondacks",state:"NY"},saratoga:{id:"saratoga",name:"Saratoga/Albany",state:"NY"},berkshires:{id:"berkshires",name:"Berkshires",state:"MA"}},mt=[{id:"lobster-eventide",category:"lobster",name:"Eventide Oyster Co.",region:"portland",location:"Portland, ME",address:"86 Middle St, Portland, ME 04101",coordinates:[43.6573,-70.2515],phone:"(207) 774-8538",website:"https://www.eventideoysterco.com",hours:"11amâ€“10pm daily",reservations:"No reservations",duration:1.5,price:"$$$",priceRange:"$25-45/person",rating:4.9,yelpRating:4.5,googleRating:4.7,reviewCount:2800,description:"James Beard Award winner with the famous brown butter lobster roll on a steamed bao-style bun.",mustTry:"Brown Butter Lobster Roll",tip:"Go at 3pm between lunch and dinner rush. No reservations.",waitTime:"30-60 min",bestTime:"3pm weekdays",parking:"Street parking, metered",tags:["james-beard","innovative","must-visit"],momMentioned:!1,source:"research"},{id:"lobster-neptune",category:"lobster",name:"Neptune Oyster",region:"boston",location:"Boston, MA",address:"63 Salem St, Boston, MA 02113",coordinates:[42.3631,-71.0546],phone:"(617) 742-3474",website:"https://www.neptuneoyster.com",hours:"11:30amâ€“9:30pm Sun-Thu, 11:30amâ€“10:30pm Fri-Sat",reservations:"No reservations",duration:1.5,price:"$$$",priceRange:"$30-50/person",rating:4.8,yelpRating:4.5,googleRating:4.6,reviewCount:4200,description:"The iconic Boston lobster roll. Overflowing with a quarter-pound of lobster meat.",mustTry:"Hot Buttered Lobster Roll",tip:"Arrive 20 min before opening (11:30am). Worth every minute of the wait.",waitTime:"45-90 min",bestTime:"11am weekdays (line up before open)",parking:"Paid garages nearby, no street parking",tags:["iconic","boston-legend","worth-the-wait"],momMentioned:!0,source:"mmtrip"},{id:"lobster-clam-shack",category:"lobster",name:"The Clam Shack",region:"maine_coast",location:"Kennebunkport, ME",address:"2 Western Ave, Kennebunk, ME 04043",coordinates:[43.3615,-70.4768],phone:"(207) 967-3321",website:"https://www.theclamshack.net",hours:"11amâ€“8pm (seasonal, May-Oct)",reservations:"Walk-up only",duration:1,price:"$$",priceRange:"$18-30/person",rating:4.7,yelpRating:4,googleRating:4.5,reviewCount:1900,description:"Served on a unique toasted hamburger bun instead of hot dog bun.",mustTry:"Lobster Roll + Fried Clams",tip:"Cash only! Get clam strips too.",waitTime:"15-30 min",bestTime:"Early afternoon",parking:"Free lot nearby",paymentNote:"ðŸ’µ Cash only",tags:["cash-only","unique-style","harbor-views"],momMentioned:!1,source:"research"},{id:"lobster-chauncey",category:"lobster",name:"Chauncey Creek Lobster Pier",region:"maine_coast",location:"Kittery Point, ME",address:"16 Chauncey Creek Rd, Kittery Point, ME 03905",coordinates:[43.0891,-70.6789],phone:"(207) 439-1030",website:"https://www.chaunceycreek.com",hours:"11amâ€“8pm (seasonal, May-Labor Day)",reservations:"First come, first served",duration:2,price:"$$",priceRange:"$25-40/person",rating:4.8,yelpRating:4.5,googleRating:4.7,reviewCount:1200,description:"The quintessential Maine experience. BYOBâ€”bring tablecloth, wine, and make it fancy on a picnic table over the water.",mustTry:"1.5 lb whole lobster + steamers",tip:"Stop at a Kittery wine shop first. Bring candles and wine glasses!",waitTime:"10-20 min",bestTime:"5pm for sunset",parking:"Free gravel lot",paymentNote:"ðŸ· BYOB welcome",tags:["byob","waterfront","romantic"],momMentioned:!1,source:"research"},{id:"lobster-bite-into",category:"lobster",name:"Bite Into Maine",region:"portland",location:"Cape Elizabeth, ME",address:"1000 Shore Rd, Cape Elizabeth, ME 04107 (at Portland Head Light)",coordinates:[43.6231,-70.208],phone:"(207) 420-0727",website:"https://www.biteintomaine.com",hours:"11amâ€“5pm (seasonal)",reservations:"Walk-up food truck",duration:1,price:"$$",priceRange:"$18-28/person",rating:4.7,yelpRating:4.5,googleRating:4.6,reviewCount:850,description:"Food truck at Portland Head Light! Get lobster AND lighthouse photos.",mustTry:"Flight of 3 mini rolls (try all styles!)",tip:"They offer wasabi, curry, and chipotle versions too.",waitTime:"10-15 min",bestTime:"Late afternoon for golden hour photos",parking:"$5 park entrance fee",tags:["food-truck","lighthouse-views","flight-available"],momMentioned:!1,source:"research"},{id:"lobster-reds",category:"lobster",name:"Red's Eats",region:"maine_coast",location:"Wiscasset, ME",address:"41 Water St, Wiscasset, ME 04578",coordinates:[44.0028,-69.6656],phone:"(207) 882-6128",website:"https://www.redseatsmaine.com",hours:"11:30amâ€“8pm (seasonal, Apr-Oct)",reservations:"Walk-up only",duration:1.5,price:"$$$",priceRange:"$30-45/person",rating:4.6,yelpRating:4,googleRating:4.4,reviewCount:3100,description:"The most photographed lobster roll in America. A full POUND of meat tumbling off the bun.",mustTry:"The famous overflowing lobster roll",tip:"Only worth it if driving by anyway. The line is legendary.",waitTime:"60-120 min",bestTime:"Early morning or late afternoon",parking:"Street parking, fills fast",tags:["famous","massive-portions","long-lines"],momMentioned:!1,source:"research"},{id:"lobster-mcloons",category:"lobster",name:"McLoons Lobster Shack",region:"maine_coast",location:"South Thomaston, ME",address:"315 Island Rd, South Thomaston, ME 04858",coordinates:[44.0539,-69.1347],phone:"(207) 593-1382",website:"https://www.mcloonslobster.com",hours:"11amâ€“7pm (seasonal, May-Oct)",reservations:"First come, first served",duration:1.5,price:"$$",priceRange:"$20-35/person",rating:4.9,yelpRating:4.5,googleRating:4.8,reviewCount:680,description:"Working lobster wharf, no tourists. The Maine postcard dream.",mustTry:"Lobster Roll + whoopie pie for dessert",tip:"1.5 hours north of Portland but the setting is UNREAL.",waitTime:"5-15 min",bestTime:"Lunch for best selection",parking:"Free lot",tags:["hidden-gem","authentic","working-wharf"],momMentioned:!1,source:"research"},{id:"lobster-highroller",category:"lobster",name:"Highroller Lobster Co.",region:"portland",location:"Portland, ME",address:"104 Exchange St, Portland, ME 04101",coordinates:[43.6557,-70.2547],phone:"(207) 536-1623",website:"https://www.highrollerlobster.com",hours:"11amâ€“8pm daily",reservations:"Walk-in",duration:1,price:"$$",priceRange:"$18-30/person",rating:4.6,yelpRating:4,googleRating:4.5,reviewCount:1100,description:"Young, hip, creative. Thai chili roll and Korean BBQ roll push boundaries.",mustTry:"Lobster roll + Lobster Mac & Cheese",tip:'They have a fantastic spicy "Picnic" roll with pickled jalapeÃ±os.',waitTime:"10-20 min",tags:["creative-flavors","casual-vibe","affordable"],momMentioned:!1,source:"research"},{id:"town-ogunquit",category:"town",name:"Perkins Cove, Ogunquit",region:"maine_coast",location:"Ogunquit, ME",address:"Perkins Cove Road, Ogunquit, ME 03907",coordinates:[43.2364,-70.5903],website:"https://www.ogunquit.org",hours:"Dawn to dusk (outdoor)",duration:2.5,price:"Free",rating:4.8,googleRating:4.7,reviewCount:2400,description:"Artist colony charm. Bohemian-meets-preppy with 50+ galleries in tiny area.",highlights:["Walk the Marginal Way (1.25 mi paved cliff walk)","Watch the manual drawbridge open for boats","Browse the art galleries","Sunset drinks at Barnacle Billy's"],tip:"Arrive before 10am or park at Obed's Lot and walk/trolley",bestTime:"Early morning or sunset",parking:"Perkins Cove lot $10/day or Obed's Lot + trolley",photoSpot:"Marginal Way overlook at sunrise",tags:["walkable","artists","cliff-walk"],momMentioned:!0,source:"mmtrip"},{id:"town-kennebunkport",category:"town",name:"Kennebunkport",region:"maine_coast",location:"Kennebunkport, ME",address:"Dock Square, Kennebunkport, ME 04046",coordinates:[43.3615,-70.4768],website:"https://www.visitkennebunkport.com",hours:"Shops typically 10amâ€“6pm",duration:2,price:"Free",rating:4.7,googleRating:4.6,reviewCount:1800,description:"Preppy & Presidential. Old money New England charm.",highlights:["Walk Dock Square (boutique shopping)","Drive by Bush Estate at Walker's Point","Explore Cape Porpoise (quieter, more local)","Ice cream at Rococo"],tip:"Use the municipal lot off Maine St, $2/hr",bestTime:"Mid-morning weekdays",parking:"Municipal lot $2/hr, free after 5pm",photoSpot:"Colony Hotel from across the river",tags:["preppy","boutiques","presidential"],momMentioned:!0,source:"mmtrip"},{id:"town-portland-old-port",category:"town",name:"Portland Old Port",region:"portland",location:"Portland, ME",address:"Commercial St & Exchange St, Portland, ME 04101",coordinates:[43.6591,-70.2568],website:"https://www.visitportland.com",hours:"Shops 10amâ€“6pm, restaurants until late",duration:3,price:"Free",rating:4.9,googleRating:4.8,reviewCount:5200,description:"Brooklyn-by-the-sea. Tattooed chefs and fishermen sharing the sidewalk.",highlights:["Get lost in the cobblestone streets","Browse indie shops on Exchange St","Taste wine at Vena's Fizz House","Watch fishing boats at the wharf"],tip:"Street parking tricky; use Ocean Gateway garage",bestTime:"Late afternoon â†’ dinner",parking:"Ocean Gateway garage $3/hr, street meters $2.50/hr",photoSpot:"Congress Street mural walk",tags:["foodie","cobblestone","hip"],momMentioned:!0,source:"mmtrip"},{id:"town-portsmouth",category:"town",name:"Portsmouth",region:"maine_coast",location:"Portsmouth, NH",address:"Market Square, Portsmouth, NH 03801",coordinates:[43.0718,-70.7626],website:"https://www.portsmouthnh.com",hours:"Shops 10amâ€“6pm, restaurants until late",duration:2,price:"Free",rating:4.6,googleRating:4.5,reviewCount:1400,description:"The artsy younger sibling of Boston. Historic & Hip.",highlights:["Walk Market Square","Coffee at Breaking New Grounds","Strawbery Banke Museum (if time allows)","Cross to Kittery, ME for outlets"],tip:"Hanover St garage, easy parking",bestTime:"Weekend mornings for brunch",parking:"Hanover St garage $1.50/hr",photoSpot:"Prescott Park waterfront",tags:["artsy","historic","coffee"],momMentioned:!0,source:"mmtrip"},{id:"town-camden",category:"town",name:"Camden",region:"maine_coast",location:"Camden, ME",address:"Main Street, Camden, ME 04843",coordinates:[44.2098,-69.0648],website:"https://www.camdenme.org",hours:"Shops 10amâ€“5pm, park dawn to dusk",duration:3,price:"Free (Mt. Battie entrance $6/car)",rating:4.8,googleRating:4.7,reviewCount:980,description:"Where mountains meet the sea. Genuinely magical.",highlights:["Climb Mt. Battie (drive or hike for epic views)","Stroll the harbor and watch schooners","Browse the bookstores","Catch the Camden Hills at peak foliage"],tip:"Metered on main streets, free lots nearby",photoSpot:"Mt. Battie tower overlooking harbor + fall colors",tags:["mountains","harbor","schooners"],momMentioned:!1,source:"research"},{id:"town-boothbay-harbor",category:"town",name:"Boothbay Harbor",region:"maine_coast",location:"Boothbay Harbor, ME",coordinates:[43.8516523,-69.6280608],duration:2.5,rating:4.7,description:"Classic coastal village energy: boats, lobster shacks, and an easy strollable harbor.",highlights:["Walk the waterfront and browse shops","Harbor cruise / boat watching","Grab lobster by the docks","Quick photo stops at the marinas"],tip:"Arrive earlier in the day to find parking near the waterfront.",photoSpot:"Harbor overlook near the footbridge",tags:["harbor","walkable","coastal"],momMentioned:!1,source:"research"},{id:"town-bar-harbor",category:"town",name:"Bar Harbor",region:"maine_coast",location:"Bar Harbor, ME",coordinates:[44.3876378,-68.2043361],duration:4,rating:4.8,description:"Gateway town for Acadiaâ€”busy, beautiful, and worth it for the scenery.",highlights:["Stroll the downtown shops + waterfront","Sunrise/sunset viewpoints nearby","Acadia access points close by","Seafood with harbor views"],tip:"Traffic/parking can be intense in peak seasonâ€”use lots and walk.",photoSpot:"Waterfront near the town pier",tags:["acadia","scenic","popular"],momMentioned:!1,source:"research"},{id:"town-winter-harbor",category:"town",name:"Winter Harbor",region:"maine_coast",location:"Winter Harbor, ME",coordinates:[44.3948755,-68.0841096],duration:2,rating:4.6,description:"Quieter coastal base near Acadia (Schoodic Peninsula) with a laid-back harbor vibe.",highlights:["Schoodic Peninsula access (Acadia)","Harbor strolls + small-town calm","Easy jumping-off point for scenic drives","Less crowded than Bar Harbor"],tip:"Great option if you want Acadia scenery without the Bar Harbor crowds.",photoSpot:"Schoodic Point viewpoints nearby",tags:["quiet","acadia","coastal"],momMentioned:!1,source:"research"},{id:"town-deer-isle",category:"town",name:"Deer Isle",region:"maine_coast",location:"Deer Isle, ME",coordinates:[44.224044,-68.677597],duration:2.5,rating:4.7,description:"Remote-feeling island community with working-harbor character and coastal views.",highlights:["Drive across the bridge and explore","Artisan shops / galleries (seasonal)","Coastal pull-offs and quiet roads","Lobster boats and working docks"],tip:"Best as a slow half-dayâ€”pair with another nearby coastal stop.",photoSpot:"Bridge and shoreline lookouts",tags:["island","quiet","scenic"],momMentioned:!1,source:"research"},{id:"town-lubec",category:"town",name:"Lubec",region:"maine_coast",location:"Lubec, ME",coordinates:[44.861172,-66.983501],duration:3,rating:4.6,description:"Far-east Maine coastal townâ€”feels like the edge of the map, in the best way.",highlights:["Coastal views and quiet streets","Easy to pair with nearby scenic points","Unique â€œend of Maineâ€ vibe"],tip:"Itâ€™s a haulâ€”treat it like a destination day rather than a quick detour.",photoSpot:"Waterfront viewpoints",tags:["remote","coastal","scenic"],momMentioned:!1,source:"research"},{id:"city-boston",category:"city",name:"Boston",region:"boston",location:"Boston, MA",coordinates:[42.3601,-71.0589],duration:8,rating:4.8,description:"Begin here! Full of history, and LOBSTA!",highlights:["Walk the Freedom Trail (2.5 mi, 16 historic sites)","Faneuil Hall & Quincy Market","North End (Little Italy) - cannoli!","Boston Common & Public Garden"],tip:"Skip hotel parking ($50/night). Use MBTA subway.",momQuote:"Use the arrival day and perhaps next day for touring the city and eating some LOBSTA!",suggestedNights:"1-2",tags:["history","starting-point","walkable"],momMentioned:!0,source:"mmtrip"},{id:"city-portland-me",category:"city",name:"Portland, ME",region:"portland",location:"Portland, ME",coordinates:[43.6591,-70.2568],duration:6,rating:4.9,description:"More restaurants per capita than San Francisco! Foodie paradise.",highlights:["Portland Head Light (most photographed lighthouse)","Old Port cobblestone streets","Eventide or Highroller for lobster","Duckfat for fries and poutine"],tip:"Stay 1 night. Old Port is walkable.",momQuote:"Drive up the coast to Portland (2 hrs)â€”stay 1 night",suggestedNights:"1",tags:["foodie","coastal","lighthouse"],momMentioned:!0,source:"mmtrip"},{id:"city-montreal",category:"city",name:"Montreal",region:"montreal",location:"Montreal, QC, Canada",coordinates:[45.5017,-73.5673],duration:12,rating:4.8,description:"Second-largest French-speaking city after Paris. BYOB restaurants + incredible food.",highlights:["Bagel duel: St-Viateur vs. Fairmount","Schwartz's smoked meat sandwich","Hike Mount Royal","Notre-Dame Basilica + Aura light show","La Banquise poutine (late night!)"],tip:"Expect 10Â°F temp drop vs. Boston. Pack a jacket!",momQuote:"Explore Montreal",suggestedNights:"2",tags:["international","foodie","culture","byob"],momMentioned:!0,source:"mmtrip"},{id:"city-burlington",category:"city",name:"Burlington",region:"vermont",location:"Burlington, VT",coordinates:[44.4759,-73.2121],duration:4,rating:4.7,description:"Waterfront views, Church Street pedestrian mall, and Lake Champlain sunsets.",highlights:["Church Street (pedestrian mall + buskers)","Lake Champlain waterfront walk","Sunset over the Adirondacks","Local craft beer scene"],tip:"Nice stopping place, some hiking options",momQuote:"No specific plans for Burlington, just a nice stopping place",suggestedNights:"0-1",tags:["lakefront","hip","sunset"],momMentioned:!0,source:"mmtrip"},{id:"city-saratoga",category:"city",name:"Saratoga Springs",region:"saratoga",location:"Saratoga Springs, NY",coordinates:[43.0831,-73.784],duration:4,rating:4.6,description:'Racing season is over, meaning quieter "dark days" ideal for spas, Broadway strolls, and gardens.',highlights:["Broadway stroll and cafes","Yaddo Gardens","Roosevelt Baths & Spa","Downtown charm"],tip:"Stay 1 night before flying out of Albany",momQuote:"Drive to Saratoga via Lake Placidâ€”stay 1 night",suggestedNights:"1",tags:["spa","charming","relaxed"],momMentioned:!0,source:"mmtrip"},{id:"hike-marginal-way",category:"hike",name:"Marginal Way",region:"maine_coast",location:"Ogunquit, ME",coordinates:[43.2364,-70.5903],duration:1,difficulty:"Easy",distance:"1.25 miles",description:"Paved cliff walk with stunning ocean views. Links Ogunquit to Perkins Cove.",tip:"Best at sunrise before the crowds",tags:["paved","ocean-views","easy"],momMentioned:!0,source:"mmtrip"},{id:"hike-sabbaday-falls",category:"hike",name:"Sabbaday Falls",region:"white_mountains",location:"Kancamagus Highway, NH",coordinates:[43.9851,-71.3684],duration:.75,difficulty:"Easy",distance:"0.75 miles round trip",description:"Multi-tier waterfall with easy loop trail. Perfect quick stop on the Kanc.",tip:"Hit the trailhead before 9:30am to beat tour buses",tags:["waterfall","quick","family-friendly"],momMentioned:!1,source:"research"},{id:"hike-mount-battie",category:"hike",name:"Mount Battie",region:"maine_coast",location:"Camden, ME",coordinates:[44.2098,-69.0648],duration:2,difficulty:"Moderate",distance:"1.5 miles to summit",description:"Climb for epic views of Camden Harbor + fall foliage. Can also drive up!",tip:"Tower at summit has 360Â° views",tags:["summit","harbor-views","foliage"],momMentioned:!1,source:"research"},{id:"hike-mount-royal",category:"hike",name:"Mount Royal",region:"montreal",location:"Montreal, QC",coordinates:[45.5048,-73.5877],duration:2,difficulty:"Easy-Moderate",distance:"2 miles to Kondiaronk Belvedere",description:"Fall foliage WITH a city skyline. Best of both worlds.",tip:"Kondiaronk Belvedere has the famous Montreal panorama",tags:["city-views","foliage","belvedere"],momMentioned:!0,source:"mmtrip"},{id:"hike-sallys-property",category:"hike",name:"Sally's Property Trails",region:"vermont",location:"Chelsea, VT",coordinates:[43.9887,-72.4476],duration:3,difficulty:"Variable",distance:"Multiple trails on property",private:!0,description:"Private property hiking, dark skies for stargazing, peak foliage timing.",tip:"Grab groceries in Barre or Lebanon before arrivingâ€”closest store is 20 min away",momQuote:"We can do some serious walking/hiking just on Sally's property alone.",tags:["private","stargazing","rural"],momMentioned:!0,source:"mmtrip"},{id:"hike-ice-glen",category:"hike",name:"Ice Glen & Laura's Tower",region:"berkshires",location:"Stockbridge, MA",coordinates:[42.2876,-73.3207],duration:2.5,difficulty:"Moderate",distance:"1.5 miles",description:"Scramble through mossy boulders in a cool ravine, then climb to a stone tower.",tip:"Bring hiking microspikes if exploring in late season",momQuote:"Hiking in Ice Glen and Laura's Tower?",tags:["boulders","tower","adventure"],momMentioned:!0,source:"mmtrip"},{id:"drive-kancamagus",category:"drive",name:"Kancamagus Highway",region:"white_mountains",location:"White Mountains, NH",coordinates:[44.0456,-71.4161],duration:2.5,distance:"34 miles",rating:5,description:"THE premier leaf-peeping drive. No gas stations, no servicesâ€”just pure beauty.",stops:[{name:"Albany Covered Bridge",type:"photo"},{name:"Sabbaday Falls",type:"hike"},{name:"Hancock Overlook",type:"viewpoint"}],tip:"Depart by 8am. Jammed 11am-3pm.",foliage:"Peak late September at higher elevations",tags:["foliage","no-services","must-do"],momMentioned:!0,source:"mmtrip"},{id:"drive-whiteface",category:"drive",name:"Whiteface Veterans Memorial Highway",region:"adirondacks",location:"Adirondacks, NY",coordinates:[44.3659,-73.9026],duration:1.5,distance:"5 miles to summit",rating:5,description:"Drive almost to the summit! 360Â° views from 4,867 ft elevation.",tip:"Closes mid-October, so late Sept is PERFECT.",foliage:"Peak! 70-90% color in late September",tags:["summit","adirondacks","views"],momMentioned:!0,source:"mmtrip"},{id:"drive-route-100",category:"drive",name:"Route 100 Vermont",region:"vermont",location:"Vermont",coordinates:[44.4654,-72.6874],duration:4,distance:"Varies (can do sections)",rating:4.8,description:'The "Main Street of Vermont." Covered bridges, farms, and fire colors.',stops:[{name:"Stowe",type:"town"},{name:"Waterbury (Ben & Jerry's)",type:"food"},{name:"Cold Hollow Cider",type:"food"}],tip:"Can do sections rather than whole route",foliage:"Peak early-to-mid October",tags:["covered-bridges","farms","classic-vermont"],momMentioned:!1,source:"research"},{id:"drive-route-1-coast",category:"drive",name:"Route 1 Coastal Drive",region:"maine_coast",location:"New Hampshire to Portland, ME",coordinates:[43.0718,-70.7626],duration:3.5,distance:"~60 miles (with stops)",rating:4.7,description:"The slow, beautiful coastal route through all the harbor towns.",stops:[{name:"Portsmouth, NH",type:"town"},{name:"Ogunquit",type:"town"},{name:"Kennebunkport",type:"town"}],tip:'Adds 90 mins vs. I-95 but nails the "little harbor towns" wish',tags:["coastal","harbor-towns","scenic"],momMentioned:!0,source:"mmtrip"},{id:"foliage-hancock-overlook",category:"foliage",name:"Hancock Overlook",region:"white_mountains",location:"Kancamagus Highway, NH",coordinates:[44.0456,-71.4161],duration:.5,description:"Hairpin view of Osceola Range. Expect highest foliage intensity on the Kanc.",foliagePeak:"Sept 25 - Oct 5",expectedColor:"60-80%",tags:["overlook","kanc","peak-foliage"],momMentioned:!1,source:"research"},{id:"foliage-lake-placid",category:"foliage",name:"Lake Placid Area",region:"adirondacks",location:"Lake Placid, NY",coordinates:[44.2795,-73.9799],duration:4,description:"Adirondacks peak earlyâ€”huge foliage payoff. Whiteface Mountain nearby.",foliagePeak:"Sept 22 - Oct 5",expectedColor:"70-90%",highlights:["Drive Whiteface Mountain","Mirror Lake views","Olympic venues"],momQuote:"Optional detour via Lake Placid",tags:["peak","adirondacks","mountain"],momMentioned:!0,source:"mmtrip"},{id:"foliage-chelsea-vermont",category:"foliage",name:"Central Vermont Hills",region:"vermont",location:"Chelsea, VT",coordinates:[43.9887,-72.4476],duration:3,description:"Vermont hills starting to pop. Sugar maples glowing orange.",foliagePeak:"Sept 28 - Oct 8",expectedColor:"50-70%",tags:["vermont","maples","rural"],momMentioned:!0,source:"mmtrip"},{id:"landmark-portland-head-light",category:"landmark",name:"Portland Head Light",region:"portland",location:"Cape Elizabeth, ME",coordinates:[43.6231,-70.208],duration:1.5,description:"Most photographed lighthouse in America! Established 1791.",tip:"$5 park fee, totally worth it. Bite Into Maine food truck often here.",photoSpot:"From the south rocks at sunset",tags:["lighthouse","iconic","photo-op"],momMentioned:!1,source:"research"},{id:"landmark-freedom-trail",category:"landmark",name:"Freedom Trail",region:"boston",location:"Boston, MA",coordinates:[42.3588,-71.0598],duration:2.5,description:"2.5-mile walk through 16 historic sites. Follow the red brick lineâ€”you can't get lost!",tip:"Golden hour at Faneuil Hall for photos",highlights:["Boston Common","Old North Church","Paul Revere House","Faneuil Hall"],tags:["history","walking","revolutionary"],momMentioned:!0,source:"mmtrip"},{id:"landmark-notre-dame",category:"landmark",name:"Notre-Dame Basilica",region:"montreal",location:"Montreal, QC",coordinates:[45.5046,-73.5566],duration:1.5,description:"Stunning Gothic Revival basilica. The Aura light show is Instagram gold.",tip:"Book Aura light + sound show in advance",tags:["cathedral","light-show","architecture"],momMentioned:!0,source:"mmtrip"},{id:"landmark-albany-covered-bridge",category:"landmark",name:"Albany Covered Bridge",region:"white_mountains",location:"Kancamagus Highway, NH",coordinates:[43.9612,-71.2234],duration:.5,description:"Classic New England postcard. First leg-stretch and photo op on the Kanc.",tip:"Quick stop, great for photos",tags:["covered-bridge","photo-op","kanc"],momMentioned:!1,source:"research"},{id:"food-duckfat",category:"food",name:"Duckfat",region:"portland",location:"Portland, ME",coordinates:[43.6557,-70.2558],duration:1,price:"$$",description:"Famous for Belgian fries cooked in duck fat. Also great poutine and paninis.",mustTry:"Duck fat fries + poutine",tags:["fries","casual","iconic"],momMentioned:!1,source:"research"},{id:"food-schwartzs",category:"food",name:"Schwartz's Deli",region:"montreal",location:"Montreal, QC",coordinates:[45.5181,-73.5778],duration:1,price:"$$",description:"Iconic Montreal smoked meat since 1928. The line is part of the experience.",mustTry:"Medium-fat smoked meat sandwich",tip:'Order "medium-fat" for authentic texture',tags:["iconic","smoked-meat","deli"],momMentioned:!0,source:"mmtrip"},{id:"food-st-viateur",category:"food",name:"St-Viateur Bagels",region:"montreal",location:"Montreal, QC",coordinates:[45.5236,-73.6008],duration:.5,price:"$",description:"Wood-fired Montreal-style bagels. Sweeter and denser than NYC bagels.",mustTry:"Sesame bagel with cream cheese",tip:"Open 24 hours! Also try rival Fairmount nearby.",tags:["bagels","iconic","24-hours"],momMentioned:!0,source:"mmtrip"},{id:"food-la-banquise",category:"food",name:"La Banquise",region:"montreal",location:"Montreal, QC",coordinates:[45.5275,-73.5714],duration:1,price:"$$",description:"The ultimate poutine destination. 30+ varieties, open 24 hours.",mustTry:"Classic poutine (late night!)",tip:"Split itâ€”it's huge!",tags:["poutine","late-night","24-hours"],momMentioned:!0,source:"mmtrip"},{id:"food-cold-hollow",category:"food",name:"Cold Hollow Cider Mill",region:"vermont",location:"Waterbury, VT",coordinates:[44.3553,-72.7506],duration:.75,price:"$",description:"Fresh cider donuts and apple cider. Peak fall experience.",mustTry:"Cider donuts + fresh apple cider",tip:"Grab donuts + cider for the border queue to Canada",tags:["donuts","cider","fall"],momMentioned:!1,source:"research"},{id:"food-ben-jerrys",category:"food",name:"Ben & Jerry's Factory",region:"vermont",location:"Waterbury, VT",coordinates:[44.3506,-72.7281],duration:1,price:"$",description:"Factory tour and ice cream. The Flavor Graveyard is a fun photo op.",mustTry:"Any scoop + see the Flavor Graveyard",tags:["ice-cream","tour","fun"],momMentioned:!1,source:"research"},{id:"lodge-godfrey-boston",category:"lodging",name:"The Godfrey Hotel Boston",region:"boston",location:"Boston, MA - Downtown",coordinates:[42.3554,-71.064],priceRange:"$250-350/night",type:"Boutique Hotel",description:"Modern boutique steps from Boston Common. Skip hotel parkingâ€”you don't need a car in Boston!",amenities:["Rooftop Bar","Free WiFi","Fitness Center","Restaurant"],tip:"Rooftop bar has great sunset views",tags:["boutique","downtown","rooftop"],momMentioned:!1,source:"research"},{id:"lodge-press-portland",category:"lodging",name:"The Press Hotel",region:"portland",location:"Portland, ME - Old Port",coordinates:[43.6591,-70.2568],priceRange:"$280-400/night",type:"Boutique Hotel",description:"Converted from Portland's newspaper HQ. Quirky literary vibes. Walk to EVERYTHING.",amenities:["On-site Restaurant","Lobby Bar","Free WiFi","Bikes Available"],tip:"Ask for a room with harbor glimpses",tags:["boutique","historic","walkable"],momMentioned:!1,source:"research"},{id:"lodge-sallys",category:"lodging",name:"Sally's Vermont Property",region:"vermont",location:"Chelsea, VT",coordinates:[43.9887,-72.4476],priceRange:"Friend rate!",type:"Private Home",private:!0,description:"The REAL Vermont experience. Mountain views, hiking access, a million stars at night.",amenities:["Mountain Views","Hiking Access","Stargazing","Full Kitchen","Peace & Quiet"],tip:"Grab groceries before arrivingâ€”closest store is 20 min away",momQuote:"We could stay a night at Sally's in Chelsea",tags:["private","rural","authentic"],momMentioned:!0,source:"mmtrip"},{id:"lodge-petit-montreal",category:"lodging",name:"Le Petit Hotel",region:"montreal",location:"Montreal, QC - Old Montreal",coordinates:[45.5048,-73.5538],priceRange:"$280-380/night CAD",type:"Boutique Hotel",description:"Intimate boutique steps from Notre-Dame Basilica. Complimentary wine hour + breakfast.",amenities:["Breakfast Included","Rooftop Terrace","Wine & Cheese Hour","Bikes"],tip:"Walk to Olive et Gourmando for the best sandwiches",tags:["boutique","old-montreal","romantic"],momMentioned:!1,source:"research"},{id:"lodge-adelphi-saratoga",category:"lodging",name:"The Adelphi Hotel",region:"saratoga",location:"Saratoga Springs, NY",coordinates:[43.0831,-73.7846],priceRange:"$350-500/night",type:"Historic Boutique",description:"Stunning restored Victorian hotel. THE place to stay in Saratoga. Gilded age vibes.",amenities:["Pool","Spa","Restaurant","Historic Charm","Bar"],tip:"Their bar is gorgeous for a nightcap",tags:["historic","victorian","spa"],momMentioned:!1,source:"research"},{id:"lodge-mirror-lake-inn",category:"lodging",name:"Mirror Lake Inn",region:"adirondacks",location:"Lake Placid, NY",coordinates:[44.2795,-73.9799],priceRange:"$400-600/night",type:"Lakefront Resort",description:"Stunning lake views, full spa, very romantic. If you do the Lake Placid route.",amenities:["Lake Views","Spa","Restaurant","Private Beach","Pool"],tip:"Lakefront rooms are worth it. Get there early for Whiteface drive.",tags:["lakefront","spa","romantic"],momMentioned:!1,source:"research"}];function Re(t){return mt.find(a=>a.id===t)}async function Ie(t,{signal:a}={}){if(!t)return null;const s=`https://nominatim.openstreetmap.org/search?format=jsonv2&limit=1&q=${encodeURIComponent(t)}&email=${encodeURIComponent("mmt-trip-planner@example.com")}`,l=await fetch(s,{signal:a});if(!l.ok)return null;const u=(await l.json())?.[0];return!u?.lat||!u?.lon?null:[Number(u.lat),Number(u.lon)]}function xe(t){if(!Number.isFinite(t))return"--";const a=t/1609.344;return a<10?`${a.toFixed(1)} mi`:`${Math.round(a)} mi`}function ve(t){if(!Number.isFinite(t))return"--";const a=Math.round(t/60);if(a<60)return`${a} min`;const s=Math.floor(a/60),l=a%60;return l?`${s}h ${l}m`:`${s}h`}function Ne(t){return Number.isFinite(t)?t<1?`${Math.round(t*60)} min`:t%1===0?`${t} hr`:`${t.toFixed(1)} hr`:"--"}function He(t){return Number.isFinite(t)?`$${Math.round(t).toLocaleString()}`:"--"}function Ft(t){return`hsl(${(t-1)*45%360} 70% 45%)`}function Ht({bounds:t}){const a=at();return i.useEffect(()=>{!t||t.length<1||a.fitBounds(t,{padding:[24,24]})},[a,t]),null}function _t({stop:t,activities:a,lodging:s,isActive:l,onHover:m,onLeave:u}){return e.jsxs("article",{className:`stop-card ${l?"active":""}`,onMouseEnter:()=>m(t.id),onMouseLeave:()=>u(),children:[e.jsxs("header",{className:"stop-card-header",children:[e.jsxs("div",{children:[e.jsx("p",{className:"stop-day",children:t.dayRange}),e.jsx("h3",{children:t.title})]}),e.jsxs("div",{className:"stop-meta",children:[e.jsx("span",{children:t.nights}),e.jsx("span",{children:t.driveTime})]})]}),e.jsx("p",{className:"stop-note",children:t.notes}),e.jsxs("blockquote",{className:"stop-quote",children:['"',t.momQuote,'"']}),t.highlights?.length>0&&e.jsx("div",{className:"stop-highlights",children:t.highlights.map(c=>e.jsx("span",{className:"pill",children:c},c))}),s&&e.jsxs("div",{className:"stop-lodging",children:[e.jsx("h4",{children:"Stay"}),e.jsxs("div",{className:"lodging-card",children:[e.jsx("strong",{children:s.name}),e.jsx("span",{children:s.location}),s.tip&&e.jsxs("small",{children:["Tip: ",s.tip]})]})]}),e.jsxs("div",{className:"stop-activities",children:[e.jsx("h4",{children:"Must-do ideas"}),e.jsx("div",{className:"stop-activity-grid",children:a.map(c=>e.jsxs("div",{className:"stop-activity",children:[e.jsxs("div",{className:"stop-activity-title",children:[e.jsx("span",{className:"activity-icon",children:Z[c.category]?.icon??"*"}),e.jsxs("div",{children:[e.jsx("strong",{children:c.name}),e.jsx("span",{children:c.location})]})]}),e.jsxs("div",{className:"stop-activity-meta",children:[c.duration&&e.jsx("span",{children:Ne(c.duration)}),c.price&&e.jsx("span",{children:c.price}),c.waitTime&&e.jsx("span",{children:c.waitTime})]}),c.mustTry&&e.jsxs("p",{className:"activity-callout",children:["Must try: ",c.mustTry]}),c.tip&&e.jsxs("p",{className:"activity-tip",children:["Tip: ",c.tip]})]},c.id))})]})]})}function Wt({onCopyToBuilder:t}){const[a,s]=i.useState(null),[l,m]=i.useState({}),u=i.useMemo(()=>{const n={};return R.stops.forEach(f=>{n[f.id]=(f.activities||[]).map(N=>Re(N)).filter(Boolean)}),n},[]),c=i.useMemo(()=>{const n={};return R.stops.forEach(f=>{n[f.id]=f.lodging?Re(f.lodging):null}),n},[]);i.useEffect(()=>{const n=new AbortController;let f=!1;async function N(){const v={};for(const S of R.stops)if(!l[S.id])try{const k=await Ie(S.location,{signal:n.signal});k&&(v[S.id]=k)}catch(k){if(k?.name==="AbortError")return}f||Object.keys(v).length&&m(S=>({...S,...v}))}return N(),()=>{f=!0,n.abort()}},[l]);const g=R.stops.map(n=>l[n.id]).filter(Boolean),p=g.length?g:null;return e.jsxs("section",{className:"moms-route",children:[e.jsxs("div",{className:"route-hero",children:[e.jsxs("div",{className:"hero-content",children:[e.jsx("p",{className:"hero-eyebrow",children:"Suggested route built from Mom's original notes"}),e.jsx("h2",{children:R.title}),e.jsx("p",{className:"hero-subtitle",children:R.subtitle}),e.jsx("div",{className:"hero-theme",children:R.themeLine}),e.jsxs("div",{className:"hero-actions",children:[e.jsx("button",{type:"button",className:"btn-primary",onClick:t,children:"Copy to Builder"}),e.jsx("span",{className:"hero-window",children:R.travelWindow})]})]}),e.jsxs("div",{className:"hero-stats",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{children:"Duration"}),e.jsx("strong",{children:R.overview.duration})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{children:"Total miles"}),e.jsx("strong",{children:R.overview.totalMiles})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{children:"Drive time"}),e.jsx("strong",{children:R.overview.driveTime})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{children:"Fly in/out"}),e.jsx("strong",{children:R.overview.flyIn}),e.jsx("small",{children:R.overview.flyOut})]})]})]}),e.jsx("div",{className:"route-warnings",children:R.warnings.map(n=>e.jsxs("div",{className:"warning-card",children:[e.jsx("strong",{children:n.title}),e.jsx("p",{children:n.detail})]},n.title))}),e.jsx("div",{className:"route-ribbon",children:R.ribbonStops.map(n=>e.jsxs("div",{className:`ribbon-stop ${a===n.id?"active":""}`,onMouseEnter:()=>s(n.id),onMouseLeave:()=>s(null),children:[e.jsx("span",{className:"ribbon-emoji",children:n.emoji}),e.jsxs("div",{children:[e.jsx("strong",{children:n.name}),e.jsx("span",{children:n.nights}),e.jsx("small",{children:n.drive})]})]},n.id))}),e.jsx("div",{className:"featured-moments",children:R.featuredMoments.map(n=>e.jsxs("div",{className:"featured-card",children:[e.jsx("h3",{children:n.title}),e.jsx("p",{children:n.detail}),e.jsx("span",{className:"featured-stop",children:R.ribbonStops.find(f=>f.id===n.stopId)?.name})]},n.title))}),e.jsx("div",{className:"stop-cards",children:R.stops.map(n=>e.jsx(_t,{stop:n,activities:u[n.id]||[],lodging:c[n.id],isActive:a===n.id,onHover:s,onLeave:()=>s(null)},n.id))}),e.jsxs("div",{className:"route-map-section",children:[e.jsxs("div",{className:"map-copy",children:[e.jsx("h3",{children:"Route overview"}),e.jsx("p",{children:"Pin the key bases, then zoom in as you decide on day-by-day stops."})]}),e.jsx("div",{className:"route-map",children:e.jsxs(Je,{center:[43.5,-71.5],zoom:6,style:{height:"100%",width:"100%"},children:[p&&e.jsx(Ht,{bounds:p}),e.jsx(Xe,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"Â© OpenStreetMap"}),g.length>1&&e.jsx(Ze,{positions:g,pathOptions:{color:"#e86f3a",weight:4,opacity:.7}}),R.stops.map(n=>l[n.id]?e.jsx(et,{position:l[n.id],children:e.jsxs(tt,{children:[e.jsx("strong",{children:n.title}),e.jsx("br",{}),n.dayRange]})},n.id):null)]})})]}),e.jsxs("div",{className:"route-grid",children:[e.jsxs("section",{className:"route-panel",children:[e.jsx("h3",{children:"Foliage radar"}),e.jsx("div",{className:"chip-grid",children:R.foliage.peakWindows.map(n=>e.jsx("span",{className:"pill",children:n},n))}),e.jsx("h4",{children:"Best drives"}),e.jsx("div",{className:"chip-grid",children:R.foliage.bestDrives.map(n=>e.jsx("span",{className:"pill muted",children:n},n))})]}),e.jsxs("section",{className:"route-panel",children:[e.jsx("h3",{children:"Budget bands"}),e.jsx("div",{className:"budget-grid",children:R.budget.tiers.map(n=>e.jsxs("div",{className:"budget-card",children:[e.jsx("strong",{children:n.name}),e.jsx("span",{children:n.range}),e.jsx("p",{children:n.detail})]},n.name))}),e.jsx("ul",{className:"tip-list",children:R.budget.tips.map(n=>e.jsx("li",{children:n},n))})]}),e.jsxs("section",{className:"route-panel",children:[e.jsx("h3",{children:"Packing playbook"}),e.jsx("p",{className:"panel-note",children:R.packing.weatherNote}),e.jsxs("div",{className:"packing-grid",children:[e.jsxs("div",{children:[e.jsx("h4",{children:"Essentials"}),e.jsx("ul",{children:R.packing.essentials.map(n=>e.jsx("li",{children:n},n))})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"Fun extras"}),e.jsx("ul",{children:R.packing.extras.map(n=>e.jsx("li",{children:n},n))})]})]})]})]}),e.jsxs("section",{className:"route-panel alt-panel",children:[e.jsx("h3",{children:"Alternative endings"}),e.jsx("div",{className:"alt-grid",children:R.alternatives.map(n=>e.jsxs("div",{className:"alt-card",children:[e.jsx("strong",{children:n.title}),e.jsx("p",{children:n.detail}),e.jsxs("div",{className:"alt-meta",children:[n.addsDays?e.jsxs("span",{children:["+",n.addsDays," day(s)"]}):null,n.flyOut?e.jsx("span",{children:n.flyOut}):null]})]},n.title))})]}),e.jsxs("section",{className:"route-panel wildcard-panel",children:[e.jsx("h3",{children:"Wildcards Mom mentioned"}),e.jsx("ul",{children:R.wildcards.map(n=>e.jsx("li",{children:n},n))})]}),e.jsxs("div",{className:"route-cta",children:[e.jsx("button",{type:"button",className:"btn-primary",onClick:t,children:"Copy Mom's Route to Builder"}),e.jsx("p",{children:"Make edits, swap stops, or build a brand-new plan from scratch."})]})]})}function Vt({trip:t,getActivityWaypoints:a}){const[s,l]=i.useState({}),[m,u]=i.useState(!1),[c,g]=i.useState(null),[p,n]=i.useState({});return i.useEffect(()=>{const f=new AbortController;let N=!1;async function v(){const S=Array.from(new Set((t.days||[]).map(M=>(M.location||"").trim()).filter(Boolean))),k={};for(const M of S)if(!p[M])try{const b=await Ie(M,{signal:f.signal});b&&(k[M]=b)}catch(b){if(b?.name==="AbortError")return}N||Object.keys(k).length&&n(M=>({...M,...k}))}return v(),()=>{N=!0,f.abort()}},[t.days,p]),i.useEffect(()=>{const f=new AbortController;let N=!1;async function v(){u(!0),g(null);const S={};for(let k=0;k<t.days.length;k++){const M=t.days[k],b=M?.type==="drive",y=(M?.location||"").trim()||null,j=k>0?(t.days[k-1]?.location||"").trim():null,E=b?j:y,D=[],I=E?p[E]:null;E&&I&&D.push({id:`base-start-${M.id}`,name:E,coordinates:I}),D.push(...a(M));const $=y?p[y]:null;if(b&&y&&$&&y!==E&&D.push({id:`base-end-${M.id}`,name:y,coordinates:$}),D.length<2)continue;const H=`https://router.project-osrm.org/route/v1/driving/${D.map(B=>`${B.coordinates[1]},${B.coordinates[0]}`).join(";")}?overview=full&geometries=geojson&steps=false`;try{const B=await fetch(H,{signal:f.signal});if(!B.ok)continue;const T=(await B.json())?.routes?.[0];if(!T?.geometry?.coordinates?.length)continue;const W=T.geometry.coordinates.map(([L,F])=>[F,L]),C=(T.legs||[]).map((L,F)=>({from:D[F]?.name??`Stop ${F+1}`,to:D[F+1]?.name??`Stop ${F+2}`,distance_m:L.distance,duration_s:L.duration}));S[M.id]={dayId:M.id,dayNumber:M.dayNumber,distance_m:T.distance,duration_s:T.duration,line:W,legs:C}}catch(B){if(B?.name==="AbortError")return}}N||(l(S),u(!1))}return v().catch(S=>{N||S?.name==="AbortError"||(g("Could not load driving routes."),u(!1))}),()=>{N=!0,f.abort()}},[t.days,a,p]),{dayRoutes:s,routesLoading:m,routesError:c,baseCoordsByLabel:p}}function qt(t){if(!t)return null;const[a,s]=t.split(":").map(l=>Number(l));return!Number.isFinite(a)||!Number.isFinite(s)?null:a*60+s}function Ut(t){if(!Number.isFinite(t))return"";const a=(t%1440+1440)%1440,s=Math.floor(a/60),l=Math.round(a%60);return`${String(s).padStart(2,"0")}:${String(l).padStart(2,"0")}`}function ge(t){return t*Math.PI/180}function _e(t,a){if(!t||!a)return 0;const[s,l]=t,[m,u]=a,c=3958.8,g=ge(m-s),p=ge(u-l),n=Math.sin(g/2)*Math.sin(g/2)+Math.cos(ge(s))*Math.cos(ge(m))*Math.sin(p/2)*Math.sin(p/2),f=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n));return c*f}function Yt(t){if(!t)return 0;const s=t/40*60;return Math.round(s+10)}function Kt({activities:t,startTime:a="09:00",bufferMinutes:s=20}){const l={};let m=qt(a)??540,u=null;return t.forEach((c,g)=>{let p=s;if(u&&c.coordinates){const v=_e(u,c.coordinates),S=Yt(v);p=Math.max(S,15)}else g===0&&(p=0);g>0&&(m+=p);const n=Number(c.duration)||1.5,f=Ut(m);l[c.id]={startTime:f,duration:n,bufferMinutes:p,travelMiles:u&&c.coordinates?_e(u,c.coordinates).toFixed(1):null};const N=n*60;m+=N,c.coordinates&&(u=c.coordinates)}),l}function Le(t){return!t||typeof t!="object"||!Array.isArray(t.days)?!1:t.days.every(a=>a&&typeof a.id=="string"&&Array.isArray(a.activities))}function We(t){return t?{name:t.name,days:t.days.map((a,s)=>({id:`day-${s+1}`,dayNumber:a.dayNumber??s+1,label:a.label??`Day ${s+1}`,location:a.location??"",activities:a.suggestedActivities||[],notes:a.notes||"",type:a.type||"custom",lodging:a.lodging||null,startTime:"09:00",schedule:{}})),createdAt:new Date().toISOString(),templateId:t.id}:null}function Gt({dayCount:t=5,name:a="My New England Trip",defaultLabel:s="Day"}={}){return{name:a,days:Array.from({length:t},(l,m)=>({id:`day-${m+1}`,dayNumber:m+1,label:`${s} ${m+1}`,location:"",activities:[],notes:"",type:"custom",lodging:null,startTime:"09:00",schedule:{}})),createdAt:new Date().toISOString(),templateId:null}}function Ve(t){return t.map((a,s)=>({...a,dayNumber:s+1,id:`day-${s+1}`,label:a.label||`Day ${s+1}`}))}function zt(t){return t.reduce((s,l)=>(s.activities+=l.activities.length,s),{days:t.length,activities:0})}function Qt({name:t,startLocation:a,endLocation:s,dayCount:l,style:m="balanced"}){const u=Math.max(1,Number(l)||1),c=Array.from({length:u},(g,p)=>{const n=p===0,f=p===u-1,v=n?"arrival":f?"departure":m==="hustle"?"drive":"explore";return{id:`day-${p+1}`,dayNumber:p+1,label:n?"Arrival":f?"Departure":`Day ${p+1}`,location:"",activities:[],notes:"",type:v,lodging:null,startTime:"09:00",schedule:{}}});return{name:t||"My Custom Trip",days:c,createdAt:new Date().toISOString(),templateId:null}}const Oe={AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming",DC:"District of Columbia"};Object.fromEntries(Object.entries(Oe).map(([t,a])=>[a.toLowerCase(),t]));const Jt=Object.keys(Oe),Xt={AL:["FL","GA","MS","TN"],AK:[],AZ:["CA","CO","NM","NV","UT"],AR:["LA","MO","MS","OK","TN","TX"],CA:["AZ","NV","OR"],CO:["AZ","KS","NE","NM","OK","UT","WY"],CT:["MA","NY","RI"],DE:["MD","NJ","PA"],FL:["AL","GA"],GA:["AL","FL","NC","SC","TN"],HI:[],ID:["MT","NV","OR","UT","WA","WY"],IL:["IA","IN","KY","MO","WI"],IN:["IL","KY","MI","OH"],IA:["IL","MN","MO","NE","SD","WI"],KS:["CO","MO","NE","OK"],KY:["IL","IN","MO","OH","TN","VA","WV"],LA:["AR","MS","TX"],ME:["NH"],MD:["DC","DE","PA","VA","WV"],MA:["CT","NH","NY","RI","VT"],MI:["IN","OH","WI"],MN:["IA","ND","SD","WI"],MS:["AL","AR","LA","TN"],MO:["AR","IA","IL","KS","KY","NE","OK","TN"],MT:["ID","ND","SD","WY"],NE:["CO","IA","KS","MO","SD","WY"],NV:["AZ","CA","ID","OR","UT"],NH:["MA","ME","VT"],NJ:["DE","NY","PA"],NM:["AZ","CO","OK","TX","UT"],NY:["CT","MA","NJ","PA","VT"],NC:["GA","SC","TN","VA"],ND:["MN","MT","SD"],OH:["IN","KY","MI","PA","WV"],OK:["AR","CO","KS","MO","NM","TX"],OR:["CA","ID","NV","WA"],PA:["DE","MD","NJ","NY","OH","WV"],RI:["CT","MA"],SC:["GA","NC"],SD:["IA","MN","MT","ND","NE","WY"],TN:["AL","AR","GA","KY","MO","MS","NC","VA"],TX:["AR","LA","NM","OK"],UT:["AZ","CO","ID","NM","NV","WY"],VT:["MA","NH","NY"],VA:["DC","KY","MD","NC","TN","WV"],WA:["ID","OR"],WV:["KY","MD","OH","PA","VA"],WI:["IA","IL","MI","MN"],WY:["CO","ID","MT","NE","SD","UT"],DC:["MD","VA"]};function Zt(t){return String(t||"").toLowerCase().replace(/\s+/g," ").trim()}function ea(t){const a=String(t||"");if(!a.trim())return[];const s=new Set,l=new RegExp(`\\b(${Jt.join("|")})\\b`,"g"),m=a.toUpperCase();let u;for(;u=l.exec(m);)s.add(u[1]);const c=Zt(a);for(const[g,p]of Object.entries(Oe)){const n=p.toLowerCase();c.includes(n)&&s.add(g)}return Array.from(s)}function ta(t){const a=Array.isArray(t)?t:[],s=new Set;return a.map(l=>String(l||"").toUpperCase().trim()).filter(Boolean).forEach(l=>{s.add(l),(Xt[l]||[]).forEach(m=>s.add(m))}),Array.from(s)}function aa(t){if(t.googleMapsUrl)return t.googleMapsUrl;const a=`${t.name||""} ${t.location||""}`.trim();return a?`https://www.google.com/maps/search/${encodeURIComponent(a)}`:null}function Se(t,a){const s=`${t.name||""} ${t.location||""} ${a}`.trim();return`https://www.google.com/search?q=${encodeURIComponent(s)}`}function sa({activity:t,days:a,selectedDayId:s,onClose:l,onAddToDay:m,onRemoveFromDay:u,onEditCustom:c,onDeleteCustom:g}){const[p,n]=i.useState(s);i.useEffect(()=>{n(s)},[s,t]);const f=i.useMemo(()=>t?!!a.find(j=>j.id===s)?.activities.includes(t.id):!1,[t,a,s]);if(!t)return null;const N=Z[t.category]||Z.custom,v=t.private||t.isCustom,S=v?null:aa(t),k=v?null:Se(t,"menu"),M=v?null:Se(t,"reviews"),b=v?null:Se(t,"photos");return e.jsx("div",{className:"modal-overlay",onClick:l,role:"presentation",children:e.jsxs("div",{className:"modal",role:"dialog","aria-modal":"true",onClick:y=>y.stopPropagation(),children:[e.jsxs("header",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"modal-eyebrow-row",children:[e.jsx("span",{className:"modal-eyebrow",children:N?.name||"Activity"}),t.momMentioned&&e.jsx("span",{className:"badge-mom",children:"â¤ï¸ Mom Approved"}),v&&e.jsx("span",{className:"badge-private",children:"ðŸ  Private"})]}),e.jsxs("h2",{children:[N?.icon," ",t.name]}),e.jsx("p",{className:"modal-subtitle",children:t.location})]}),e.jsx("button",{type:"button",className:"icon-btn",onClick:l,"aria-label":"Close details",children:"x"})]}),e.jsxs("div",{className:"modal-body",children:[t.description&&e.jsx("p",{className:"modal-description",children:t.description}),e.jsxs("div",{className:"modal-meta-grid",children:[t.duration&&e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Duration"}),e.jsx("span",{children:Ne(t.duration)})]}),t.price&&e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Cost"}),e.jsx("span",{children:t.price})]}),t.rating&&!v&&e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Rating"}),e.jsxs("span",{children:[t.rating," â˜…"]})]}),t.waitTime&&e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Wait"}),e.jsx("span",{children:t.waitTime})]}),t.address&&e.jsxs("div",{className:"meta-item span-2",children:[e.jsx("span",{className:"meta-label",children:"Address"}),e.jsx("span",{children:t.address})]}),t.phone&&e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Phone"}),e.jsx("a",{href:`tel:${t.phone}`,children:t.phone})]})]}),(M||k||b)&&e.jsxs("div",{className:"modal-deep-links",children:[M&&e.jsxs("a",{className:"deep-link",href:M,target:"_blank",rel:"noreferrer",children:[e.jsx("span",{className:"icon",children:"â­"})," Check Reviews"]}),k&&e.jsxs("a",{className:"deep-link",href:k,target:"_blank",rel:"noreferrer",children:[e.jsx("span",{className:"icon",children:"ðŸ½ï¸"})," Find Menu"]}),b&&e.jsxs("a",{className:"deep-link",href:b,target:"_blank",rel:"noreferrer",children:[e.jsx("span",{className:"icon",children:"ðŸ“¸"})," See Photos"]})]}),e.jsxs("div",{className:"modal-callouts",children:[t.mustTry&&e.jsxs("div",{className:"callout callout-specialty",children:[e.jsx("strong",{children:"ðŸ† Specialty"}),e.jsx("p",{children:t.mustTry})]}),t.tip&&e.jsxs("div",{className:"callout callout-tip",children:[e.jsx("strong",{children:"ðŸ’¡ Insider Tip"}),e.jsx("p",{children:t.tip})]}),t.notes&&e.jsxs("div",{className:"callout callout-note",children:[e.jsx("strong",{children:"ðŸ“ Note"}),e.jsx("p",{children:t.notes})]})]}),Array.isArray(t.tags)&&t.tags.length>0&&e.jsx("div",{className:"modal-tags",children:t.tags.map(y=>e.jsxs("span",{className:"tag-chip",children:["#",y]},y))}),e.jsxs("div",{className:"modal-links",children:[t.website&&e.jsx("a",{className:"link-btn primary",href:t.website,target:"_blank",rel:"noreferrer",children:"Official Website â†—"}),S&&e.jsx("a",{className:"link-btn",href:S,target:"_blank",rel:"noreferrer",children:"View on Google Maps â†—"})]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsxs("div",{className:"day-select",children:[e.jsx("label",{htmlFor:"day-select",children:"Add to day"}),e.jsx("select",{id:"day-select",value:p||"",onChange:y=>n(y.target.value),children:a.map(y=>e.jsxs("option",{value:y.id,children:["Day ",y.dayNumber,": ",y.location||y.label]},y.id))}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>m(p,t.id),children:"Add to Trip"})]}),f&&e.jsx("button",{type:"button",className:"btn-outline",onClick:()=>u(s,t.id),children:"Remove from selected day"}),(t.isCustom||t.private)&&typeof c=="function"&&e.jsxs("div",{className:"custom-actions",children:[e.jsx("button",{type:"button",className:"btn-outline",onClick:()=>c(t),children:"âœï¸ Edit Details"}),t.isCustom&&e.jsx("button",{type:"button",className:"btn-danger",onClick:()=>g(t),children:"Delete"})]})]})]})})}function Ce(t){return t?String(t).split(",")[0].trim():""}function qe(t){if(!t)return"";const a=String(t).split(",").map(s=>s.trim()).filter(Boolean);return a.length<=1?"":a.slice(1).join(", ")}function oa(t){const a=String(t?.address?.state_code||"").toUpperCase().trim();if(a)return a;const s=String(t?.address?.ISO3166_2_lvl4||"").toUpperCase().trim(),l=s.startsWith("US-")?s.slice(3):"";return l||String(t?.display_name||"").toUpperCase().match(/,\s*([A-Z]{2})\s*(,|$)/)?.[1]||""}function na(t){const a=Array.isArray(t)?t:[],s=new Set(a);return["ME","NH","VT","MA","CT","RI","NY"].some(u=>s.has(u))?{left:-73.8,top:47.6,right:-66.8,bottom:40.9}:null}function ia(t,a){if(!Array.isArray(t)||!Array.isArray(a))return null;const s=Number(t[0]),l=Number(t[1]),m=Number(a[0]),u=Number(a[1]);if(!Number.isFinite(s)||!Number.isFinite(l)||!Number.isFinite(m)||!Number.isFinite(u))return null;const c=6371,g=M=>M*Math.PI/180,p=g(m-s),n=g(u-l),f=Math.sin(p/2),N=Math.sin(n/2),v=Math.cos(g(s)),S=Math.cos(g(m)),k=f*f+v*S*N*N;return 2*c*Math.asin(Math.min(1,Math.sqrt(k)))}function ra({searchMode:t,onModeChange:a,searchQuery:s,onSearchChange:l,catalogFilter:m,onFilterChange:u,regionFilter:c,onRegionFilterChange:g,showMomOnly:p,onToggleMomOnly:n,filteredCatalog:f,selectedDay:N,onAddActivity:v,onOpenDetails:S,customActivities:k,onQuickAddCustomPlace:M,allowedStateAbbrs:b,allowCanadaPlaces:y,placeSearchCenter:j,onDeleteCustom:E}){const D=Object.values(k||{}),[I,$]=i.useState(""),[V,H]=i.useState([]),[B,w]=i.useState(!1),T=i.useRef(null),[W,C]=i.useState(320),[L,F]=i.useState(!1),ee=i.useRef(null),q=i.useRef(0),Q=i.useRef(0),J=W>=500,le=i.useMemo(()=>!!N?.id&&!!M,[N?.id,M]);i.useEffect(()=>{const o=oe=>{if(!L)return;const ae=oe.clientX-q.current,re=Math.max(260,Math.min(800,Q.current+ae));C(re)},G=()=>{F(!1)};return L?(document.addEventListener("mousemove",o),document.addEventListener("mouseup",G),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",G),document.body.style.cursor="",document.body.style.userSelect=""}},[L]);const je=o=>{o.preventDefault(),F(!0),q.current=o.clientX,Q.current=W},me=()=>{T.current&&(T.current.abort(),T.current=null),$(""),H([]),w(!1)};return i.useEffect(()=>{T.current&&(T.current.abort(),T.current=null);const o=I.trim();if(!o){H([]),w(!1);return}const G=new AbortController;T.current=G,w(!0);const oe=window.setTimeout(async()=>{try{const ae=Array.isArray(b)?b.map(P=>String(P||"").toUpperCase().trim()).filter(Boolean):[],re=new Set(ae),se=na(ae),we=se?`&viewbox=${encodeURIComponent(`${se.left},${se.top},${se.right},${se.bottom}`)}`:"",ce=`https://nominatim.openstreetmap.org/search?format=jsonv2&addressdetails=1&countrycodes=${encodeURIComponent(y?"us,ca":"us")}&limit=10${we}&q=${encodeURIComponent(o)}&email=${encodeURIComponent("mmt-trip-planner@example.com")}`,ne=await fetch(ce,{signal:G.signal});if(!ne.ok){H([]);return}const he=await ne.json(),ie=[...Array.isArray(he)?he.map(P=>{const z=Number(P?.lat),Y=Number(P?.lon);if(!Number.isFinite(z)||!Number.isFinite(Y))return null;const K=String(P?.address?.country_code||"").toLowerCase().trim();if(K&&K!=="us"){if(!(y&&K==="ca"))return null}const ke=oa(P);return{id:String(P?.place_id||`${z},${Y}`),displayName:String(P?.display_name||""),coordinates:[z,Y],stateAbbr:ke}}).filter(Boolean):[]].map((P,z)=>{const Y=re.size>0&&P.stateAbbr?re.has(P.stateAbbr):!1,K=j?ia(j,P.coordinates):null;return{...P,_idx:z,_inAllowed:Y,_distKm:K}}).sort((P,z)=>{if(P._inAllowed!==z._inAllowed)return P._inAllowed?-1:1;const Y=P._distKm,K=z._distKm;return Y!=null&&K!=null&&Y!==K?Y-K:Y!=null&&K==null?-1:Y==null&&K!=null?1:P._idx-z._idx});H(ie.slice(0,6))}catch(ae){ae?.name!=="AbortError"&&H([])}finally{w(!1)}},250);return()=>{window.clearTimeout(oe),G.abort()}},[I,b]),e.jsxs("aside",{className:"catalog",ref:ee,style:{width:`${W}px`,minWidth:"260px",maxWidth:"800px",position:"relative"},children:[e.jsx("div",{className:"catalog-resize-handle",onMouseDown:je,role:"separator","aria-label":"Resize catalog panel"}),e.jsxs("div",{className:"catalog-header",children:[e.jsx("h2",{children:t==="catalog"?"Activities":"Your Places"}),e.jsxs("div",{className:"search-mode-toggle",children:[e.jsx("button",{className:`mode-btn ${t==="catalog"?"active":""}`,onClick:()=>a("catalog"),type:"button",children:"Catalog"}),e.jsx("button",{className:`mode-btn ${t==="custom"?"active":""}`,onClick:()=>a("custom"),type:"button",children:"Custom"})]})]}),t==="catalog"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"catalog-search",children:e.jsx("input",{type:"text",placeholder:"Search activities, tags, or locations",value:s,onChange:o=>l(o.target.value),className:"search-input"})}),e.jsxs("div",{className:"catalog-filters",children:[e.jsx("button",{className:`filter-btn ${m==="all"?"active":""}`,onClick:()=>u("all"),type:"button",children:"All"}),Object.values(Z).filter(o=>o.id!=="city"&&o.id!=="custom"&&o.id!=="lodging").map(o=>e.jsx("button",{className:`filter-btn ${m===o.id?"active":""}`,onClick:()=>u(o.id),type:"button",children:o.icon},o.id)),e.jsxs("label",{className:"mom-filter",children:[e.jsx("input",{type:"checkbox",checked:p,onChange:o=>n(o.target.checked)}),"Mom's picks"]})]}),e.jsx("div",{className:"catalog-region",children:e.jsxs("label",{children:["Region focus",e.jsxs("select",{value:c,onChange:o=>g(o.target.value),children:[e.jsx("option",{value:"all",children:"All regions"}),Object.values($t).map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})]})}),e.jsxs("div",{className:"catalog-list",children:[f.map(o=>e.jsxs("div",{className:`catalog-item ${J?"expanded":""}`,children:[e.jsxs("div",{className:"item-header",children:[e.jsx("span",{className:"item-icon",children:Z[o.category]?.icon}),e.jsxs("div",{className:"item-info",children:[e.jsxs("strong",{children:[o.name,o.momMentioned&&e.jsxs("span",{className:"icon-mom",title:"Mom Mentioned This!",children:[" ","â¤ï¸"]})]}),e.jsx("small",{children:o.location})]}),e.jsx("button",{className:"add-btn-compact",onClick:()=>v(N?.id,o.id),title:`Add to Day ${N?.dayNumber}`,type:"button",children:"+"})]}),e.jsxs("div",{className:"item-stats-row",children:[o.rating&&e.jsxs("span",{className:"stat-badge rating",title:`${o.reviewCount?o.reviewCount.toLocaleString()+" reviews":"Rating"}`,children:["â˜… ",o.rating]}),o.price&&e.jsx("span",{className:"stat-badge price",title:o.priceRange||"Price level",children:o.price}),o.duration&&e.jsxs("span",{className:"stat-badge time",children:["â± ",Ne(o.duration)]}),o.waitTime&&e.jsxs("span",{className:"stat-badge wait",title:"Typical wait",children:["â³ ",o.waitTime]})]}),J&&e.jsxs("div",{className:"item-expanded",children:[o.description&&e.jsx("p",{className:"exp-description",children:o.description}),e.jsxs("div",{className:"exp-info-grid",children:[o.address&&!o.private&&e.jsxs("a",{className:"exp-info-link",href:`https://maps.google.com/?q=${encodeURIComponent(o.address)}`,target:"_blank",rel:"noopener noreferrer",title:"Open in Google Maps",children:[e.jsx("span",{className:"exp-icon",children:"ðŸ“"}),e.jsx("span",{className:"exp-text",children:o.address.split(",")[0]})]}),o.phone&&!o.private&&e.jsxs("a",{className:"exp-info-link",href:`tel:${o.phone}`,children:[e.jsx("span",{className:"exp-icon",children:"ðŸ“ž"}),e.jsx("span",{className:"exp-text",children:o.phone})]}),o.hours&&e.jsxs("div",{className:"exp-info-item",children:[e.jsx("span",{className:"exp-icon",children:"ðŸ•"}),e.jsx("span",{className:"exp-text",children:o.hours})]}),o.parking&&e.jsxs("div",{className:"exp-info-item",children:[e.jsx("span",{className:"exp-icon",children:"ðŸ…¿ï¸"}),e.jsx("span",{className:"exp-text",children:o.parking})]})]}),o.paymentNote&&e.jsx("div",{className:"exp-note",children:o.paymentNote}),o.mustTry&&e.jsxs("div",{className:"exp-callout must-try",children:[e.jsx("strong",{children:"ðŸ½ Try:"})," ",o.mustTry]}),o.highlights&&o.highlights.length>0&&e.jsx("div",{className:"exp-highlights",children:o.highlights.slice(0,3).map((G,oe)=>e.jsxs("span",{className:"highlight-chip",children:["âœ“ ",G]},oe))}),o.tip&&e.jsxs("div",{className:"exp-callout tip",children:[e.jsx("strong",{children:"ðŸ’¡"})," ",o.tip]}),o.momQuote&&e.jsxs("div",{className:"exp-mom-quote",children:['â¤ï¸ "',o.momQuote,'"']}),e.jsxs("div",{className:"exp-links-row",children:[o.website&&e.jsx("a",{href:o.website,target:"_blank",rel:"noopener noreferrer",className:"exp-link",children:"ðŸŒ Website"}),o.coordinates&&!o.private&&e.jsx("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${o.coordinates[0]},${o.coordinates[1]}`,target:"_blank",rel:"noopener noreferrer",className:"exp-link",children:"ðŸ—º Directions"}),o.yelpRating&&!o.private&&e.jsxs("a",{href:`https://www.yelp.com/search?find_desc=${encodeURIComponent(o.name)}&find_loc=${encodeURIComponent(o.location)}`,target:"_blank",rel:"noopener noreferrer",className:"exp-link yelp",title:`Yelp: ${o.yelpRating}/5`,children:[e.jsx("span",{style:{color:"#d32323"},children:"â—"})," Yelp"," ",o.yelpRating]}),o.googleRating&&!o.private&&e.jsxs("a",{href:`https://www.google.com/maps/search/${encodeURIComponent(o.name+" "+o.location)}`,target:"_blank",rel:"noopener noreferrer",className:"exp-link google",title:`Google: ${o.googleRating}/5`,children:[e.jsx("span",{style:{color:"#4285f4"},children:"â—"})," Google"," ",o.googleRating]})]}),o.tags&&o.tags.length>0&&e.jsx("div",{className:"exp-tags",children:o.tags.map(G=>e.jsx("span",{className:"tag-pill",children:G},G))}),o.photoSpot&&e.jsxs("div",{className:"exp-photo-spot",children:["ðŸ“¸ Best shot: ",o.photoSpot]})]}),!J&&e.jsxs("div",{className:"item-collapsed-actions",children:[o.mustTry&&e.jsxs("span",{className:"collapsed-hint",children:["ðŸ½ ",o.mustTry.substring(0,30),"..."]}),e.jsx("button",{type:"button",className:"ghost-btn-sm",onClick:()=>S(o),children:"Details â†’"})]})]},o.id)),s.trim()&&e.jsxs("div",{className:"web-search-promo",children:[e.jsx("p",{children:f.length===0?"No local matches.":"Not seeing it?"}),e.jsx("p",{className:"no-results",children:"Use the Custom tab to search places and add one."})]}),!s.trim()&&f.length===0&&e.jsx("p",{className:"no-results",children:"No activities match your filters."})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"custom-place-form",children:[e.jsx("h4",{children:"Add a place"}),e.jsx("p",{children:"Type a place name and pick a result."}),e.jsx("input",{type:"text",className:"search-input",placeholder:"Search places (e.g., Mike's Pastry Boston)",value:I,onChange:o=>$(o.target.value)}),B&&e.jsx("p",{className:"no-results",children:"Searchingâ€¦"}),!B&&I.trim()&&V.length===0&&e.jsx("p",{className:"no-results",children:"No results."}),V.length>0&&e.jsx("div",{className:"catalog-list",children:V.map(o=>e.jsxs("div",{className:"catalog-item custom-item",children:[e.jsxs("button",{type:"button",className:"item-main",onClick:()=>{le&&(M({dayId:N?.id,name:Ce(o.displayName)||I.trim(),location:qe(o.displayName),coordinates:o.coordinates}),me())},children:[e.jsx("span",{className:"item-icon",children:Z.custom?.icon}),e.jsxs("div",{className:"item-info",children:[e.jsx("strong",{children:Ce(o.displayName)||I.trim()}),e.jsx("small",{children:o.displayName})]})]}),e.jsx("div",{className:"item-actions",children:e.jsx("button",{className:"add-btn",type:"button",disabled:!le,onClick:()=>{le&&(M({dayId:N?.id,name:Ce(o.displayName)||I.trim(),location:qe(o.displayName),coordinates:o.coordinates}),me())},children:"Add"})})]},o.id))})]}),e.jsxs("div",{className:"custom-activities-list",children:[e.jsx("h5",{children:"Your custom library"}),D.length===0&&e.jsx("p",{className:"no-results",children:"No custom places yet."}),D.map(o=>e.jsxs("div",{className:"catalog-item custom-item",children:[e.jsxs("button",{type:"button",className:"item-main",onClick:()=>S(o),children:[e.jsx("span",{className:"item-icon",children:Z[o.category]?.icon||"*"}),e.jsxs("div",{className:"item-info",children:[e.jsx("strong",{children:o.name}),e.jsx("small",{children:o.location})]})]}),e.jsxs("div",{className:"item-actions",children:[e.jsx("button",{className:"add-btn",onClick:()=>v(N?.id,o.id),type:"button",children:"Add"}),e.jsx("button",{type:"button",className:"ghost-btn",onClick:()=>S(o),children:"Details"}),e.jsx("button",{type:"button",className:"ghost-btn",onClick:()=>E(o),children:"Delete"})]})]},o.id))]})]})]})}const Ae={name:"",location:"",address:"",category:"custom",description:"",duration:"",price:"",rating:"",notes:"",tags:"",website:"",phone:""};function la({isOpen:t,onClose:a,onSave:s,initialData:l,days:m,defaultDayId:u}){if(!t)return null;const[c,g]=i.useState(Ae),[p,n]=i.useState(u||""),[f,N]=i.useState(!1),[v,S]=i.useState(!1),k=async j=>{const E=j||(c.location?`${c.name} ${c.location}`:c.name);if(E){S(!0);try{const I=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(E)}`)).json();if(I&&I.length>0){const $=I[0];g(V=>({...V,location:V.location||$.display_name.split(",")[0],coordinates:[Number($.lat),Number($.lon)]}))}else j||alert("No location found for this name.")}catch(D){console.error(D),j||alert("Search failed.")}finally{S(!1)}}};i.useEffect(()=>{const j=l?{...Ae,...l,tags:Array.isArray(l.tags)?l.tags.join(", "):l.tags||""}:Ae;if(g(j),n(u||m?.[0]?.id||""),l?.name&&!l.coordinates&&!l.location){const E=setTimeout(()=>k(l.name),100);return()=>clearTimeout(E)}},[t,l,u,m]);const M=i.useMemo(()=>Object.values(Z).filter(j=>j.id!=="city"),[]),b=j=>E=>{g(D=>({...D,[j]:E.target.value}))},y=async()=>{if(c.name.trim()){N(!0);try{await s({...c,duration:c.duration?Number(c.duration):null,rating:c.rating?Number(c.rating):null,tags:c.tags?c.tags.split(",").map(j=>j.trim()).filter(Boolean):[],dayId:p}),a()}finally{N(!1)}}};return e.jsx("div",{className:"modal-overlay",onClick:a,role:"presentation",children:e.jsxs("div",{className:"modal modal-wide",role:"dialog","aria-modal":"true",onClick:j=>j.stopPropagation(),children:[e.jsxs("header",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsx("span",{className:"modal-eyebrow",children:"Custom place"}),e.jsx("h2",{children:l?"Edit custom place":"Add a custom place"}),e.jsx("p",{children:"Save the details you actually need while planning."})]}),e.jsx("button",{type:"button",className:"icon-btn",onClick:a,"aria-label":"Close custom place",children:"x"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"modal-grid",children:[e.jsxs("label",{children:["Place name",e.jsx("input",{value:c.name,onChange:b("name"),placeholder:"e.g., Mike's Pastry"})]}),e.jsxs("label",{children:["Location",e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("input",{style:{flex:1},value:c.location,onChange:b("location"),placeholder:"e.g., Boston, MA"}),e.jsx("button",{type:"button",className:"btn-outline",onClick:()=>k(),disabled:v,children:v?"...":"ðŸ”"})]})]}),e.jsxs("label",{className:"span-2",children:["Address (optional)",e.jsx("input",{value:c.address,onChange:b("address"),placeholder:"Full address for directions"})]}),e.jsxs("label",{children:["Phone (optional)",e.jsx("input",{value:c.phone,onChange:b("phone"),placeholder:"(207) 555-1234"})]}),e.jsxs("label",{children:["Category",e.jsx("select",{value:c.category,onChange:b("category"),children:M.map(j=>e.jsxs("option",{value:j.id,children:[j.icon," ",j.name]},j.id))})]}),e.jsxs("label",{children:["Duration (hours)",e.jsx("input",{value:c.duration,onChange:b("duration"),placeholder:"1.5"})]}),e.jsxs("label",{children:["Price range",e.jsx("input",{value:c.price,onChange:b("price"),placeholder:"$$"})]}),e.jsxs("label",{children:["Rating",e.jsx("input",{value:c.rating,onChange:b("rating"),placeholder:"4.8"})]}),e.jsxs("label",{className:"span-2",children:["Description",e.jsx("textarea",{value:c.description,onChange:b("description"),placeholder:"Why this place matters"})]}),e.jsxs("label",{className:"span-2",children:["Notes",e.jsx("textarea",{value:c.notes,onChange:b("notes"),placeholder:"Reservations, parking tips, best time to go"})]}),e.jsxs("label",{className:"span-2",children:["Tags (comma separated)",e.jsx("input",{value:c.tags,onChange:b("tags"),placeholder:"lobster, sunset, photo"})]}),e.jsxs("label",{className:"span-2",children:["Website or booking link",e.jsx("input",{value:c.website,onChange:b("website"),placeholder:"https://"})]})]})}),e.jsxs("div",{className:"modal-actions",children:[e.jsxs("div",{className:"day-select",children:[e.jsx("label",{htmlFor:"day-select-custom",children:"Add to day"}),e.jsx("select",{id:"day-select-custom",value:p,onChange:j=>n(j.target.value),children:m.map(j=>e.jsxs("option",{value:j.id,children:["Day ",j.dayNumber,": ",j.location||j.label]},j.id))})]}),e.jsx("button",{type:"button",className:"btn-outline",onClick:a,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:y,disabled:f,children:f?"Saving...":"Save place"})]})]})})}function ca({activity:t,onOpenDetails:a}){const{attributes:s,listeners:l,setNodeRef:m,transform:u,transition:c,isDragging:g}=lt({id:t.id}),p={transform:ct.Transform.toString(u),transition:c,opacity:g?.6:1};return e.jsxs("div",{ref:m,style:p,className:"board-card",children:[e.jsxs("button",{type:"button",className:"activity-main",onClick:()=>a(t),children:[e.jsx("span",{className:"activity-icon",children:Z[t.category]?.icon||"*"}),e.jsxs("div",{className:"activity-info",children:[e.jsx("strong",{children:t.name}),e.jsx("small",{children:t.location})]})]}),e.jsx("button",{type:"button",className:"drag-handle",...s,...l,"aria-label":"Drag",children:"::"})]})}function da({day:t,activities:a,selectedDayId:s,onSelectDay:l,onOpenDetails:m}){const u=`day:${t.id}`,{setNodeRef:c}=Ct({id:u});return e.jsxs("section",{className:`board-column ${t.id===s?"active":""}`,onClick:()=>l(t.id),children:[e.jsxs("header",{className:"board-column-header",children:[e.jsxs("div",{children:[e.jsxs("h4",{children:["Day ",t.dayNumber]}),e.jsx("p",{children:t.location||t.label})]}),e.jsx("span",{className:"board-count",children:a.length})]}),e.jsx("div",{className:"board-list",ref:c,children:e.jsxs(it,{items:a.map(g=>g.id),strategy:rt,children:[a.length===0&&e.jsx("p",{className:"board-empty",children:"Drop activities here."}),a.map(g=>e.jsx(ca,{activity:g,onOpenDetails:m},g.id))]})})]})}function ua({trip:t,selectedDayId:a,onSelectDay:s,getActivity:l,onUpdateTripDays:m,onOpenDetails:u}){const c=i.useMemo(()=>t.days.reduce((p,n)=>(p[n.id]=n.activities.map(f=>l(f)).filter(Boolean),p),{}),[t.days,l]),g=(p,n)=>typeof p=="string"&&p.startsWith("day:")?p.replace("day:",""):n.find(f=>f.activities.includes(p))?.id;return e.jsx("div",{className:"board-view",children:e.jsx(st,{collisionDetection:ot,onDragEnd:({active:p,over:n})=>{n&&p.id!==n.id&&m(f=>{const N=f.days.map(y=>({...y,activities:[...y.activities],schedule:y.schedule?{...y.schedule}:{}})),v=g(p.id,N),S=g(n.id,N);if(!v||!S)return f;const k=N.find(y=>y.id===v),M=N.find(y=>y.id===S);if(!k||!M)return f;const b=k.activities.indexOf(p.id);if(b<0)return f;if(v===S){const y=M.activities.indexOf(n.id);if(y<0)return f;k.activities=nt(k.activities,b,y)}else{k.activities.splice(b,1);const y=M.activities.indexOf(n.id),j=y>=0?y:M.activities.length;M.activities.splice(j,0,p.id),k.schedule?.[p.id]&&(M.schedule=M.schedule||{},M.schedule[p.id]=k.schedule[p.id],delete k.schedule[p.id])}return{...f,days:N}})},children:e.jsx("div",{className:"board-grid",children:t.days.map(p=>e.jsx(da,{day:p,activities:c[p.id]||[],selectedDayId:a,onSelectDay:s,onOpenDetails:u},p.id))})})})}const ma=[{value:"arrival",label:"Arrival"},{value:"drive",label:"Drive day"},{value:"explore",label:"Explore"},{value:"relaxed",label:"Relaxed"},{value:"departure",label:"Departure"},{value:"custom",label:"Custom"}];function ha({activity:t,index:a,dayId:s,onRemove:l,onOpenDetails:m}){const{attributes:u,listeners:c,setNodeRef:g,transform:p,transition:n,isDragging:f}=lt({id:t.id}),N={transform:ct.Transform.toString(p),transition:n,opacity:f?.6:1};return e.jsxs("div",{ref:g,style:N,className:`activity-card ${t.isCustom?"custom":""}`,children:[e.jsx("span",{className:"activity-order",children:a+1}),e.jsx("button",{className:"drag-handle",type:"button","aria-label":"Drag to reorder",...u,...c,children:"::"}),e.jsxs("button",{type:"button",className:"activity-main",onClick:()=>m(t),children:[e.jsx("span",{className:"activity-icon",children:Z[t.category]?.icon??"*"}),e.jsxs("div",{className:"activity-info",children:[e.jsxs("strong",{children:[t.name,t.momMentioned&&e.jsx("span",{className:"mom-badge",children:"*"})]}),e.jsx("small",{children:t.location})]})]}),e.jsx("button",{className:"remove-btn",onClick:()=>l(s,t.id),type:"button",children:"x"})]})}function pa({trip:t,selectedDay:a,selectedDayId:s,selectedDayActivities:l,selectedDayActivityIds:m,dayRoute:u,dayLoad:c,dayLoadLabel:g,onSelectDay:p,onAddDay:n,onRemoveDay:f,onDuplicateDay:N,onUpdateDay:v,onReorderActivities:S,onRemoveActivity:k,onOpenDetails:M}){return e.jsxs("section",{className:"trip-builder",children:[e.jsxs("div",{className:"day-tabs",children:[t.days.map(b=>e.jsxs("button",{className:`day-tab ${b.id===s?"active":""}`,onClick:()=>p(b.id),type:"button",children:[e.jsxs("span",{className:"day-num",children:["D",b.dayNumber]}),e.jsx("span",{className:"day-loc",children:b.location||"..."}),e.jsx("span",{className:"day-count",children:b.activities.length})]},b.id)),e.jsx("button",{className:"add-day-btn",onClick:n,type:"button",children:"+"})]}),a&&e.jsxs("div",{className:"day-content",children:[e.jsxs("div",{className:"day-header",children:[e.jsxs("div",{children:[e.jsxs("h2",{children:["Day ",a.dayNumber]}),e.jsxs("p",{className:"day-load",children:[g," | ",c]})]}),e.jsxs("div",{className:"day-actions",children:[e.jsx("select",{value:a.type||"custom",onChange:b=>v(a.id,{type:b.target.value}),className:"day-type-select",children:ma.map(b=>e.jsx("option",{value:b.value,children:b.label},b.value))}),e.jsx("button",{type:"button",className:"ghost-btn",onClick:()=>N(a.id),children:"Duplicate"}),t.days.length>1&&e.jsx("button",{type:"button",className:"ghost-btn",onClick:()=>f(a.id),children:"Remove"})]})]}),e.jsxs("label",{className:"field",children:["Day location (optional)",e.jsx("input",{type:"text",value:a.location,onChange:b=>v(a.id,{location:b.target.value}),placeholder:"City / area (e.g., Portland, ME)",className:"location-input"})]}),e.jsx("textarea",{value:a.notes,onChange:b=>v(a.id,{notes:b.target.value}),placeholder:"Notes for this day: reservations, timing, backup options",className:"day-notes"}),e.jsxs("div",{className:"activities-list",children:[e.jsxs("h3",{children:["Activities (",l.length,")"]}),l.length===0?e.jsx("p",{className:"empty-msg",children:"Add activities from the catalog or your custom list."}):e.jsx(st,{collisionDetection:ot,onDragEnd:({active:b,over:y})=>{if(!y||b.id===y.id)return;const j=m.indexOf(b.id),E=m.indexOf(y.id);j<0||E<0||S(a.id,j,E)},children:e.jsx(it,{items:m,strategy:rt,children:l.map((b,y)=>e.jsx(ha,{activity:b,index:y,dayId:a.id,onRemove:k,onOpenDetails:M},b.id))})}),e.jsxs("div",{className:"drive-summary",children:[e.jsxs("div",{className:"drive-header",children:[e.jsx("h3",{children:"Driving"}),!u&&e.jsx("span",{className:"drive-meta",children:"Add two or more pinned stops."})]}),u?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"drive-totals",children:["Total: ",e.jsx("strong",{children:xe(u.distance_m)})," |"," ",e.jsx("strong",{children:ve(u.duration_s)})]}),u.legs?.length>0&&e.jsx("div",{className:"drive-legs",children:u.legs.map((b,y)=>e.jsxs("div",{className:"drive-leg",children:[e.jsxs("span",{className:"drive-leg-title",children:[b.from," -> ",b.to]}),e.jsxs("span",{className:"drive-leg-meta",children:[xe(b.distance_m)," |"," ",ve(b.duration_s)]})]},y))})]}):e.jsx("div",{className:"drive-empty",children:"No driving route yet."})]})]})]})]})}function ga({bounds:t}){const a=at();return i.useEffect(()=>{!t||t.length<1||a.fitBounds(t,{paddingTopLeft:[32,80],paddingBottomRight:[32,32]})},[a,t]),null}const Te={standard:{name:"Standard",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attr:"&copy; OpenStreetMap"},light:{name:"Light",url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attr:"&copy; OpenStreetMap &copy; CARTO"},dark:{name:"Dark",url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attr:"&copy; OpenStreetMap &copy; CARTO"},terrain:{name:"Terrain",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attr:"Tiles &copy; Esri"}};function fa({mapActivities:t,dayRoutes:a,selectedDayId:s,selectedDayBounds:l,tripRouteTotals:m,routesLoading:u,routesError:c,gasPricePerGallon:g,onGasPriceChange:p,vehicleMpg:n,onVehicleMpgChange:f,estimatedFuelCost:N,onResetTrip:v,googleMapsUrl:S,weatherUrl:k}){const[y,j]=i.useState("light"),[E,D]=i.useState(450),[I,$]=i.useState(!1),V=i.useRef(null),H=i.useRef(0),B=i.useRef(0),w=i.useRef(null),T=E>=600;i.useEffect(()=>{const C=F=>{if(!I)return;const ee=H.current-F.clientX,q=Math.max(360,Math.min(720,B.current+ee));D(q)},L=()=>{$(!1)};return I?(document.addEventListener("mousemove",C),document.addEventListener("mouseup",L),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",L),document.body.style.cursor="",document.body.style.userSelect=""}},[I]);const W=C=>{C.preventDefault(),$(!0),H.current=C.clientX,B.current=E};return i.useEffect(()=>{if(!w.current)return;const C=w.current;requestAnimationFrame(()=>{C.invalidateSize()})},[E]),i.useEffect(()=>{if(!V.current||!w.current)return;const C=w.current,L=new ResizeObserver(()=>{requestAnimationFrame(()=>{C.invalidateSize()})});return L.observe(V.current),()=>L.disconnect()},[]),i.useEffect(()=>{if(!w.current||!t||t.length===0)return;const L=t[t.length-1]?.coordinates;if(!Array.isArray(L)||L.length<2)return;const F=w.current;requestAnimationFrame(()=>{F.setView(L,Math.max(F.getZoom(),11))})},[t]),e.jsxs("aside",{className:"map-panel",ref:V,style:{width:`${E}px`,minWidth:"360px",maxWidth:"720px",position:"relative"},children:[e.jsx("div",{className:"map-resize-handle",onMouseDown:W,role:"separator","aria-label":"Resize map panel"}),e.jsxs("div",{className:"map-header",children:[e.jsxs("div",{className:"map-title",children:[e.jsx("h3",{children:"Trip map"}),T?e.jsxs("div",{className:"map-metrics-expanded",children:[e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{className:"metric-label",children:"Activities"}),e.jsxs("span",{className:"metric-value",children:[t.length," pins"]})]}),e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{className:"metric-label",children:"Trip Distance"}),e.jsx("span",{className:"metric-value",children:xe(m.distance_m)})]}),e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{className:"metric-label",children:"Drive Time"}),e.jsx("span",{className:"metric-value",children:ve(m.duration_s)})]}),N!=null&&e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{className:"metric-label",children:"Est. Fuel Cost"}),e.jsx("span",{className:"metric-value",children:He(N)})]}),u&&e.jsx("div",{className:"metric-item status",children:e.jsx("span",{className:"metric-value",children:"Calculating routes..."})}),c&&e.jsx("div",{className:"metric-item status error",children:e.jsx("span",{className:"metric-value",children:c})})]}):e.jsxs("div",{className:"map-metrics",children:[e.jsxs("span",{className:"map-stat",children:[t.length," pins"]}),e.jsxs("span",{className:"map-stat",children:["Trip: ",xe(m.distance_m)," |"," ",ve(m.duration_s)]}),N!=null&&e.jsxs("span",{className:"map-stat",children:["Est: ",He(N)]}),u&&e.jsx("span",{className:"map-stat",children:"Calculating routes..."}),c&&e.jsx("span",{className:"map-stat error",children:c})]})]}),e.jsxs("div",{className:`map-controls ${T?"expanded":""}`,children:[e.jsx("select",{className:"style-select",value:y,onChange:C=>j(C.target.value),"aria-label":"Map style",children:Object.entries(Te).map(([C,L])=>e.jsxs("option",{value:C,children:[L.name," Map"]},C))}),e.jsxs("label",{className:"cost-input",children:[T&&e.jsx("span",{className:"input-label",children:"Price per gallon"}),e.jsxs("div",{className:"input-row",children:[e.jsx("span",{className:"input-prefix",children:"$/gal"}),e.jsx("input",{value:g,onChange:C=>p(C.target.value),inputMode:"decimal",placeholder:"3.50","aria-label":"Gas price per gallon"})]})]}),e.jsxs("label",{className:"cost-input",children:[T&&e.jsx("span",{className:"input-label",children:"Vehicle MPG"}),e.jsxs("div",{className:"input-row",children:[e.jsx("span",{className:"input-prefix",children:"MPG"}),e.jsx("input",{value:n,onChange:C=>f(C.target.value),inputMode:"decimal",placeholder:"28","aria-label":"Vehicle miles per gallon"})]})]}),S&&e.jsx("a",{className:"btn-primary btn-sm",href:S,target:"_blank",rel:"noreferrer",children:"Navigate Day â†—"}),k&&e.jsx("a",{className:"ghost-btn",href:k,target:"_blank",rel:"noreferrer",children:"Forecast â†—"})]})]}),e.jsx("div",{className:"map-container",children:e.jsxs(Je,{center:[43.5,-71.5],zoom:7,style:{height:"100%",width:"100%"},whenCreated:C=>{w.current=C},children:[l&&e.jsx(ga,{bounds:l}),e.jsx(Xe,{url:Te[y].url,attribution:Te[y].attr}),Object.values(a).map(C=>e.jsx(Ze,{positions:C.line,pathOptions:{color:Ft(C.dayNumber),weight:C.dayId===s?5:3,opacity:C.dayId===s?.9:.35}},`route-${C.dayId}`)),t.map((C,L)=>e.jsx(et,{position:C.coordinates,children:e.jsxs(tt,{children:[e.jsxs("strong",{children:["Day ",C.dayNumber,": ",C.name]}),e.jsx("br",{}),C.location]})},`${C.id}-${L}`))]},`map-${Math.round(E)}`)})]})}const Ue="mmt-gas-price-per-gallon",Ye="mmt-vehicle-mpg";function ba({trip:t,setTrip:a,customActivities:s,setCustomActivities:l}){const[m,u]=i.useState(t.days[0]?.id||"day-1"),[c,g]=i.useState("catalog"),[p,n]=i.useState("all"),[f,N]=i.useState("all"),[v,S]=i.useState(""),[k,M]=i.useState(!1),[b,y]=i.useState(null),[j,E]=i.useState(null),[D,I]=i.useState("day"),[$,V]=i.useState(()=>{try{return localStorage.getItem(Ue)||""}catch{return""}}),[H,B]=i.useState(()=>{try{return localStorage.getItem(Ye)||""}catch{return""}});i.useEffect(()=>{try{localStorage.setItem(Ue,$)}catch{}},[$]),i.useEffect(()=>{try{localStorage.setItem(Ye,H)}catch{}},[H]),i.useEffect(()=>{t.days.length&&(t.days.find(d=>d.id===m)||u(t.days[0].id))},[t.days,m]);const w=i.useMemo(()=>t.days.find(d=>d.id===m)||t.days[0],[t.days,m]),T=i.useCallback(d=>Re(d)||s[d]||null,[s]),W=i.useMemo(()=>w?w.activities.map(d=>T(d)).filter(Boolean):[],[w,T]),C=i.useMemo(()=>{const d=[];t?.startLocation&&d.push(t.startLocation),t?.endLocation&&d.push(t.endLocation),(t?.days||[]).forEach(h=>{h?.location&&d.push(h.location),h?.label&&d.push(h.label)}),Object.values(s||{}).forEach(h=>{h?.location&&d.push(h.location)});const r=new Set;return d.forEach(h=>{ea(h).forEach(x=>r.add(x))}),r.size===0?[]:ta(Array.from(r))},[t?.startLocation,t?.endLocation,t?.days,s]),L=i.useMemo(()=>{const d=[];t?.startLocation&&d.push(t.startLocation),t?.endLocation&&d.push(t.endLocation),(t?.days||[]).forEach(h=>{h?.location&&d.push(h.location),h?.label&&d.push(h.label),h?.notes&&d.push(h.notes)});const r=d.join(" ").toLowerCase();return r.includes("canada")||r.includes("montreal")||r.includes("quÃ©bec")||r.includes("quebec")||r.includes(" qc")||r.includes(",qc")},[t?.startLocation,t?.endLocation,t?.days]),F=i.useMemo(()=>w?.activities||[],[w]),ee=i.useMemo(()=>{let d=mt.filter(r=>r.category!=="city"&&r.category!=="lodging");if(p!=="all"&&(d=d.filter(r=>r.category===p)),f!=="all"&&(d=d.filter(r=>r.region===f)),k&&(d=d.filter(r=>r.momMentioned)),v.trim()){const r=v.toLowerCase();d=d.filter(h=>h.name.toLowerCase().includes(r)||h.location?.toLowerCase().includes(r)||h.description?.toLowerCase().includes(r)||h.tags?.some(x=>x.toLowerCase().includes(r)))}return d},[p,f,k,v]),q=i.useCallback((d,r)=>{d&&a(h=>({...h,days:h.days.map(x=>x.id!==d||x.activities.includes(r)?x:{...x,activities:[...x.activities,r]})}))},[a]),Q=i.useCallback((d,r)=>{a(h=>({...h,days:h.days.map(x=>{if(x.id!==d)return x;const A={...x.schedule||{}};return delete A[r],{...x,activities:x.activities.filter(O=>O!==r),schedule:A}})}))},[a]),J=i.useCallback((d,r,h)=>{r!==h&&a(x=>({...x,days:x.days.map(A=>A.id!==d?A:{...A,activities:nt(A.activities,r,h)})}))},[a]),le=i.useCallback((d,r)=>{a(h=>({...h,days:h.days.map(x=>x.id===d?{...x,...r}:x)}))},[a]),je=i.useCallback((d,r,h)=>{a(x=>({...x,days:x.days.map(A=>{if(A.id!==d)return A;const O={...A.schedule||{}},_=O[r]||{},X={...h};if(X.duration!==void 0){const te=Number(X.duration);X.duration=Number.isFinite(te)?te:0}if(X.bufferMinutes!==void 0){const te=Number(X.bufferMinutes);X.bufferMinutes=Number.isFinite(te)?te:0}return O[r]={..._,...X},{...A,schedule:O}})}))},[a]),me=i.useCallback(d=>{a(r=>({...r,days:r.days.map(h=>{if(h.id!==d)return h;const x=h.activities.map(_=>T(_)).filter(Boolean),A=h.startTime||"09:00",O=Kt({activities:x,startTime:A,bufferMinutes:20});return{...h,schedule:O,startTime:A}})}))},[T,a]),o=i.useCallback(()=>{a(d=>{const r=d.days.length+1;return{...d,days:[...d.days,{id:`day-${r}`,dayNumber:r,label:`Day ${r}`,location:"",activities:[],notes:"",type:"explore",lodging:null,startTime:"09:00",schedule:{}}]}})},[a]),G=i.useCallback(d=>{t.days.length<=1||a(r=>({...r,days:Ve(r.days.filter(h=>h.id!==d))}))},[t.days.length,a]),oe=i.useCallback(d=>{a(r=>{const h=r.days.findIndex(O=>O.id===d);if(h<0)return r;const x={...r.days[h],activities:[...r.days[h].activities],schedule:r.days[h].schedule?{...r.days[h].schedule}:{}},A=[...r.days];return A.splice(h+1,0,x),{...r,days:Ve(A)}})},[a]),ae=i.useCallback(()=>{window.confirm("Clear the entire trip builder?")&&(a(Qt({name:"My Custom Trip",startLocation:"",endLocation:"",dayCount:5,style:"balanced"})),u("day-1"))},[a]),re=i.useCallback(async({dayId:d,name:r,location:h,coordinates:x})=>{const A=String(r||"").trim();if(!A)return;const O=String(h||"").trim(),_=`custom-${Date.now()}`,X=`${A} ${O||"New England"}`.trim();let te=Array.isArray(x)?x:null;if(!te)try{te=await Ie(X)}catch{}const wt={id:_,name:A,location:O,category:"custom",description:"",duration:null,price:"",rating:null,notes:"",tags:[],website:"",momMentioned:!1,isCustom:!0,source:"custom",coordinates:te,googleMapsUrl:`https://www.google.com/maps/search/${encodeURIComponent(X)}`};l(kt=>({...kt,[_]:wt})),d&&q(d,_)},[q,l]),se=i.useCallback(d=>{window.confirm("Delete this custom place everywhere?")&&(l(r=>{const h={...r};return delete h[d.id],h}),a(r=>({...r,days:r.days.map(h=>({...h,activities:h.activities.filter(x=>x!==d.id)}))})),b?.id===d.id&&y(null))},[b,l,a]),we=i.useCallback(d=>{E(d),y(null)},[]),Pe=i.useCallback(d=>{const r=j;if(!r)return;const h=r.isCustom?r.id:`custom-${r.id}`,x={...r,...d,id:h,isCustom:!0,momMentioned:r.momMentioned,momQuote:r.momQuote,private:r.private};l(A=>({...A,[h]:x})),!r.isCustom&&r.id!==h&&a(A=>({...A,days:A.days.map(O=>({...O,activities:O.activities.map(_=>_===r.id?h:_)}))})),E(null)},[j,l,a]),ce=i.useCallback(d=>(d?.activities||[]).map(r=>T(r)).filter(r=>r?.category!=="city").filter(r=>r?.coordinates&&Array.isArray(r.coordinates)).map(r=>({id:r.id,name:r.name,coordinates:r.coordinates})),[T]),{dayRoutes:ne,routesLoading:he,routesError:$e,baseCoordsByLabel:ie}=Vt({trip:t,getActivityWaypoints:ce}),P=ne[m]||null,z=i.useMemo(()=>{let d=0,r=0;return Object.values(ne).forEach(h=>{d+=h?.distance_m||0,r+=h?.duration_s||0}),{distance_m:d,duration_s:r}},[ne]),Y=i.useMemo(()=>{const d=Number(String($).trim());return Number.isFinite(d)&&d>0?d:null},[$]),K=i.useMemo(()=>{const d=Number(String(H).trim());return Number.isFinite(d)&&d>0?d:null},[H]),ke=z.distance_m/1609.344,pt=Y&&K?ke/K*Y:null,gt=i.useMemo(()=>{const d=[];return t.days.forEach(r=>{r.activities.forEach(h=>{const x=T(h);x?.coordinates&&x?.category!=="city"&&d.push({...x,dayNumber:r.dayNumber})})}),d},[t.days,T]),Me=i.useMemo(()=>t.days.findIndex(d=>d.id===m),[t.days,m]),de=i.useMemo(()=>{if(!w)return null;const d=w?.type==="drive",r=(w?.location||"").trim()||null,h=Me>0?(t.days[Me-1]?.location||"").trim():null,x=d?h:r,A=[];return x&&ie[x]&&A.push(ie[x]),A.push(...ce(w).map(O=>O.coordinates)),d&&r&&ie[r]&&r!==x&&A.push(ie[r]),A.length?A:null},[w,Me,t.days,ie,ce]),ft=i.useMemo(()=>{if(!de||de.length===0)return null;let d=0,r=0,h=0;return de.forEach(x=>{if(!Array.isArray(x)||x.length<2)return;const A=Number(x[0]),O=Number(x[1]);!Number.isFinite(A)||!Number.isFinite(O)||(d+=A,r+=O,h+=1)}),h===0?null:[d/h,r/h]},[de]),bt=i.useMemo(()=>{if(!w)return null;const d=_=>_.coordinates&&Array.isArray(_.coordinates)?`${_.coordinates[0]},${_.coordinates[1]}`:`${_.name} ${_.location||""}`.trim(),r=W;if(r.length===0&&!w.location)return null;let h=w.location||"";r.length>0&&(h=d(r[0]));let x=w.location||"";r.length>0&&(x=d(r[r.length-1]));const A=r.length>2?r.slice(1,-1).map(d):[],O=new URLSearchParams({api:"1",origin:h,destination:x,travelmode:"driving"});return A.length&&O.set("waypoints",A.join("|")),`https://www.google.com/maps/dir/?${O.toString()}`},[w,W]),yt=i.useMemo(()=>w?.location?`https://www.google.com/search?q=${encodeURIComponent(`weather ${w.location}`)}`:null,[w]),xt=w?.schedule||{},vt=W.reduce((d,r)=>{const h=xt[r.id]?.duration??r.duration??0;return d+(Number(h)||0)},0),Nt=P?P.duration_s/3600:0,ue=vt+Nt;let pe="Easy day";ue>=9?pe="Ambitious day":ue>=7?pe="Full day":ue>=5&&(pe="Balanced day");const jt=ue>0?`Est. ${Ne(ue)}`:"No timing yet";return e.jsxs("div",{className:"builder-layout",children:[e.jsx(ra,{searchMode:c,onModeChange:g,searchQuery:v,onSearchChange:S,catalogFilter:p,onFilterChange:n,regionFilter:f,onRegionFilterChange:N,showMomOnly:k,onToggleMomOnly:M,filteredCatalog:ee,selectedDay:w,onAddActivity:q,onOpenDetails:y,customActivities:s,onQuickAddCustomPlace:re,allowedStateAbbrs:C,allowCanadaPlaces:L,placeSearchCenter:ft,onDeleteCustom:se}),e.jsxs("div",{className:"planner-column",children:[e.jsxs("div",{className:"planner-view-toggle",children:[e.jsx("button",{type:"button",className:`mode-btn ${D==="day"?"active":""}`,onClick:()=>I("day"),children:"Focused Day"}),e.jsx("button",{type:"button",className:`mode-btn ${D==="board"?"active":""}`,onClick:()=>I("board"),children:"All Days Board"})]}),D==="day"?e.jsx(pa,{trip:t,selectedDay:w,selectedDayId:m,selectedDayActivities:W,selectedDayActivityIds:F,dayRoute:P,dayLoad:jt,dayLoadLabel:pe,onSelectDay:u,onAddDay:o,onRemoveDay:G,onDuplicateDay:oe,onUpdateDay:le,onUpdateSchedule:je,onAutoSchedule:me,onReorderActivities:J,onRemoveActivity:Q,onOpenDetails:y}):e.jsx(ua,{trip:t,selectedDayId:m,onSelectDay:u,getActivity:T,onUpdateTripDays:a,onOpenDetails:y})]}),e.jsx(fa,{mapActivities:gt,dayRoutes:ne,selectedDayId:m,selectedDayBounds:de,tripRouteTotals:z,routesLoading:he,routesError:$e,gasPricePerGallon:$,onGasPriceChange:V,vehicleMpg:H,onVehicleMpgChange:B,estimatedFuelCost:pt,onResetTrip:ae,googleMapsUrl:bt,weatherUrl:yt}),b&&e.jsx(sa,{activity:b,days:t.days,selectedDayId:m,onClose:()=>y(null),onAddToDay:q,onRemoveFromDay:Q,onEditCustom:we,onDeleteCustom:se}),j&&e.jsx(la,{isOpen:!0,onClose:()=>E(null),onSave:Pe,initialData:j,days:t.days,defaultDayId:m})]})}const ht=[{id:"moms-original",name:"Mom's Original Route",emoji:"ðŸ’•",source:"MMTrip.txt",description:"The full experienceâ€”coast, mountains, city, and countryside. Based on Tere's original planning document.",duration:"7-9 days",totalMiles:"~780 miles",driveTime:"~16 hours total",flyIn:"Boston (BOS)",flyOut:"Albany (ALB)",vibe:"Classic road trip with flexibility built in",bestFor:["First-timers","Want it all","Full experience"],countries:["USA","Canada"],states:["MA","NH","ME","VT","QC","NY"],days:[{dayNumber:1,label:"Arrive Boston",location:"Boston, MA",type:"arrival",notes:"Use arrival day and perhaps next day for touring the city and eating some LOBSTA!",suggestedActivities:["landmark-freedom-trail","lobster-neptune"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:2,label:"Boston Exploration",location:"Boston, MA",type:"explore",notes:"The city is FULL of history, of course.",suggestedActivities:["landmark-freedom-trail"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:3,label:"Coastal Drive to Portland",location:"Portland, ME",type:"drive",driveTime:"2-3.5 hours (depending on route)",notes:"Drive up the coast to Portlandâ€”stay 1 night. Take Route 1 for harbor towns!",suggestedActivities:["drive-route-1-coast","town-ogunquit","town-kennebunkport","lobster-clam-shack","lobster-chauncey","town-portland-old-port"],lodging:"lodge-press-portland",flexible:!0},{dayNumber:4,label:"Mountains & Vermont",location:"Chelsea, VT",type:"drive",driveTime:"3.5-4 hours (with stops)",notes:"Through the Kancamagus Highway to Sally's Vermont property.",suggestedActivities:["drive-kancamagus","hike-sabbaday-falls","foliage-hancock-overlook","landmark-albany-covered-bridge","hike-sallys-property"],lodging:"lodge-sallys",flexible:!0},{dayNumber:5,label:"Vermont Day",location:"Chelsea, VT",type:"explore",notes:"We can do some serious walking/hiking just on Sally's property alone.",suggestedActivities:["hike-sallys-property","foliage-chelsea-vermont"],lodging:"lodge-sallys",flexible:!0},{dayNumber:6,label:"Vermont to Montreal",location:"Montreal, QC",type:"drive",driveTime:"2.5-3 hours (with Burlington stop)",notes:"No specific plans for Burlington, just a nice stopping place. Explore Montreal.",suggestedActivities:["food-cold-hollow","food-ben-jerrys","landmark-notre-dame"],lodging:"lodge-petit-montreal",flexible:!0},{dayNumber:7,label:"Montreal Exploration",location:"Montreal, QC",type:"explore",notes:"Explore Montreal. Bagels, smoked meat, Mount Royal, poutine!",suggestedActivities:["food-st-viateur","food-schwartzs","hike-mount-royal","landmark-notre-dame","food-la-banquise"],lodging:"lodge-petit-montreal",flexible:!0},{dayNumber:8,label:"Adirondacks to Saratoga",location:"Saratoga Springs, NY",type:"drive",driveTime:"~4 hours (with Lake Placid detour)",notes:"Drive to Saratoga Springs via Lake Placid (optional). Fly out of Albany.",suggestedActivities:["foliage-lake-placid","drive-whiteface"],lodging:"lodge-adelphi-saratoga",flexible:!0},{dayNumber:9,label:"Departure",location:"Albany, NY",type:"departure",notes:"Fly home from Albanyâ€”or drive back east toward Stockbridge/Boston.",suggestedActivities:[],flexible:!0}],alternatives:[{name:"Berkshires Finish",description:"Continue to Stockbridge, MA for Ice Glen & Laura's Tower hikes before returning to Boston",modifiesDay:8,activities:["hike-ice-glen"],flyOut:"Boston (BOS)"},{name:"Finger Lakes Extension",description:"Explore the Finger Lakes area for wineries and waterfalls",addsDays:1,activities:[],flyOut:"Albany (ALB)"}]},{id:"coastal-lobster",name:"Coastal Lobster Focus",emoji:"ðŸ¦ž",source:"research",description:"More time on the Maine coast, maximize lobster consumption, skip the Montreal detour.",duration:"6-7 days",totalMiles:"~450 miles",driveTime:"~10 hours total",flyIn:"Boston (BOS)",flyOut:"Boston (BOS)",vibe:"Slow and savory, harbor-hopping",bestFor:["Lobster lovers","Coastal vibes","Less driving"],countries:["USA"],states:["MA","NH","ME","VT"],days:[{dayNumber:1,label:"Arrive Boston",location:"Boston, MA",type:"arrival",notes:"Arrive and immediately get lobster at Neptune Oyster.",suggestedActivities:["lobster-neptune"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:2,label:"Southern Maine Coast",location:"Boston â†’ Kennebunkport, ME",type:"drive",driveTime:"1.5-2.5 hours",notes:"Take the slow coastal Route 1, hit every harbor town.",suggestedActivities:["town-portsmouth","lobster-chauncey","town-ogunquit","hike-marginal-way","town-kennebunkport","lobster-clam-shack"],flexible:!0},{dayNumber:3,label:"Portland Food Day",location:"Kennebunkport â†’ Portland, ME",type:"drive",driveTime:"30 min",notes:"All the lobster spots, all the foodie destinations.",suggestedActivities:["lobster-eventide","town-portland-old-port","food-duckfat","lobster-highroller","landmark-portland-head-light","lobster-bite-into"],lodging:"lodge-press-portland",flexible:!0},{dayNumber:4,label:"Northern Maine Coast",location:"Portland â†’ Camden, ME",type:"drive",driveTime:"2 hours",notes:"Optional extension north for McLoons and Camden.",suggestedActivities:["lobster-mcloons","town-camden","hike-mount-battie"],flexible:!0},{dayNumber:5,label:"Mountains & Vermont",location:"Camden â†’ Chelsea, VT",type:"drive",driveTime:"4 hours",notes:"Cut across to Vermont for fall colors.",suggestedActivities:["drive-kancamagus","hike-sallys-property"],lodging:"lodge-sallys",flexible:!0},{dayNumber:6,label:"Return to Boston",location:"Chelsea â†’ Boston, MA",type:"drive",driveTime:"2.5 hours",notes:"Head back to Boston for departure.",suggestedActivities:[],flexible:!0},{dayNumber:7,label:"Departure",location:"Boston, MA",type:"departure",notes:"Fly home from Boston.",suggestedActivities:[],flexible:!0}],alternatives:[]},{id:"foliage-chaser",name:"Foliage Chaser Route",emoji:"ðŸ",source:"research",description:"Optimized for peak fall colors. Chase the foliage up the mountains.",duration:"6-7 days",totalMiles:"~600 miles",driveTime:"~12 hours total",flyIn:"Boston (BOS)",flyOut:"Albany (ALB)",vibe:"Leaf-peeping paradise, hiking focused",bestFor:["Fall color enthusiasts","Hikers","Photographers"],countries:["USA"],states:["MA","NH","VT","NY"],days:[{dayNumber:1,label:"Arrive Boston",location:"Boston, MA",type:"arrival",suggestedActivities:["landmark-freedom-trail"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:2,label:"White Mountains",location:"Boston â†’ North Conway, NH",type:"drive",driveTime:"2.5 hours",notes:"Peak foliage at elevation! The Kancamagus is THE place.",suggestedActivities:["drive-kancamagus","foliage-hancock-overlook","hike-sabbaday-falls","landmark-albany-covered-bridge"],flexible:!0},{dayNumber:3,label:"Vermont Colors",location:"North Conway â†’ Chelsea, VT",type:"drive",driveTime:"2 hours",suggestedActivities:["hike-sallys-property","foliage-chelsea-vermont","drive-route-100"],lodging:"lodge-sallys",flexible:!0},{dayNumber:4,label:"Vermont Exploration",location:"Chelsea, VT",type:"explore",suggestedActivities:["hike-sallys-property","food-cold-hollow","food-ben-jerrys"],lodging:"lodge-sallys",flexible:!0},{dayNumber:5,label:"Adirondacks Peak",location:"Chelsea â†’ Lake Placid, NY",type:"drive",driveTime:"2.5 hours",notes:"Adirondacks peak earlyâ€”huge foliage payoff!",suggestedActivities:["foliage-lake-placid","drive-whiteface"],lodging:"lodge-mirror-lake-inn",flexible:!0},{dayNumber:6,label:"Saratoga & Departure",location:"Lake Placid â†’ Saratoga â†’ Albany",type:"drive",driveTime:"2 hours",suggestedActivities:[],flexible:!0}],alternatives:[]},{id:"city-culture",name:"Cities & Culture Route",emoji:"ðŸ™ï¸",source:"research",description:"Focus on Boston and Montreal with light scenic driving in between.",duration:"6-7 days",totalMiles:"~500 miles",driveTime:"~9 hours total",flyIn:"Boston (BOS)",flyOut:"Montreal (YUL)",vibe:"Urban exploration with countryside breaks",bestFor:["City lovers","Food & culture","Less hiking"],countries:["USA","Canada"],states:["MA","ME","VT","QC"],days:[{dayNumber:1,label:"Arrive Boston",location:"Boston, MA",type:"arrival",suggestedActivities:["lobster-neptune"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:2,label:"Boston Deep Dive",location:"Boston, MA",type:"explore",suggestedActivities:["landmark-freedom-trail"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:3,label:"Portland Day Trip",location:"Boston â†’ Portland â†’ Boston or Burlington",type:"drive",driveTime:"2 hours each way",suggestedActivities:["town-portland-old-port","lobster-eventide","food-duckfat"],flexible:!0},{dayNumber:4,label:"Vermont Crossing",location:"Boston â†’ Burlington, VT",type:"drive",driveTime:"3.5 hours",suggestedActivities:["food-cold-hollow"],flexible:!0},{dayNumber:5,label:"Montreal Arrival",location:"Burlington â†’ Montreal, QC",type:"drive",driveTime:"1.5 hours",suggestedActivities:["landmark-notre-dame"],lodging:"lodge-petit-montreal",flexible:!0},{dayNumber:6,label:"Montreal Full Day",location:"Montreal, QC",type:"explore",suggestedActivities:["food-st-viateur","food-schwartzs","hike-mount-royal","food-la-banquise"],lodging:"lodge-petit-montreal",flexible:!0},{dayNumber:7,label:"Departure",location:"Montreal, QC",type:"departure",notes:"Fly home from Montreal.",suggestedActivities:[],flexible:!0}],alternatives:[]},{id:"blank-canvas",name:"Start From Scratch",emoji:"âœ¨",source:"custom",description:"Build your own adventure! Start with a blank slate and add whatever you want.",duration:"You decide",totalMiles:"TBD",driveTime:"TBD",flyIn:"Your choice",flyOut:"Your choice",vibe:"Complete freedom",bestFor:["Control enthusiasts","Unique trips","Customizers"],countries:[],states:[],days:[{dayNumber:1,label:"Day 1",location:"",type:"custom",suggestedActivities:[],flexible:!0},{dayNumber:2,label:"Day 2",location:"",type:"custom",suggestedActivities:[],flexible:!0},{dayNumber:3,label:"Day 3",location:"",type:"custom",suggestedActivities:[],flexible:!0}],alternatives:[]}];function ya(t){return ht.find(a=>a.id===t)}function xa(t){try{const a=localStorage.getItem(t);if(a)return a;const s=globalThis.crypto?.randomUUID?.()||`client-${Date.now()}-${Math.random().toString(16).slice(2)}`;return localStorage.setItem(t,s),s}catch{return`client-${Date.now()}-${Math.random().toString(16).slice(2)}`}}function va(t){try{const a=localStorage.getItem(t);if(!a)return null;const s=JSON.parse(a);if(Le(s))return s;localStorage.removeItem(t)}catch{}return null}function Ke(t,a){try{localStorage.setItem(t,JSON.stringify(a))}catch{}}function Na(t){try{const a=localStorage.getItem(t);return a?JSON.parse(a):{}}catch{return{}}}function Ge(t,a){try{localStorage.setItem(t,JSON.stringify(a))}catch{}}function ja(t){try{const a=localStorage.getItem(t);return a?JSON.parse(a):[]}catch{return[]}}function wa(t,a){try{localStorage.setItem(t,JSON.stringify(a))}catch{}}function ka(t,{name:a,emoji:s="+",source:l="custom"}={}){const m=a||t.name||"Custom Trip";return{id:`custom-${Date.now()}`,name:m,emoji:s,source:l,description:`Saved from ${new Date().toLocaleDateString()}`,duration:`${t.days.length} days`,totalMiles:"TBD",driveTime:"TBD",flyIn:"",flyOut:"",vibe:"Personalized plan",bestFor:["Custom"],countries:[],states:[],days:t.days.map(u=>({dayNumber:u.dayNumber,label:u.label,location:u.location,type:u.type,notes:u.notes,suggestedActivities:u.activities,lodging:u.lodging||null,flexible:!0})),alternatives:[]}}function Ma(t,a){const s=Array.isArray(a)?a:[];return[...t,...s]}const Be="mmt-2025-trip",Ee="mmt-custom-activities",ze="mmt-custom-templates",Sa="mmt-2025-client-id",fe="mmt-2025-maine";function Ca(){const[t,a]=i.useState(!0),[s,l]=i.useState(null);i.useEffect(()=>{Lt().then(({data:c})=>{const g=c?.session;g?.user&&ye(g.user.email)?l(g.user):l(null),a(!1)});const{data:{subscription:u}}=Dt((c,g)=>{g?.user&&ye(g.user.email)?l(g.user):l(null)});return()=>u?.unsubscribe?.()},[]);const m=async()=>{await Rt(),l(null)};return t?e.jsx("div",{className:"login-screen",children:e.jsxs("div",{className:"login-card",style:{textAlign:"center"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:"ðŸ¦ž"}),e.jsx("p",{children:"Loading..."})]})}):s?e.jsx(Aa,{user:s,onSignOut:m}):e.jsx(Pt,{})}function Aa({user:t,onSignOut:a}){const s=i.useMemo(()=>va(Be),[]),[l,m]=i.useState(()=>s?"builder":"moms"),[u,c]=i.useState(()=>Na(Ee)),[g,p]=i.useState(()=>ja(ze)),[n,f]=i.useState(be?"syncing":"offline"),N=i.useMemo(()=>Ma(ht,g),[g]),[v,S]=i.useState(()=>{if(s)return s;const B=ya("moms-original");return We(B)||Gt({dayCount:7,name:"My New England Trip"})}),k=i.useMemo(()=>zt(v.days),[v.days]),M=i.useMemo(()=>{const B=R.stops.reduce((w,T)=>w+T.activities.length,0);return{days:R.stops.length,activities:B}},[]),b=l==="moms"?M:k,y=i.useMemo(()=>xa(Sa),[]),[j,E]=i.useState(!1),D=i.useRef(v),I=i.useRef(u);i.useEffect(()=>{j||(D.current=v,I.current=u)},[v,u,j]),i.useEffect(()=>{wa(ze,g)},[g]),i.useEffect(()=>{if(!be)return;let B=!1,w=null;async function T(){const{data:W,error:C}=await It(fe);if(B)return;if(C){console.warn("Supabase fetch shared trip failed:",C),E(!0);return}const L=W?.state?.trip,F=W?.state?.customActivities;Le(L)&&L.days.length&&S(L),F&&typeof F=="object"&&c(ee=>({...ee,...F})),W?.state?.initialized||await Fe({initialized:!0,trip:D.current,customActivities:I.current,updatedBy:y,updatedAt:Date.now()},fe),w=Ot(fe,ee=>{const q=ee?.new?.state;if(!q||q?.updatedBy&&q.updatedBy===y)return;const Q=q?.trip;Le(Q)&&Q.days.length&&(S(Q),Ke(Be,Q));const J=q?.customActivities;J&&typeof J=="object"&&(c(J),Ge(Ee,J))}),E(!0),f("synced")}return T(),()=>{B=!0,w?.unsubscribe?.()}},[y]),i.useEffect(()=>{if(Ke(Be,v),Ge(Ee,u),!be||!j)return;f("syncing");const B=setTimeout(()=>{Fe({initialized:!0,trip:v,customActivities:u,updatedBy:y,updatedAt:Date.now()},fe).then(()=>{f("synced")}).catch(w=>{console.warn("Supabase upsert shared trip failed:",w),f("offline")})},600);return()=>clearTimeout(B)},[v,u,j,y]);const $=B=>{const w=N.find(T=>T.id===B);w&&S(We(w))},V=()=>{const B=window.prompt("Name this template",v.name||"Custom Trip");if(!B)return;const w=ka(v,{name:B});p(T=>[...T,w])},H=()=>{$("moms-original"),m("builder")};return e.jsxs("div",{className:"app",children:[e.jsx(At,{activeView:l,onViewChange:m,tripStats:b,templates:N,selectedTemplateId:v.templateId,onLoadTemplate:B=>{$(B),m("builder")},onSaveTemplate:V,syncStatus:n,user:t,onSignOut:a}),e.jsx("main",{className:"main",children:l==="moms"?e.jsx(Wt,{onCopyToBuilder:H}):e.jsx(ba,{trip:v,setTrip:S,customActivities:u,setCustomActivities:c})}),e.jsx("footer",{className:"footer",children:e.jsx("p",{children:"Created with love and a lot of lobster. Build the trip that feels right."})})]})}try{const t=document.getElementById("root");if(!t)throw new Error("Root element not found");Mt.createRoot(t).render(e.jsx(i.StrictMode,{children:e.jsx(Ca,{})}))}catch(t){console.error("Failed to mount React app:",t),document.body.innerHTML+=`<div style="color: red; padding: 20px;">Mount Error: ${t.message}</div>`}
