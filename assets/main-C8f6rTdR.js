import{j as e,r}from"./react-TFhZ49XI.js";import{c as vt}from"./react-dom-DWW9Ss7k.js";import{L as Ke}from"./leaflet-DtPDPQxn.js";import{M as ze,T as Ge,P as Qe,a as Je,b as Xe,u as Ze}from"./react-leaflet-Bqf2NtBK.js";import{D as et,c as tt,a as at,u as Nt,S as ot,v as st,b as nt,C as it}from"./dnd-kit-LkpYPBBg.js";import{c as wt}from"./supabase-DFbZBYVg.js";import"./vendor-CNU2YX_S.js";delete Ke.Icon.Default.prototype._getIconUrl;Ke.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});function jt({activeView:t,onViewChange:a,tripStats:o,templates:l,selectedTemplateId:p,onLoadTemplate:h,onSaveTemplate:d,syncStatus:y}){return e.jsxs("header",{className:"header",children:[e.jsxs("div",{className:"header-brand",children:[e.jsxs("div",{className:"brand-title",children:[e.jsx("h1",{children:"MMT 2025"}),e.jsx("span",{className:"tagline",children:"Girls Trip to New England"}),y&&e.jsxs("span",{className:`sync-badge ${y}`,title:y==="synced"?"All changes saved to cloud":y==="syncing"?"Syncing changes...":y==="offline"?"Working offline":"",children:[y==="synced"&&"â˜ï¸ Synced",y==="syncing"&&"â³ Syncing...",y==="offline"&&"ðŸ“´ Offline"]})]}),e.jsx("p",{className:"brand-subtitle",children:"Plan, remix, and build the trip that feels perfect."})]}),e.jsxs("div",{className:"header-nav",children:[e.jsx("button",{type:"button",className:`nav-btn ${t==="moms"?"active":""}`,onClick:()=>a("moms"),children:"Mom's Route"}),e.jsx("button",{type:"button",className:`nav-btn ${t==="builder"?"active":""}`,onClick:()=>a("builder"),children:"Build & Customize"})]}),e.jsx("div",{className:"header-actions",children:t==="builder"&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"template-select",value:p||"",onChange:u=>u.target.value&&h(u.target.value),children:[e.jsx("option",{value:"",children:"Load a template..."}),l.map(u=>e.jsxs("option",{value:u.id,children:[u.emoji," ",u.name]},u.id))]}),e.jsx("button",{type:"button",className:"btn-primary",onClick:d,children:"Save as Template"})]})}),e.jsxs("div",{className:"header-stats",children:[e.jsxs("span",{className:"stat-chip",children:[o.days," days"]}),e.jsxs("span",{className:"stat-chip",children:[o.activities," activities"]})]})]})}const B={title:"Girls Trip to New England",subtitle:"Suggested drive-first adventure with tons of flexibility",themeLine:"Lobsters - Leaves - Love",travelWindow:"Late September to October 2025",overview:{duration:"7-9 days",totalMiles:"~780 miles",driveTime:"~16 hours total",flyIn:"Boston (BOS)",flyOut:"Albany (ALB) or Boston (BOS)"},warnings:[{title:"Leaf-peeping surge",detail:"Late September weekends bring heavy traffic across New England."},{title:"This is a suggested route",detail:"Stop, hike, or swap days as you want. Nothing is locked in."},{title:"Flex days baked in",detail:"If a place feels too rushed, add a night and slide the rest."}],ribbonStops:[{id:"boston",name:"Boston",nights:"1-2",drive:"Arrive",emoji:"ðŸ™ï¸"},{id:"portland",name:"Portland",nights:"1",drive:"2 hrs",emoji:"ðŸ¦ž"},{id:"chelsea",name:"Chelsea",nights:"1-2",drive:"3.5 hrs",emoji:"ðŸ"},{id:"montreal",name:"Montreal",nights:"2",drive:"2.5 hrs",emoji:"ðŸ¥¯"},{id:"saratoga",name:"Saratoga",nights:"1",drive:"4 hrs",emoji:"ðŸ”ï¸"},{id:"albany",name:"Albany",nights:"Fly out",drive:"1.5 hrs",emoji:"âœˆï¸"}],featuredMoments:[{title:"First lobster in Boston",detail:"Lean into history, walkable neighborhoods, and the first iconic roll.",stopId:"boston"},{title:"Sally's Vermont retreat",detail:"Stay on the property, walk the land, and slow the pace for a day.",stopId:"chelsea"},{title:"International detour",detail:"Montreal for bagels, smoked meat, and a full city reset.",stopId:"montreal"}],stops:[{id:"boston",title:"Boston, MA",dayRange:"Days 1-2",nights:"1-2 nights",driveTime:"Arrival base",notes:"Use the arrival day and perhaps the next day for touring the city and eating some lobster.",momQuote:"The city is full of history, of course.",location:"Boston, MA",activities:["landmark-freedom-trail","lobster-neptune"],lodging:"lodge-godfrey-boston",highlights:["Walkable neighborhoods","Freedom Trail","Classic seafood"]},{id:"portland",title:"Coastal drive to Portland, ME",dayRange:"Day 3",nights:"1 night",driveTime:"About 2 hours",notes:"Drive up the coast to Portland and stay one night. Route 1 is the slow and scenic option.",momQuote:"Hit the harbor towns along the way.",location:"Portland, ME",activities:["drive-route-1-coast","town-ogunquit","town-kennebunkport","lobster-clam-shack","lobster-chauncey","town-portland-old-port"],lodging:"lodge-press-portland",highlights:["Harbor towns","Coastal lobster shacks","Old Port stroll"]},{id:"chelsea",title:"Chelsea, VT via Concord, NH",dayRange:"Days 4-5",nights:"1-2 nights",driveTime:"About 3.5 hours",notes:"Stay a night at Sally's in Chelsea. Concord can just be a stopping place on the way.",momQuote:"We can do some serious walking or hiking right on the property.",location:"Chelsea, VT",activities:["drive-kancamagus","hike-sabbaday-falls","foliage-hancock-overlook","landmark-albany-covered-bridge","hike-sallys-property","foliage-chelsea-vermont"],lodging:"lodge-sallys",highlights:["Kancamagus Highway","Property hikes","Vermont foliage"]},{id:"montreal",title:"Montreal, QC via Burlington, VT",dayRange:"Days 6-7",nights:"2 nights",driveTime:"About 2.5 hours",notes:"Burlington is a nice stopping place on the way up. Montreal is the main city adventure.",momQuote:"Explore Montreal. Bagels, smoked meat, Mount Royal, poutine.",location:"Montreal, QC",activities:["food-cold-hollow","food-ben-jerrys","landmark-notre-dame","food-st-viateur","food-schwartzs","hike-mount-royal","food-la-banquise"],lodging:"lodge-petit-montreal",highlights:["Old Montreal","Bagel crawl","Mount Royal views"]},{id:"saratoga",title:"Adirondacks to Saratoga Springs, NY",dayRange:"Day 8",nights:"1 night",driveTime:"About 4 hours",notes:"Drive via Lake Placid if you want the detour before Saratoga Springs.",momQuote:"This is the optional continuation before heading to Albany.",location:"Saratoga Springs, NY",activities:["foliage-lake-placid","drive-whiteface"],lodging:"lodge-adelphi-saratoga",highlights:["Lake Placid detour","Adirondack peaks","Historic downtown"]},{id:"albany",title:"Albany, NY departure",dayRange:"Day 9",nights:"Fly out",driveTime:"About 1.5 hours",notes:"Fly home from Albany or keep driving toward Stockbridge/Boston.",momQuote:"We can stop and fly home from Albany.",location:"Albany, NY",activities:[],lodging:null,highlights:["Easy fly-out","Gateway to Berkshires"]}],foliage:{peakWindows:["Late September in high elevations","Early to mid October in Vermont","Mid October in coastal Maine"],bestDrives:["Kancamagus Highway","Route 100 in Vermont","Coastal Route 1"]},budget:{tiers:[{name:"Budget",range:"$175-250 per day",detail:"Mix of casual meals, free hikes, and simple lodging."},{name:"Comfort",range:"$275-375 per day",detail:"Better lodging plus a few splurge meals."},{name:"Treat-Yourself",range:"$400+ per day",detail:"Boutique hotels, tours, and big food moments."}],tips:["Book lodging early for foliage season.","Save splurges for Boston and Montreal.","Pack snacks for scenic drives."]},packing:{weatherNote:"Expect crisp mornings, warm afternoons, and surprise rain. Layers win.",essentials:["Comfortable walking shoes","Light rain jacket","Daypack","Portable charger","Refillable water bottle"],extras:["Camera or good phone lens","Cozy sweater","Binoculars for foliage","Picnic blanket","Reusable tote"]},alternatives:[{title:"Berkshires finish",detail:"Continue to Stockbridge, MA for Ice Glen and Laura's Tower hikes before Boston.",addsDays:1,flyOut:"Boston (BOS)",activities:["hike-ice-glen"]},{title:"Finger Lakes extension",detail:"Explore the Finger Lakes region with wineries and waterfalls.",addsDays:2,flyOut:"Albany (ALB)",activities:[]},{title:"Massachusetts detour",detail:"Spend extra days in western Massachusetts and fly out of Boston.",addsDays:1,flyOut:"Boston (BOS)",activities:[]},{title:"Southern dip",detail:"Dip into Connecticut or Rhode Island if you want more coastal time.",addsDays:1,flyOut:"Providence (PVD) or Boston (BOS)",activities:[]}],wildcards:["Alternate trips could be Carolinas, Virginia, Tennessee, or Kentucky.","Another idea: Southern Illinois, Kentucky, Missouri loop.","Or switch coasts and do a west coast northern route."]},G={lobster:{id:"lobster",name:"Lobster Spots",icon:"ðŸ¦ž",color:"#c4a8f0",description:"The best lobster rolls and seafood shacks"},town:{id:"town",name:"Harbor Towns",icon:"âš“",color:"#b89de8",description:"Charming coastal villages to explore"},hike:{id:"hike",name:"Hikes & Nature",icon:"ðŸ¥¾",color:"#ad92e0",description:"Trails, waterfalls, and outdoor adventures"},drive:{id:"drive",name:"Scenic Drives",icon:"ðŸš—",color:"#a387d8",description:"Beautiful routes through mountains and coast"},foliage:{id:"foliage",name:"Foliage Spots",icon:"ðŸ",color:"#b094e0",description:"Best fall color viewing locations"},city:{id:"city",name:"Cities",icon:"ðŸ™ï¸",color:"#a68ad8",description:"Major city destinations"},food:{id:"food",name:"Food & Dining",icon:"ðŸ½ï¸",color:"#bda0e8",description:"Restaurants, cafes, and food experiences"},landmark:{id:"landmark",name:"Landmarks",icon:"ðŸ“¸",color:"#b496e0",description:"Must-see attractions and photo spots"},lodging:{id:"lodging",name:"Lodging",icon:"ðŸ¨",color:"#b89ae0",description:"Hotels, B&Bs, and places to stay"},custom:{id:"custom",name:"Custom",icon:"â­",color:"#c8b0f0",description:"Places you add yourself"}},kt={boston:{id:"boston",name:"Boston Area",state:"MA"},maine_coast:{id:"maine_coast",name:"Maine Coast",state:"ME"},portland:{id:"portland",name:"Portland Area",state:"ME"},white_mountains:{id:"white_mountains",name:"White Mountains",state:"NH"},vermont:{id:"vermont",name:"Vermont",state:"VT"},montreal:{id:"montreal",name:"Montreal",state:"QC"},adirondacks:{id:"adirondacks",name:"Adirondacks",state:"NY"},saratoga:{id:"saratoga",name:"Saratoga/Albany",state:"NY"},berkshires:{id:"berkshires",name:"Berkshires",state:"MA"}},rt=[{id:"lobster-eventide",category:"lobster",name:"Eventide Oyster Co.",region:"portland",location:"Portland, ME",address:"86 Middle St, Portland, ME 04101",coordinates:[43.6573,-70.2515],phone:"(207) 774-8538",website:"https://www.eventideoysterco.com",hours:"11amâ€“10pm daily",reservations:"No reservations",duration:1.5,price:"$$$",priceRange:"$25-45/person",rating:4.9,yelpRating:4.5,googleRating:4.7,reviewCount:2800,description:"James Beard Award winner with the famous brown butter lobster roll on a steamed bao-style bun.",mustTry:"Brown Butter Lobster Roll",tip:"Go at 3pm between lunch and dinner rush. No reservations.",waitTime:"30-60 min",bestTime:"3pm weekdays",parking:"Street parking, metered",tags:["james-beard","innovative","must-visit"],momMentioned:!1,source:"research"},{id:"lobster-neptune",category:"lobster",name:"Neptune Oyster",region:"boston",location:"Boston, MA",address:"63 Salem St, Boston, MA 02113",coordinates:[42.3631,-71.0546],phone:"(617) 742-3474",website:"https://www.neptuneoyster.com",hours:"11:30amâ€“9:30pm Sun-Thu, 11:30amâ€“10:30pm Fri-Sat",reservations:"No reservations",duration:1.5,price:"$$$",priceRange:"$30-50/person",rating:4.8,yelpRating:4.5,googleRating:4.6,reviewCount:4200,description:"The iconic Boston lobster roll. Overflowing with a quarter-pound of lobster meat.",mustTry:"Hot Buttered Lobster Roll",tip:"Arrive 20 min before opening (11:30am). Worth every minute of the wait.",waitTime:"45-90 min",bestTime:"11am weekdays (line up before open)",parking:"Paid garages nearby, no street parking",tags:["iconic","boston-legend","worth-the-wait"],momMentioned:!0,source:"mmtrip"},{id:"lobster-clam-shack",category:"lobster",name:"The Clam Shack",region:"maine_coast",location:"Kennebunkport, ME",address:"2 Western Ave, Kennebunk, ME 04043",coordinates:[43.3615,-70.4768],phone:"(207) 967-3321",website:"https://www.theclamshack.net",hours:"11amâ€“8pm (seasonal, May-Oct)",reservations:"Walk-up only",duration:1,price:"$$",priceRange:"$18-30/person",rating:4.7,yelpRating:4,googleRating:4.5,reviewCount:1900,description:"Served on a unique toasted hamburger bun instead of hot dog bun.",mustTry:"Lobster Roll + Fried Clams",tip:"Cash only! Get clam strips too.",waitTime:"15-30 min",bestTime:"Early afternoon",parking:"Free lot nearby",paymentNote:"ðŸ’µ Cash only",tags:["cash-only","unique-style","harbor-views"],momMentioned:!1,source:"research"},{id:"lobster-chauncey",category:"lobster",name:"Chauncey Creek Lobster Pier",region:"maine_coast",location:"Kittery Point, ME",address:"16 Chauncey Creek Rd, Kittery Point, ME 03905",coordinates:[43.0891,-70.6789],phone:"(207) 439-1030",website:"https://www.chaunceycreek.com",hours:"11amâ€“8pm (seasonal, May-Labor Day)",reservations:"First come, first served",duration:2,price:"$$",priceRange:"$25-40/person",rating:4.8,yelpRating:4.5,googleRating:4.7,reviewCount:1200,description:"The quintessential Maine experience. BYOBâ€”bring tablecloth, wine, and make it fancy on a picnic table over the water.",mustTry:"1.5 lb whole lobster + steamers",tip:"Stop at a Kittery wine shop first. Bring candles and wine glasses!",waitTime:"10-20 min",bestTime:"5pm for sunset",parking:"Free gravel lot",paymentNote:"ðŸ· BYOB welcome",tags:["byob","waterfront","romantic"],momMentioned:!1,source:"research"},{id:"lobster-bite-into",category:"lobster",name:"Bite Into Maine",region:"portland",location:"Cape Elizabeth, ME",address:"1000 Shore Rd, Cape Elizabeth, ME 04107 (at Portland Head Light)",coordinates:[43.6231,-70.208],phone:"(207) 420-0727",website:"https://www.biteintomaine.com",hours:"11amâ€“5pm (seasonal)",reservations:"Walk-up food truck",duration:1,price:"$$",priceRange:"$18-28/person",rating:4.7,yelpRating:4.5,googleRating:4.6,reviewCount:850,description:"Food truck at Portland Head Light! Get lobster AND lighthouse photos.",mustTry:"Flight of 3 mini rolls (try all styles!)",tip:"They offer wasabi, curry, and chipotle versions too.",waitTime:"10-15 min",bestTime:"Late afternoon for golden hour photos",parking:"$5 park entrance fee",tags:["food-truck","lighthouse-views","flight-available"],momMentioned:!1,source:"research"},{id:"lobster-reds",category:"lobster",name:"Red's Eats",region:"maine_coast",location:"Wiscasset, ME",address:"41 Water St, Wiscasset, ME 04578",coordinates:[44.0028,-69.6656],phone:"(207) 882-6128",website:"https://www.redseatsmaine.com",hours:"11:30amâ€“8pm (seasonal, Apr-Oct)",reservations:"Walk-up only",duration:1.5,price:"$$$",priceRange:"$30-45/person",rating:4.6,yelpRating:4,googleRating:4.4,reviewCount:3100,description:"The most photographed lobster roll in America. A full POUND of meat tumbling off the bun.",mustTry:"The famous overflowing lobster roll",tip:"Only worth it if driving by anyway. The line is legendary.",waitTime:"60-120 min",bestTime:"Early morning or late afternoon",parking:"Street parking, fills fast",tags:["famous","massive-portions","long-lines"],momMentioned:!1,source:"research"},{id:"lobster-mcloons",category:"lobster",name:"McLoons Lobster Shack",region:"maine_coast",location:"South Thomaston, ME",address:"315 Island Rd, South Thomaston, ME 04858",coordinates:[44.0539,-69.1347],phone:"(207) 593-1382",website:"https://www.mcloonslobster.com",hours:"11amâ€“7pm (seasonal, May-Oct)",reservations:"First come, first served",duration:1.5,price:"$$",priceRange:"$20-35/person",rating:4.9,yelpRating:4.5,googleRating:4.8,reviewCount:680,description:"Working lobster wharf, no tourists. The Maine postcard dream.",mustTry:"Lobster Roll + whoopie pie for dessert",tip:"1.5 hours north of Portland but the setting is UNREAL.",waitTime:"5-15 min",bestTime:"Lunch for best selection",parking:"Free lot",tags:["hidden-gem","authentic","working-wharf"],momMentioned:!1,source:"research"},{id:"lobster-highroller",category:"lobster",name:"Highroller Lobster Co.",region:"portland",location:"Portland, ME",address:"104 Exchange St, Portland, ME 04101",coordinates:[43.6557,-70.2547],phone:"(207) 536-1623",website:"https://www.highrollerlobster.com",hours:"11amâ€“8pm daily",reservations:"Walk-in",duration:1,price:"$$",priceRange:"$18-30/person",rating:4.6,yelpRating:4,googleRating:4.5,reviewCount:1100,description:"Young, hip, creative. Thai chili roll and Korean BBQ roll push boundaries.",mustTry:"Lobster roll + Lobster Mac & Cheese",tip:'They have a fantastic spicy "Picnic" roll with pickled jalapeÃ±os.',waitTime:"10-20 min",tags:["creative-flavors","casual-vibe","affordable"],momMentioned:!1,source:"research"},{id:"town-ogunquit",category:"town",name:"Perkins Cove, Ogunquit",region:"maine_coast",location:"Ogunquit, ME",address:"Perkins Cove Road, Ogunquit, ME 03907",coordinates:[43.2364,-70.5903],website:"https://www.ogunquit.org",hours:"Dawn to dusk (outdoor)",duration:2.5,price:"Free",rating:4.8,googleRating:4.7,reviewCount:2400,description:"Artist colony charm. Bohemian-meets-preppy with 50+ galleries in tiny area.",highlights:["Walk the Marginal Way (1.25 mi paved cliff walk)","Watch the manual drawbridge open for boats","Browse the art galleries","Sunset drinks at Barnacle Billy's"],tip:"Arrive before 10am or park at Obed's Lot and walk/trolley",bestTime:"Early morning or sunset",parking:"Perkins Cove lot $10/day or Obed's Lot + trolley",photoSpot:"Marginal Way overlook at sunrise",tags:["walkable","artists","cliff-walk"],momMentioned:!0,source:"mmtrip"},{id:"town-kennebunkport",category:"town",name:"Kennebunkport",region:"maine_coast",location:"Kennebunkport, ME",address:"Dock Square, Kennebunkport, ME 04046",coordinates:[43.3615,-70.4768],website:"https://www.visitkennebunkport.com",hours:"Shops typically 10amâ€“6pm",duration:2,price:"Free",rating:4.7,googleRating:4.6,reviewCount:1800,description:"Preppy & Presidential. Old money New England charm.",highlights:["Walk Dock Square (boutique shopping)","Drive by Bush Estate at Walker's Point","Explore Cape Porpoise (quieter, more local)","Ice cream at Rococo"],tip:"Use the municipal lot off Maine St, $2/hr",bestTime:"Mid-morning weekdays",parking:"Municipal lot $2/hr, free after 5pm",photoSpot:"Colony Hotel from across the river",tags:["preppy","boutiques","presidential"],momMentioned:!0,source:"mmtrip"},{id:"town-portland-old-port",category:"town",name:"Portland Old Port",region:"portland",location:"Portland, ME",address:"Commercial St & Exchange St, Portland, ME 04101",coordinates:[43.6591,-70.2568],website:"https://www.visitportland.com",hours:"Shops 10amâ€“6pm, restaurants until late",duration:3,price:"Free",rating:4.9,googleRating:4.8,reviewCount:5200,description:"Brooklyn-by-the-sea. Tattooed chefs and fishermen sharing the sidewalk.",highlights:["Get lost in the cobblestone streets","Browse indie shops on Exchange St","Taste wine at Vena's Fizz House","Watch fishing boats at the wharf"],tip:"Street parking tricky; use Ocean Gateway garage",bestTime:"Late afternoon â†’ dinner",parking:"Ocean Gateway garage $3/hr, street meters $2.50/hr",photoSpot:"Congress Street mural walk",tags:["foodie","cobblestone","hip"],momMentioned:!0,source:"mmtrip"},{id:"town-portsmouth",category:"town",name:"Portsmouth",region:"maine_coast",location:"Portsmouth, NH",address:"Market Square, Portsmouth, NH 03801",coordinates:[43.0718,-70.7626],website:"https://www.portsmouthnh.com",hours:"Shops 10amâ€“6pm, restaurants until late",duration:2,price:"Free",rating:4.6,googleRating:4.5,reviewCount:1400,description:"The artsy younger sibling of Boston. Historic & Hip.",highlights:["Walk Market Square","Coffee at Breaking New Grounds","Strawbery Banke Museum (if time allows)","Cross to Kittery, ME for outlets"],tip:"Hanover St garage, easy parking",bestTime:"Weekend mornings for brunch",parking:"Hanover St garage $1.50/hr",photoSpot:"Prescott Park waterfront",tags:["artsy","historic","coffee"],momMentioned:!0,source:"mmtrip"},{id:"town-camden",category:"town",name:"Camden",region:"maine_coast",location:"Camden, ME",address:"Main Street, Camden, ME 04843",coordinates:[44.2098,-69.0648],website:"https://www.camdenme.org",hours:"Shops 10amâ€“5pm, park dawn to dusk",duration:3,price:"Free (Mt. Battie entrance $6/car)",rating:4.8,googleRating:4.7,reviewCount:980,description:"Where mountains meet the sea. Genuinely magical.",highlights:["Climb Mt. Battie (drive or hike for epic views)","Stroll the harbor and watch schooners","Browse the bookstores","Catch the Camden Hills at peak foliage"],tip:"Metered on main streets, free lots nearby",photoSpot:"Mt. Battie tower overlooking harbor + fall colors",tags:["mountains","harbor","schooners"],momMentioned:!1,source:"research"},{id:"town-boothbay-harbor",category:"town",name:"Boothbay Harbor",region:"maine_coast",location:"Boothbay Harbor, ME",coordinates:[43.8516523,-69.6280608],duration:2.5,rating:4.7,description:"Classic coastal village energy: boats, lobster shacks, and an easy strollable harbor.",highlights:["Walk the waterfront and browse shops","Harbor cruise / boat watching","Grab lobster by the docks","Quick photo stops at the marinas"],tip:"Arrive earlier in the day to find parking near the waterfront.",photoSpot:"Harbor overlook near the footbridge",tags:["harbor","walkable","coastal"],momMentioned:!1,source:"research"},{id:"town-bar-harbor",category:"town",name:"Bar Harbor",region:"maine_coast",location:"Bar Harbor, ME",coordinates:[44.3876378,-68.2043361],duration:4,rating:4.8,description:"Gateway town for Acadiaâ€”busy, beautiful, and worth it for the scenery.",highlights:["Stroll the downtown shops + waterfront","Sunrise/sunset viewpoints nearby","Acadia access points close by","Seafood with harbor views"],tip:"Traffic/parking can be intense in peak seasonâ€”use lots and walk.",photoSpot:"Waterfront near the town pier",tags:["acadia","scenic","popular"],momMentioned:!1,source:"research"},{id:"town-winter-harbor",category:"town",name:"Winter Harbor",region:"maine_coast",location:"Winter Harbor, ME",coordinates:[44.3948755,-68.0841096],duration:2,rating:4.6,description:"Quieter coastal base near Acadia (Schoodic Peninsula) with a laid-back harbor vibe.",highlights:["Schoodic Peninsula access (Acadia)","Harbor strolls + small-town calm","Easy jumping-off point for scenic drives","Less crowded than Bar Harbor"],tip:"Great option if you want Acadia scenery without the Bar Harbor crowds.",photoSpot:"Schoodic Point viewpoints nearby",tags:["quiet","acadia","coastal"],momMentioned:!1,source:"research"},{id:"town-deer-isle",category:"town",name:"Deer Isle",region:"maine_coast",location:"Deer Isle, ME",coordinates:[44.224044,-68.677597],duration:2.5,rating:4.7,description:"Remote-feeling island community with working-harbor character and coastal views.",highlights:["Drive across the bridge and explore","Artisan shops / galleries (seasonal)","Coastal pull-offs and quiet roads","Lobster boats and working docks"],tip:"Best as a slow half-dayâ€”pair with another nearby coastal stop.",photoSpot:"Bridge and shoreline lookouts",tags:["island","quiet","scenic"],momMentioned:!1,source:"research"},{id:"town-lubec",category:"town",name:"Lubec",region:"maine_coast",location:"Lubec, ME",coordinates:[44.861172,-66.983501],duration:3,rating:4.6,description:"Far-east Maine coastal townâ€”feels like the edge of the map, in the best way.",highlights:["Coastal views and quiet streets","Easy to pair with nearby scenic points","Unique â€œend of Maineâ€ vibe"],tip:"Itâ€™s a haulâ€”treat it like a destination day rather than a quick detour.",photoSpot:"Waterfront viewpoints",tags:["remote","coastal","scenic"],momMentioned:!1,source:"research"},{id:"city-boston",category:"city",name:"Boston",region:"boston",location:"Boston, MA",coordinates:[42.3601,-71.0589],duration:8,rating:4.8,description:"Begin here! Full of history, and LOBSTA!",highlights:["Walk the Freedom Trail (2.5 mi, 16 historic sites)","Faneuil Hall & Quincy Market","North End (Little Italy) - cannoli!","Boston Common & Public Garden"],tip:"Skip hotel parking ($50/night). Use MBTA subway.",momQuote:"Use the arrival day and perhaps next day for touring the city and eating some LOBSTA!",suggestedNights:"1-2",tags:["history","starting-point","walkable"],momMentioned:!0,source:"mmtrip"},{id:"city-portland-me",category:"city",name:"Portland, ME",region:"portland",location:"Portland, ME",coordinates:[43.6591,-70.2568],duration:6,rating:4.9,description:"More restaurants per capita than San Francisco! Foodie paradise.",highlights:["Portland Head Light (most photographed lighthouse)","Old Port cobblestone streets","Eventide or Highroller for lobster","Duckfat for fries and poutine"],tip:"Stay 1 night. Old Port is walkable.",momQuote:"Drive up the coast to Portland (2 hrs)â€”stay 1 night",suggestedNights:"1",tags:["foodie","coastal","lighthouse"],momMentioned:!0,source:"mmtrip"},{id:"city-montreal",category:"city",name:"Montreal",region:"montreal",location:"Montreal, QC, Canada",coordinates:[45.5017,-73.5673],duration:12,rating:4.8,description:"Second-largest French-speaking city after Paris. BYOB restaurants + incredible food.",highlights:["Bagel duel: St-Viateur vs. Fairmount","Schwartz's smoked meat sandwich","Hike Mount Royal","Notre-Dame Basilica + Aura light show","La Banquise poutine (late night!)"],tip:"Expect 10Â°F temp drop vs. Boston. Pack a jacket!",momQuote:"Explore Montreal",suggestedNights:"2",tags:["international","foodie","culture","byob"],momMentioned:!0,source:"mmtrip"},{id:"city-burlington",category:"city",name:"Burlington",region:"vermont",location:"Burlington, VT",coordinates:[44.4759,-73.2121],duration:4,rating:4.7,description:"Waterfront views, Church Street pedestrian mall, and Lake Champlain sunsets.",highlights:["Church Street (pedestrian mall + buskers)","Lake Champlain waterfront walk","Sunset over the Adirondacks","Local craft beer scene"],tip:"Nice stopping place, some hiking options",momQuote:"No specific plans for Burlington, just a nice stopping place",suggestedNights:"0-1",tags:["lakefront","hip","sunset"],momMentioned:!0,source:"mmtrip"},{id:"city-saratoga",category:"city",name:"Saratoga Springs",region:"saratoga",location:"Saratoga Springs, NY",coordinates:[43.0831,-73.784],duration:4,rating:4.6,description:'Racing season is over, meaning quieter "dark days" ideal for spas, Broadway strolls, and gardens.',highlights:["Broadway stroll and cafes","Yaddo Gardens","Roosevelt Baths & Spa","Downtown charm"],tip:"Stay 1 night before flying out of Albany",momQuote:"Drive to Saratoga via Lake Placidâ€”stay 1 night",suggestedNights:"1",tags:["spa","charming","relaxed"],momMentioned:!0,source:"mmtrip"},{id:"hike-marginal-way",category:"hike",name:"Marginal Way",region:"maine_coast",location:"Ogunquit, ME",coordinates:[43.2364,-70.5903],duration:1,difficulty:"Easy",distance:"1.25 miles",description:"Paved cliff walk with stunning ocean views. Links Ogunquit to Perkins Cove.",tip:"Best at sunrise before the crowds",tags:["paved","ocean-views","easy"],momMentioned:!0,source:"mmtrip"},{id:"hike-sabbaday-falls",category:"hike",name:"Sabbaday Falls",region:"white_mountains",location:"Kancamagus Highway, NH",coordinates:[43.9851,-71.3684],duration:.75,difficulty:"Easy",distance:"0.75 miles round trip",description:"Multi-tier waterfall with easy loop trail. Perfect quick stop on the Kanc.",tip:"Hit the trailhead before 9:30am to beat tour buses",tags:["waterfall","quick","family-friendly"],momMentioned:!1,source:"research"},{id:"hike-mount-battie",category:"hike",name:"Mount Battie",region:"maine_coast",location:"Camden, ME",coordinates:[44.2098,-69.0648],duration:2,difficulty:"Moderate",distance:"1.5 miles to summit",description:"Climb for epic views of Camden Harbor + fall foliage. Can also drive up!",tip:"Tower at summit has 360Â° views",tags:["summit","harbor-views","foliage"],momMentioned:!1,source:"research"},{id:"hike-mount-royal",category:"hike",name:"Mount Royal",region:"montreal",location:"Montreal, QC",coordinates:[45.5048,-73.5877],duration:2,difficulty:"Easy-Moderate",distance:"2 miles to Kondiaronk Belvedere",description:"Fall foliage WITH a city skyline. Best of both worlds.",tip:"Kondiaronk Belvedere has the famous Montreal panorama",tags:["city-views","foliage","belvedere"],momMentioned:!0,source:"mmtrip"},{id:"hike-sallys-property",category:"hike",name:"Sally's Property Trails",region:"vermont",location:"Chelsea, VT",coordinates:[43.9887,-72.4476],duration:3,difficulty:"Variable",distance:"Multiple trails on property",private:!0,description:"Private property hiking, dark skies for stargazing, peak foliage timing.",tip:"Grab groceries in Barre or Lebanon before arrivingâ€”closest store is 20 min away",momQuote:"We can do some serious walking/hiking just on Sally's property alone.",tags:["private","stargazing","rural"],momMentioned:!0,source:"mmtrip"},{id:"hike-ice-glen",category:"hike",name:"Ice Glen & Laura's Tower",region:"berkshires",location:"Stockbridge, MA",coordinates:[42.2876,-73.3207],duration:2.5,difficulty:"Moderate",distance:"1.5 miles",description:"Scramble through mossy boulders in a cool ravine, then climb to a stone tower.",tip:"Bring hiking microspikes if exploring in late season",momQuote:"Hiking in Ice Glen and Laura's Tower?",tags:["boulders","tower","adventure"],momMentioned:!0,source:"mmtrip"},{id:"drive-kancamagus",category:"drive",name:"Kancamagus Highway",region:"white_mountains",location:"White Mountains, NH",coordinates:[44.0456,-71.4161],duration:2.5,distance:"34 miles",rating:5,description:"THE premier leaf-peeping drive. No gas stations, no servicesâ€”just pure beauty.",stops:[{name:"Albany Covered Bridge",type:"photo"},{name:"Sabbaday Falls",type:"hike"},{name:"Hancock Overlook",type:"viewpoint"}],tip:"Depart by 8am. Jammed 11am-3pm.",foliage:"Peak late September at higher elevations",tags:["foliage","no-services","must-do"],momMentioned:!0,source:"mmtrip"},{id:"drive-whiteface",category:"drive",name:"Whiteface Veterans Memorial Highway",region:"adirondacks",location:"Adirondacks, NY",coordinates:[44.3659,-73.9026],duration:1.5,distance:"5 miles to summit",rating:5,description:"Drive almost to the summit! 360Â° views from 4,867 ft elevation.",tip:"Closes mid-October, so late Sept is PERFECT.",foliage:"Peak! 70-90% color in late September",tags:["summit","adirondacks","views"],momMentioned:!0,source:"mmtrip"},{id:"drive-route-100",category:"drive",name:"Route 100 Vermont",region:"vermont",location:"Vermont",coordinates:[44.4654,-72.6874],duration:4,distance:"Varies (can do sections)",rating:4.8,description:'The "Main Street of Vermont." Covered bridges, farms, and fire colors.',stops:[{name:"Stowe",type:"town"},{name:"Waterbury (Ben & Jerry's)",type:"food"},{name:"Cold Hollow Cider",type:"food"}],tip:"Can do sections rather than whole route",foliage:"Peak early-to-mid October",tags:["covered-bridges","farms","classic-vermont"],momMentioned:!1,source:"research"},{id:"drive-route-1-coast",category:"drive",name:"Route 1 Coastal Drive",region:"maine_coast",location:"New Hampshire to Portland, ME",coordinates:[43.0718,-70.7626],duration:3.5,distance:"~60 miles (with stops)",rating:4.7,description:"The slow, beautiful coastal route through all the harbor towns.",stops:[{name:"Portsmouth, NH",type:"town"},{name:"Ogunquit",type:"town"},{name:"Kennebunkport",type:"town"}],tip:'Adds 90 mins vs. I-95 but nails the "little harbor towns" wish',tags:["coastal","harbor-towns","scenic"],momMentioned:!0,source:"mmtrip"},{id:"foliage-hancock-overlook",category:"foliage",name:"Hancock Overlook",region:"white_mountains",location:"Kancamagus Highway, NH",coordinates:[44.0456,-71.4161],duration:.5,description:"Hairpin view of Osceola Range. Expect highest foliage intensity on the Kanc.",foliagePeak:"Sept 25 - Oct 5",expectedColor:"60-80%",tags:["overlook","kanc","peak-foliage"],momMentioned:!1,source:"research"},{id:"foliage-lake-placid",category:"foliage",name:"Lake Placid Area",region:"adirondacks",location:"Lake Placid, NY",coordinates:[44.2795,-73.9799],duration:4,description:"Adirondacks peak earlyâ€”huge foliage payoff. Whiteface Mountain nearby.",foliagePeak:"Sept 22 - Oct 5",expectedColor:"70-90%",highlights:["Drive Whiteface Mountain","Mirror Lake views","Olympic venues"],momQuote:"Optional detour via Lake Placid",tags:["peak","adirondacks","mountain"],momMentioned:!0,source:"mmtrip"},{id:"foliage-chelsea-vermont",category:"foliage",name:"Central Vermont Hills",region:"vermont",location:"Chelsea, VT",coordinates:[43.9887,-72.4476],duration:3,description:"Vermont hills starting to pop. Sugar maples glowing orange.",foliagePeak:"Sept 28 - Oct 8",expectedColor:"50-70%",tags:["vermont","maples","rural"],momMentioned:!0,source:"mmtrip"},{id:"landmark-portland-head-light",category:"landmark",name:"Portland Head Light",region:"portland",location:"Cape Elizabeth, ME",coordinates:[43.6231,-70.208],duration:1.5,description:"Most photographed lighthouse in America! Established 1791.",tip:"$5 park fee, totally worth it. Bite Into Maine food truck often here.",photoSpot:"From the south rocks at sunset",tags:["lighthouse","iconic","photo-op"],momMentioned:!1,source:"research"},{id:"landmark-freedom-trail",category:"landmark",name:"Freedom Trail",region:"boston",location:"Boston, MA",coordinates:[42.3588,-71.0598],duration:2.5,description:"2.5-mile walk through 16 historic sites. Follow the red brick lineâ€”you can't get lost!",tip:"Golden hour at Faneuil Hall for photos",highlights:["Boston Common","Old North Church","Paul Revere House","Faneuil Hall"],tags:["history","walking","revolutionary"],momMentioned:!0,source:"mmtrip"},{id:"landmark-notre-dame",category:"landmark",name:"Notre-Dame Basilica",region:"montreal",location:"Montreal, QC",coordinates:[45.5046,-73.5566],duration:1.5,description:"Stunning Gothic Revival basilica. The Aura light show is Instagram gold.",tip:"Book Aura light + sound show in advance",tags:["cathedral","light-show","architecture"],momMentioned:!0,source:"mmtrip"},{id:"landmark-albany-covered-bridge",category:"landmark",name:"Albany Covered Bridge",region:"white_mountains",location:"Kancamagus Highway, NH",coordinates:[43.9612,-71.2234],duration:.5,description:"Classic New England postcard. First leg-stretch and photo op on the Kanc.",tip:"Quick stop, great for photos",tags:["covered-bridge","photo-op","kanc"],momMentioned:!1,source:"research"},{id:"food-duckfat",category:"food",name:"Duckfat",region:"portland",location:"Portland, ME",coordinates:[43.6557,-70.2558],duration:1,price:"$$",description:"Famous for Belgian fries cooked in duck fat. Also great poutine and paninis.",mustTry:"Duck fat fries + poutine",tags:["fries","casual","iconic"],momMentioned:!1,source:"research"},{id:"food-schwartzs",category:"food",name:"Schwartz's Deli",region:"montreal",location:"Montreal, QC",coordinates:[45.5181,-73.5778],duration:1,price:"$$",description:"Iconic Montreal smoked meat since 1928. The line is part of the experience.",mustTry:"Medium-fat smoked meat sandwich",tip:'Order "medium-fat" for authentic texture',tags:["iconic","smoked-meat","deli"],momMentioned:!0,source:"mmtrip"},{id:"food-st-viateur",category:"food",name:"St-Viateur Bagels",region:"montreal",location:"Montreal, QC",coordinates:[45.5236,-73.6008],duration:.5,price:"$",description:"Wood-fired Montreal-style bagels. Sweeter and denser than NYC bagels.",mustTry:"Sesame bagel with cream cheese",tip:"Open 24 hours! Also try rival Fairmount nearby.",tags:["bagels","iconic","24-hours"],momMentioned:!0,source:"mmtrip"},{id:"food-la-banquise",category:"food",name:"La Banquise",region:"montreal",location:"Montreal, QC",coordinates:[45.5275,-73.5714],duration:1,price:"$$",description:"The ultimate poutine destination. 30+ varieties, open 24 hours.",mustTry:"Classic poutine (late night!)",tip:"Split itâ€”it's huge!",tags:["poutine","late-night","24-hours"],momMentioned:!0,source:"mmtrip"},{id:"food-cold-hollow",category:"food",name:"Cold Hollow Cider Mill",region:"vermont",location:"Waterbury, VT",coordinates:[44.3553,-72.7506],duration:.75,price:"$",description:"Fresh cider donuts and apple cider. Peak fall experience.",mustTry:"Cider donuts + fresh apple cider",tip:"Grab donuts + cider for the border queue to Canada",tags:["donuts","cider","fall"],momMentioned:!1,source:"research"},{id:"food-ben-jerrys",category:"food",name:"Ben & Jerry's Factory",region:"vermont",location:"Waterbury, VT",coordinates:[44.3506,-72.7281],duration:1,price:"$",description:"Factory tour and ice cream. The Flavor Graveyard is a fun photo op.",mustTry:"Any scoop + see the Flavor Graveyard",tags:["ice-cream","tour","fun"],momMentioned:!1,source:"research"},{id:"lodge-godfrey-boston",category:"lodging",name:"The Godfrey Hotel Boston",region:"boston",location:"Boston, MA - Downtown",coordinates:[42.3554,-71.064],priceRange:"$250-350/night",type:"Boutique Hotel",description:"Modern boutique steps from Boston Common. Skip hotel parkingâ€”you don't need a car in Boston!",amenities:["Rooftop Bar","Free WiFi","Fitness Center","Restaurant"],tip:"Rooftop bar has great sunset views",tags:["boutique","downtown","rooftop"],momMentioned:!1,source:"research"},{id:"lodge-press-portland",category:"lodging",name:"The Press Hotel",region:"portland",location:"Portland, ME - Old Port",coordinates:[43.6591,-70.2568],priceRange:"$280-400/night",type:"Boutique Hotel",description:"Converted from Portland's newspaper HQ. Quirky literary vibes. Walk to EVERYTHING.",amenities:["On-site Restaurant","Lobby Bar","Free WiFi","Bikes Available"],tip:"Ask for a room with harbor glimpses",tags:["boutique","historic","walkable"],momMentioned:!1,source:"research"},{id:"lodge-sallys",category:"lodging",name:"Sally's Vermont Property",region:"vermont",location:"Chelsea, VT",coordinates:[43.9887,-72.4476],priceRange:"Friend rate!",type:"Private Home",private:!0,description:"The REAL Vermont experience. Mountain views, hiking access, a million stars at night.",amenities:["Mountain Views","Hiking Access","Stargazing","Full Kitchen","Peace & Quiet"],tip:"Grab groceries before arrivingâ€”closest store is 20 min away",momQuote:"We could stay a night at Sally's in Chelsea",tags:["private","rural","authentic"],momMentioned:!0,source:"mmtrip"},{id:"lodge-petit-montreal",category:"lodging",name:"Le Petit Hotel",region:"montreal",location:"Montreal, QC - Old Montreal",coordinates:[45.5048,-73.5538],priceRange:"$280-380/night CAD",type:"Boutique Hotel",description:"Intimate boutique steps from Notre-Dame Basilica. Complimentary wine hour + breakfast.",amenities:["Breakfast Included","Rooftop Terrace","Wine & Cheese Hour","Bikes"],tip:"Walk to Olive et Gourmando for the best sandwiches",tags:["boutique","old-montreal","romantic"],momMentioned:!1,source:"research"},{id:"lodge-adelphi-saratoga",category:"lodging",name:"The Adelphi Hotel",region:"saratoga",location:"Saratoga Springs, NY",coordinates:[43.0831,-73.7846],priceRange:"$350-500/night",type:"Historic Boutique",description:"Stunning restored Victorian hotel. THE place to stay in Saratoga. Gilded age vibes.",amenities:["Pool","Spa","Restaurant","Historic Charm","Bar"],tip:"Their bar is gorgeous for a nightcap",tags:["historic","victorian","spa"],momMentioned:!1,source:"research"},{id:"lodge-mirror-lake-inn",category:"lodging",name:"Mirror Lake Inn",region:"adirondacks",location:"Lake Placid, NY",coordinates:[44.2795,-73.9799],priceRange:"$400-600/night",type:"Lakefront Resort",description:"Stunning lake views, full spa, very romantic. If you do the Lake Placid route.",amenities:["Lake Views","Spa","Restaurant","Private Beach","Pool"],tip:"Lakefront rooms are worth it. Get there early for Whiteface drive.",tags:["lakefront","spa","romantic"],momMentioned:!1,source:"research"}];function Ee(t){return rt.find(a=>a.id===t)}async function De(t,{signal:a}={}){if(!t)return null;const o=`https://nominatim.openstreetmap.org/search?format=jsonv2&limit=1&q=${encodeURIComponent(t)}&email=${encodeURIComponent("mmt-trip-planner@example.com")}`,l=await fetch(o,{signal:a});if(!l.ok)return null;const h=(await l.json())?.[0];return!h?.lat||!h?.lon?null:[Number(h.lat),Number(h.lon)]}function Ne(t){if(!Number.isFinite(t))return"--";const a=t/1609.344;return a<10?`${a.toFixed(1)} mi`:`${Math.round(a)} mi`}function we(t){if(!Number.isFinite(t))return"--";const a=Math.round(t/60);if(a<60)return`${a} min`;const o=Math.floor(a/60),l=a%60;return l?`${o}h ${l}m`:`${o}h`}function je(t){return Number.isFinite(t)?t<1?`${Math.round(t*60)} min`:t%1===0?`${t} hr`:`${t.toFixed(1)} hr`:"--"}function $e(t){return Number.isFinite(t)?`$${Math.round(t).toLocaleString()}`:"--"}function Mt(t){return`hsl(${(t-1)*45%360} 70% 45%)`}function Ct({bounds:t}){const a=Ze();return r.useEffect(()=>{!t||t.length<1||a.fitBounds(t,{padding:[24,24]})},[a,t]),null}function St({stop:t,activities:a,lodging:o,isActive:l,onHover:p,onLeave:h}){return e.jsxs("article",{className:`stop-card ${l?"active":""}`,onMouseEnter:()=>p(t.id),onMouseLeave:()=>h(),children:[e.jsxs("header",{className:"stop-card-header",children:[e.jsxs("div",{children:[e.jsx("p",{className:"stop-day",children:t.dayRange}),e.jsx("h3",{children:t.title})]}),e.jsxs("div",{className:"stop-meta",children:[e.jsx("span",{children:t.nights}),e.jsx("span",{children:t.driveTime})]})]}),e.jsx("p",{className:"stop-note",children:t.notes}),e.jsxs("blockquote",{className:"stop-quote",children:['"',t.momQuote,'"']}),t.highlights?.length>0&&e.jsx("div",{className:"stop-highlights",children:t.highlights.map(d=>e.jsx("span",{className:"pill",children:d},d))}),o&&e.jsxs("div",{className:"stop-lodging",children:[e.jsx("h4",{children:"Stay"}),e.jsxs("div",{className:"lodging-card",children:[e.jsx("strong",{children:o.name}),e.jsx("span",{children:o.location}),o.tip&&e.jsxs("small",{children:["Tip: ",o.tip]})]})]}),e.jsxs("div",{className:"stop-activities",children:[e.jsx("h4",{children:"Must-do ideas"}),e.jsx("div",{className:"stop-activity-grid",children:a.map(d=>e.jsxs("div",{className:"stop-activity",children:[e.jsxs("div",{className:"stop-activity-title",children:[e.jsx("span",{className:"activity-icon",children:G[d.category]?.icon??"*"}),e.jsxs("div",{children:[e.jsx("strong",{children:d.name}),e.jsx("span",{children:d.location})]})]}),e.jsxs("div",{className:"stop-activity-meta",children:[d.duration&&e.jsx("span",{children:je(d.duration)}),d.price&&e.jsx("span",{children:d.price}),d.waitTime&&e.jsx("span",{children:d.waitTime})]}),d.mustTry&&e.jsxs("p",{className:"activity-callout",children:["Must try: ",d.mustTry]}),d.tip&&e.jsxs("p",{className:"activity-tip",children:["Tip: ",d.tip]})]},d.id))})]})]})}function At({onCopyToBuilder:t}){const[a,o]=r.useState(null),[l,p]=r.useState({}),h=r.useMemo(()=>{const s={};return B.stops.forEach(f=>{s[f.id]=(f.activities||[]).map(N=>Ee(N)).filter(Boolean)}),s},[]),d=r.useMemo(()=>{const s={};return B.stops.forEach(f=>{s[f.id]=f.lodging?Ee(f.lodging):null}),s},[]);r.useEffect(()=>{const s=new AbortController;let f=!1;async function N(){const M={};for(const A of B.stops)if(!l[A.id])try{const C=await De(A.location,{signal:s.signal});C&&(M[A.id]=C)}catch(C){if(C?.name==="AbortError")return}f||Object.keys(M).length&&p(A=>({...A,...M}))}return N(),()=>{f=!0,s.abort()}},[l]);const y=B.stops.map(s=>l[s.id]).filter(Boolean),u=y.length?y:null;return e.jsxs("section",{className:"moms-route",children:[e.jsxs("div",{className:"route-hero",children:[e.jsxs("div",{className:"hero-content",children:[e.jsx("p",{className:"hero-eyebrow",children:"Suggested route built from Mom's original notes"}),e.jsx("h2",{children:B.title}),e.jsx("p",{className:"hero-subtitle",children:B.subtitle}),e.jsx("div",{className:"hero-theme",children:B.themeLine}),e.jsxs("div",{className:"hero-actions",children:[e.jsx("button",{type:"button",className:"btn-primary",onClick:t,children:"Copy to Builder"}),e.jsx("span",{className:"hero-window",children:B.travelWindow})]})]}),e.jsxs("div",{className:"hero-stats",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{children:"Duration"}),e.jsx("strong",{children:B.overview.duration})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{children:"Total miles"}),e.jsx("strong",{children:B.overview.totalMiles})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{children:"Drive time"}),e.jsx("strong",{children:B.overview.driveTime})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{children:"Fly in/out"}),e.jsx("strong",{children:B.overview.flyIn}),e.jsx("small",{children:B.overview.flyOut})]})]})]}),e.jsx("div",{className:"route-warnings",children:B.warnings.map(s=>e.jsxs("div",{className:"warning-card",children:[e.jsx("strong",{children:s.title}),e.jsx("p",{children:s.detail})]},s.title))}),e.jsx("div",{className:"route-ribbon",children:B.ribbonStops.map(s=>e.jsxs("div",{className:`ribbon-stop ${a===s.id?"active":""}`,onMouseEnter:()=>o(s.id),onMouseLeave:()=>o(null),children:[e.jsx("span",{className:"ribbon-emoji",children:s.emoji}),e.jsxs("div",{children:[e.jsx("strong",{children:s.name}),e.jsx("span",{children:s.nights}),e.jsx("small",{children:s.drive})]})]},s.id))}),e.jsx("div",{className:"featured-moments",children:B.featuredMoments.map(s=>e.jsxs("div",{className:"featured-card",children:[e.jsx("h3",{children:s.title}),e.jsx("p",{children:s.detail}),e.jsx("span",{className:"featured-stop",children:B.ribbonStops.find(f=>f.id===s.stopId)?.name})]},s.title))}),e.jsx("div",{className:"stop-cards",children:B.stops.map(s=>e.jsx(St,{stop:s,activities:h[s.id]||[],lodging:d[s.id],isActive:a===s.id,onHover:o,onLeave:()=>o(null)},s.id))}),e.jsxs("div",{className:"route-map-section",children:[e.jsxs("div",{className:"map-copy",children:[e.jsx("h3",{children:"Route overview"}),e.jsx("p",{children:"Pin the key bases, then zoom in as you decide on day-by-day stops."})]}),e.jsx("div",{className:"route-map",children:e.jsxs(ze,{center:[43.5,-71.5],zoom:6,style:{height:"100%",width:"100%"},children:[u&&e.jsx(Ct,{bounds:u}),e.jsx(Ge,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"Â© OpenStreetMap"}),y.length>1&&e.jsx(Qe,{positions:y,pathOptions:{color:"#e86f3a",weight:4,opacity:.7}}),B.stops.map(s=>l[s.id]?e.jsx(Je,{position:l[s.id],children:e.jsxs(Xe,{children:[e.jsx("strong",{children:s.title}),e.jsx("br",{}),s.dayRange]})},s.id):null)]})})]}),e.jsxs("div",{className:"route-grid",children:[e.jsxs("section",{className:"route-panel",children:[e.jsx("h3",{children:"Foliage radar"}),e.jsx("div",{className:"chip-grid",children:B.foliage.peakWindows.map(s=>e.jsx("span",{className:"pill",children:s},s))}),e.jsx("h4",{children:"Best drives"}),e.jsx("div",{className:"chip-grid",children:B.foliage.bestDrives.map(s=>e.jsx("span",{className:"pill muted",children:s},s))})]}),e.jsxs("section",{className:"route-panel",children:[e.jsx("h3",{children:"Budget bands"}),e.jsx("div",{className:"budget-grid",children:B.budget.tiers.map(s=>e.jsxs("div",{className:"budget-card",children:[e.jsx("strong",{children:s.name}),e.jsx("span",{children:s.range}),e.jsx("p",{children:s.detail})]},s.name))}),e.jsx("ul",{className:"tip-list",children:B.budget.tips.map(s=>e.jsx("li",{children:s},s))})]}),e.jsxs("section",{className:"route-panel",children:[e.jsx("h3",{children:"Packing playbook"}),e.jsx("p",{className:"panel-note",children:B.packing.weatherNote}),e.jsxs("div",{className:"packing-grid",children:[e.jsxs("div",{children:[e.jsx("h4",{children:"Essentials"}),e.jsx("ul",{children:B.packing.essentials.map(s=>e.jsx("li",{children:s},s))})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"Fun extras"}),e.jsx("ul",{children:B.packing.extras.map(s=>e.jsx("li",{children:s},s))})]})]})]})]}),e.jsxs("section",{className:"route-panel alt-panel",children:[e.jsx("h3",{children:"Alternative endings"}),e.jsx("div",{className:"alt-grid",children:B.alternatives.map(s=>e.jsxs("div",{className:"alt-card",children:[e.jsx("strong",{children:s.title}),e.jsx("p",{children:s.detail}),e.jsxs("div",{className:"alt-meta",children:[s.addsDays?e.jsxs("span",{children:["+",s.addsDays," day(s)"]}):null,s.flyOut?e.jsx("span",{children:s.flyOut}):null]})]},s.title))})]}),e.jsxs("section",{className:"route-panel wildcard-panel",children:[e.jsx("h3",{children:"Wildcards Mom mentioned"}),e.jsx("ul",{children:B.wildcards.map(s=>e.jsx("li",{children:s},s))})]}),e.jsxs("div",{className:"route-cta",children:[e.jsx("button",{type:"button",className:"btn-primary",onClick:t,children:"Copy Mom's Route to Builder"}),e.jsx("p",{children:"Make edits, swap stops, or build a brand-new plan from scratch."})]})]})}function Tt({trip:t,getActivityWaypoints:a}){const[o,l]=r.useState({}),[p,h]=r.useState(!1),[d,y]=r.useState(null),[u,s]=r.useState({});return r.useEffect(()=>{const f=new AbortController;let N=!1;async function M(){const A=Array.from(new Set((t.days||[]).map(v=>(v.location||"").trim()).filter(Boolean))),C={};for(const v of A)if(!u[v])try{const g=await De(v,{signal:f.signal});g&&(C[v]=g)}catch(g){if(g?.name==="AbortError")return}N||Object.keys(C).length&&s(v=>({...v,...C}))}return M(),()=>{N=!0,f.abort()}},[t.days,u]),r.useEffect(()=>{const f=new AbortController;let N=!1;async function M(){h(!0),y(null);const A={};for(let C=0;C<t.days.length;C++){const v=t.days[C],g=v?.type==="drive",b=(v?.location||"").trim()||null,k=C>0?(t.days[C-1]?.location||"").trim():null,R=g?k:b,L=[],I=R?u[R]:null;R&&I&&L.push({id:`base-start-${v.id}`,name:R,coordinates:I}),L.push(...a(v));const F=b?u[b]:null;if(g&&b&&F&&b!==R&&L.push({id:`base-end-${v.id}`,name:b,coordinates:F}),L.length<2)continue;const w=`https://router.project-osrm.org/route/v1/driving/${L.map(T=>`${T.coordinates[1]},${T.coordinates[0]}`).join(";")}?overview=full&geometries=geojson&steps=false`;try{const T=await fetch(w,{signal:f.signal});if(!T.ok)continue;const j=(await T.json())?.routes?.[0];if(!j?.geometry?.coordinates?.length)continue;const D=j.geometry.coordinates.map(([W,$])=>[$,W]),V=(j.legs||[]).map((W,$)=>({from:L[$]?.name??`Stop ${$+1}`,to:L[$+1]?.name??`Stop ${$+2}`,distance_m:W.distance,duration_s:W.duration}));A[v.id]={dayId:v.id,dayNumber:v.dayNumber,distance_m:j.distance,duration_s:j.duration,line:D,legs:V}}catch(T){if(T?.name==="AbortError")return}}N||(l(A),h(!1))}return M().catch(A=>{N||A?.name==="AbortError"||(y("Could not load driving routes."),h(!1))}),()=>{N=!0,f.abort()}},[t.days,a,u]),{dayRoutes:o,routesLoading:p,routesError:d,baseCoordsByLabel:u}}function Bt(t){if(!t)return null;const[a,o]=t.split(":").map(l=>Number(l));return!Number.isFinite(a)||!Number.isFinite(o)?null:a*60+o}function Rt(t){if(!Number.isFinite(t))return"";const a=(t%1440+1440)%1440,o=Math.floor(a/60),l=Math.round(a%60);return`${String(o).padStart(2,"0")}:${String(l).padStart(2,"0")}`}function ye(t){return t*Math.PI/180}function Pe(t,a){if(!t||!a)return 0;const[o,l]=t,[p,h]=a,d=3958.8,y=ye(p-o),u=ye(h-l),s=Math.sin(y/2)*Math.sin(y/2)+Math.cos(ye(o))*Math.cos(ye(p))*Math.sin(u/2)*Math.sin(u/2),f=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s));return d*f}function Et(t){if(!t)return 0;const o=t/40*60;return Math.round(o+10)}function Lt({activities:t,startTime:a="09:00",bufferMinutes:o=20}){const l={};let p=Bt(a)??540,h=null;return t.forEach((d,y)=>{let u=o;if(h&&d.coordinates){const M=Pe(h,d.coordinates),A=Et(M);u=Math.max(A,15)}else y===0&&(u=0);y>0&&(p+=u);const s=Number(d.duration)||1.5,f=Rt(p);l[d.id]={startTime:f,duration:s,bufferMinutes:u,travelMiles:h&&d.coordinates?Pe(h,d.coordinates).toFixed(1):null};const N=s*60;p+=N,d.coordinates&&(h=d.coordinates)}),l}function Le(t){return!t||typeof t!="object"||!Array.isArray(t.days)?!1:t.days.every(a=>a&&typeof a.id=="string"&&Array.isArray(a.activities))}function Fe(t){return t?{name:t.name,days:t.days.map((a,o)=>({id:`day-${o+1}`,dayNumber:a.dayNumber??o+1,label:a.label??`Day ${o+1}`,location:a.location??"",activities:a.suggestedActivities||[],notes:a.notes||"",type:a.type||"custom",lodging:a.lodging||null,startTime:"09:00",schedule:{}})),createdAt:new Date().toISOString(),templateId:t.id}:null}function Dt({dayCount:t=5,name:a="My New England Trip",defaultLabel:o="Day"}={}){return{name:a,days:Array.from({length:t},(l,p)=>({id:`day-${p+1}`,dayNumber:p+1,label:`${o} ${p+1}`,location:"",activities:[],notes:"",type:"custom",lodging:null,startTime:"09:00",schedule:{}})),createdAt:new Date().toISOString(),templateId:null}}function He(t){return t.map((a,o)=>({...a,dayNumber:o+1,id:`day-${o+1}`,label:a.label||`Day ${o+1}`}))}function It(t){return t.reduce((o,l)=>(o.activities+=l.activities.length,o),{days:t.length,activities:0})}function Ot({name:t,startLocation:a,endLocation:o,dayCount:l,style:p="balanced"}){const h=Math.max(1,Number(l)||1),d=Array.from({length:h},(y,u)=>{const s=u===0,f=u===h-1,M=s?"arrival":f?"departure":p==="hustle"?"drive":"explore";return{id:`day-${u+1}`,dayNumber:u+1,label:s?"Arrival":f?"Departure":`Day ${u+1}`,location:"",activities:[],notes:"",type:M,lodging:null,startTime:"09:00",schedule:{}}});return{name:t||"My Custom Trip",days:d,createdAt:new Date().toISOString(),templateId:null}}const Ie={AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming",DC:"District of Columbia"};Object.fromEntries(Object.entries(Ie).map(([t,a])=>[a.toLowerCase(),t]));const $t=Object.keys(Ie),Pt={AL:["FL","GA","MS","TN"],AK:[],AZ:["CA","CO","NM","NV","UT"],AR:["LA","MO","MS","OK","TN","TX"],CA:["AZ","NV","OR"],CO:["AZ","KS","NE","NM","OK","UT","WY"],CT:["MA","NY","RI"],DE:["MD","NJ","PA"],FL:["AL","GA"],GA:["AL","FL","NC","SC","TN"],HI:[],ID:["MT","NV","OR","UT","WA","WY"],IL:["IA","IN","KY","MO","WI"],IN:["IL","KY","MI","OH"],IA:["IL","MN","MO","NE","SD","WI"],KS:["CO","MO","NE","OK"],KY:["IL","IN","MO","OH","TN","VA","WV"],LA:["AR","MS","TX"],ME:["NH"],MD:["DC","DE","PA","VA","WV"],MA:["CT","NH","NY","RI","VT"],MI:["IN","OH","WI"],MN:["IA","ND","SD","WI"],MS:["AL","AR","LA","TN"],MO:["AR","IA","IL","KS","KY","NE","OK","TN"],MT:["ID","ND","SD","WY"],NE:["CO","IA","KS","MO","SD","WY"],NV:["AZ","CA","ID","OR","UT"],NH:["MA","ME","VT"],NJ:["DE","NY","PA"],NM:["AZ","CO","OK","TX","UT"],NY:["CT","MA","NJ","PA","VT"],NC:["GA","SC","TN","VA"],ND:["MN","MT","SD"],OH:["IN","KY","MI","PA","WV"],OK:["AR","CO","KS","MO","NM","TX"],OR:["CA","ID","NV","WA"],PA:["DE","MD","NJ","NY","OH","WV"],RI:["CT","MA"],SC:["GA","NC"],SD:["IA","MN","MT","ND","NE","WY"],TN:["AL","AR","GA","KY","MO","MS","NC","VA"],TX:["AR","LA","NM","OK"],UT:["AZ","CO","ID","NM","NV","WY"],VT:["MA","NH","NY"],VA:["DC","KY","MD","NC","TN","WV"],WA:["ID","OR"],WV:["KY","MD","OH","PA","VA"],WI:["IA","IL","MI","MN"],WY:["CO","ID","MT","NE","SD","UT"],DC:["MD","VA"]};function Ft(t){return String(t||"").toLowerCase().replace(/\s+/g," ").trim()}function Ht(t){const a=String(t||"");if(!a.trim())return[];const o=new Set,l=new RegExp(`\\b(${$t.join("|")})\\b`,"g"),p=a.toUpperCase();let h;for(;h=l.exec(p);)o.add(h[1]);const d=Ft(a);for(const[y,u]of Object.entries(Ie)){const s=u.toLowerCase();d.includes(s)&&o.add(y)}return Array.from(o)}function _t(t){const a=Array.isArray(t)?t:[],o=new Set;return a.map(l=>String(l||"").toUpperCase().trim()).filter(Boolean).forEach(l=>{o.add(l),(Pt[l]||[]).forEach(p=>o.add(p))}),Array.from(o)}function Wt(t){if(t.googleMapsUrl)return t.googleMapsUrl;const a=`${t.name||""} ${t.location||""}`.trim();return a?`https://www.google.com/maps/search/${encodeURIComponent(a)}`:null}function Ce(t,a){const o=`${t.name||""} ${t.location||""} ${a}`.trim();return`https://www.google.com/search?q=${encodeURIComponent(o)}`}function Vt({activity:t,days:a,selectedDayId:o,onClose:l,onAddToDay:p,onRemoveFromDay:h,onEditCustom:d,onDeleteCustom:y}){const[u,s]=r.useState(o);r.useEffect(()=>{s(o)},[o,t]);const f=r.useMemo(()=>t?!!a.find(k=>k.id===o)?.activities.includes(t.id):!1,[t,a,o]);if(!t)return null;const N=G[t.category]||G.custom,M=t.private||t.isCustom,A=M?null:Wt(t),C=M?null:Ce(t,"menu"),v=M?null:Ce(t,"reviews"),g=M?null:Ce(t,"photos");return e.jsx("div",{className:"modal-overlay",onClick:l,role:"presentation",children:e.jsxs("div",{className:"modal",role:"dialog","aria-modal":"true",onClick:b=>b.stopPropagation(),children:[e.jsxs("header",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"modal-eyebrow-row",children:[e.jsx("span",{className:"modal-eyebrow",children:N?.name||"Activity"}),t.momMentioned&&e.jsx("span",{className:"badge-mom",children:"â¤ï¸ Mom Approved"}),M&&e.jsx("span",{className:"badge-private",children:"ðŸ  Private"})]}),e.jsxs("h2",{children:[N?.icon," ",t.name]}),e.jsx("p",{className:"modal-subtitle",children:t.location})]}),e.jsx("button",{type:"button",className:"icon-btn",onClick:l,"aria-label":"Close details",children:"x"})]}),e.jsxs("div",{className:"modal-body",children:[t.description&&e.jsx("p",{className:"modal-description",children:t.description}),e.jsxs("div",{className:"modal-meta-grid",children:[t.duration&&e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Duration"}),e.jsx("span",{children:je(t.duration)})]}),t.price&&e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Cost"}),e.jsx("span",{children:t.price})]}),t.rating&&!M&&e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Rating"}),e.jsxs("span",{children:[t.rating," â˜…"]})]}),t.waitTime&&e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Wait"}),e.jsx("span",{children:t.waitTime})]}),t.address&&e.jsxs("div",{className:"meta-item span-2",children:[e.jsx("span",{className:"meta-label",children:"Address"}),e.jsx("span",{children:t.address})]}),t.phone&&e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"Phone"}),e.jsx("a",{href:`tel:${t.phone}`,children:t.phone})]})]}),(v||C||g)&&e.jsxs("div",{className:"modal-deep-links",children:[v&&e.jsxs("a",{className:"deep-link",href:v,target:"_blank",rel:"noreferrer",children:[e.jsx("span",{className:"icon",children:"â­"})," Check Reviews"]}),C&&e.jsxs("a",{className:"deep-link",href:C,target:"_blank",rel:"noreferrer",children:[e.jsx("span",{className:"icon",children:"ðŸ½ï¸"})," Find Menu"]}),g&&e.jsxs("a",{className:"deep-link",href:g,target:"_blank",rel:"noreferrer",children:[e.jsx("span",{className:"icon",children:"ðŸ“¸"})," See Photos"]})]}),e.jsxs("div",{className:"modal-callouts",children:[t.mustTry&&e.jsxs("div",{className:"callout callout-specialty",children:[e.jsx("strong",{children:"ðŸ† Specialty"}),e.jsx("p",{children:t.mustTry})]}),t.tip&&e.jsxs("div",{className:"callout callout-tip",children:[e.jsx("strong",{children:"ðŸ’¡ Insider Tip"}),e.jsx("p",{children:t.tip})]}),t.notes&&e.jsxs("div",{className:"callout callout-note",children:[e.jsx("strong",{children:"ðŸ“ Note"}),e.jsx("p",{children:t.notes})]})]}),Array.isArray(t.tags)&&t.tags.length>0&&e.jsx("div",{className:"modal-tags",children:t.tags.map(b=>e.jsxs("span",{className:"tag-chip",children:["#",b]},b))}),e.jsxs("div",{className:"modal-links",children:[t.website&&e.jsx("a",{className:"link-btn primary",href:t.website,target:"_blank",rel:"noreferrer",children:"Official Website â†—"}),A&&e.jsx("a",{className:"link-btn",href:A,target:"_blank",rel:"noreferrer",children:"View on Google Maps â†—"})]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsxs("div",{className:"day-select",children:[e.jsx("label",{htmlFor:"day-select",children:"Add to day"}),e.jsx("select",{id:"day-select",value:u||"",onChange:b=>s(b.target.value),children:a.map(b=>e.jsxs("option",{value:b.id,children:["Day ",b.dayNumber,": ",b.location||b.label]},b.id))}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>p(u,t.id),children:"Add to Trip"})]}),f&&e.jsx("button",{type:"button",className:"btn-outline",onClick:()=>h(o,t.id),children:"Remove from selected day"}),(t.isCustom||t.private)&&typeof d=="function"&&e.jsxs("div",{className:"custom-actions",children:[e.jsx("button",{type:"button",className:"btn-outline",onClick:()=>d(t),children:"âœï¸ Edit Details"}),t.isCustom&&e.jsx("button",{type:"button",className:"btn-danger",onClick:()=>y(t),children:"Delete"})]})]})]})})}function Se(t){return t?String(t).split(",")[0].trim():""}function _e(t){if(!t)return"";const a=String(t).split(",").map(o=>o.trim()).filter(Boolean);return a.length<=1?"":a.slice(1).join(", ")}function qt(t){const a=String(t?.address?.state_code||"").toUpperCase().trim();if(a)return a;const o=String(t?.address?.ISO3166_2_lvl4||"").toUpperCase().trim(),l=o.startsWith("US-")?o.slice(3):"";return l||String(t?.display_name||"").toUpperCase().match(/,\s*([A-Z]{2})\s*(,|$)/)?.[1]||""}function Ut(t){const a=Array.isArray(t)?t:[],o=new Set(a);return["ME","NH","VT","MA","CT","RI","NY"].some(h=>o.has(h))?{left:-73.8,top:47.6,right:-66.8,bottom:40.9}:null}function Yt(t,a){if(!Array.isArray(t)||!Array.isArray(a))return null;const o=Number(t[0]),l=Number(t[1]),p=Number(a[0]),h=Number(a[1]);if(!Number.isFinite(o)||!Number.isFinite(l)||!Number.isFinite(p)||!Number.isFinite(h))return null;const d=6371,y=v=>v*Math.PI/180,u=y(p-o),s=y(h-l),f=Math.sin(u/2),N=Math.sin(s/2),M=Math.cos(y(o)),A=Math.cos(y(p)),C=f*f+M*A*N*N;return 2*d*Math.asin(Math.min(1,Math.sqrt(C)))}function Kt({searchMode:t,onModeChange:a,searchQuery:o,onSearchChange:l,catalogFilter:p,onFilterChange:h,regionFilter:d,onRegionFilterChange:y,showMomOnly:u,onToggleMomOnly:s,filteredCatalog:f,selectedDay:N,onAddActivity:M,onOpenDetails:A,customActivities:C,onQuickAddCustomPlace:v,allowedStateAbbrs:g,allowCanadaPlaces:b,placeSearchCenter:k,onDeleteCustom:R}){const L=Object.values(C||{}),[I,F]=r.useState(""),[E,w]=r.useState([]),[T,_]=r.useState(!1),j=r.useRef(null),[D,V]=r.useState(320),[W,$]=r.useState(!1),Q=r.useRef(null),J=r.useRef(0),me=r.useRef(0),ne=D>=500,ie=r.useMemo(()=>!!N?.id&&!!v,[N?.id,v]);r.useEffect(()=>{const n=te=>{if(!W)return;const X=te.clientX-J.current,se=Math.max(260,Math.min(800,me.current+X));V(se)},q=()=>{$(!1)};return W?(document.addEventListener("mousemove",n),document.addEventListener("mouseup",q),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",q),document.body.style.cursor="",document.body.style.userSelect=""}},[W]);const ke=n=>{n.preventDefault(),$(!0),J.current=n.clientX,me.current=D},he=()=>{j.current&&(j.current.abort(),j.current=null),F(""),w([]),_(!1)};return r.useEffect(()=>{j.current&&(j.current.abort(),j.current=null);const n=I.trim();if(!n){w([]),_(!1);return}const q=new AbortController;j.current=q,_(!0);const te=window.setTimeout(async()=>{try{const X=Array.isArray(g)?g.map(P=>String(P||"").toUpperCase().trim()).filter(Boolean):[],se=new Set(X),ae=Ut(X),re=ae?`&viewbox=${encodeURIComponent(`${ae.left},${ae.top},${ae.right},${ae.bottom}`)}`:"",Me=`https://nominatim.openstreetmap.org/search?format=jsonv2&addressdetails=1&countrycodes=${encodeURIComponent(b?"us,ca":"us")}&limit=10${re}&q=${encodeURIComponent(n)}&email=${encodeURIComponent("mmt-trip-planner@example.com")}`,pe=await fetch(Me,{signal:q.signal});if(!pe.ok){w([]);return}const ee=await pe.json(),fe=[...Array.isArray(ee)?ee.map(P=>{const K=Number(P?.lat),U=Number(P?.lon);if(!Number.isFinite(K)||!Number.isFinite(U))return null;const Y=String(P?.address?.country_code||"").toLowerCase().trim();if(Y&&Y!=="us"){if(!(b&&Y==="ca"))return null}const ce=qt(P);return{id:String(P?.place_id||`${K},${U}`),displayName:String(P?.display_name||""),coordinates:[K,U],stateAbbr:ce}}).filter(Boolean):[]].map((P,K)=>{const U=se.size>0&&P.stateAbbr?se.has(P.stateAbbr):!1,Y=k?Yt(k,P.coordinates):null;return{...P,_idx:K,_inAllowed:U,_distKm:Y}}).sort((P,K)=>{if(P._inAllowed!==K._inAllowed)return P._inAllowed?-1:1;const U=P._distKm,Y=K._distKm;return U!=null&&Y!=null&&U!==Y?U-Y:U!=null&&Y==null?-1:U==null&&Y!=null?1:P._idx-K._idx});w(fe.slice(0,6))}catch(X){X?.name!=="AbortError"&&w([])}finally{_(!1)}},250);return()=>{window.clearTimeout(te),q.abort()}},[I,g]),e.jsxs("aside",{className:"catalog",ref:Q,style:{width:`${D}px`,minWidth:"260px",maxWidth:"800px",position:"relative"},children:[e.jsx("div",{className:"catalog-resize-handle",onMouseDown:ke,role:"separator","aria-label":"Resize catalog panel"}),e.jsxs("div",{className:"catalog-header",children:[e.jsx("h2",{children:t==="catalog"?"Activities":"Your Places"}),e.jsxs("div",{className:"search-mode-toggle",children:[e.jsx("button",{className:`mode-btn ${t==="catalog"?"active":""}`,onClick:()=>a("catalog"),type:"button",children:"Catalog"}),e.jsx("button",{className:`mode-btn ${t==="custom"?"active":""}`,onClick:()=>a("custom"),type:"button",children:"Custom"})]})]}),t==="catalog"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"catalog-search",children:e.jsx("input",{type:"text",placeholder:"Search activities, tags, or locations",value:o,onChange:n=>l(n.target.value),className:"search-input"})}),e.jsxs("div",{className:"catalog-filters",children:[e.jsx("button",{className:`filter-btn ${p==="all"?"active":""}`,onClick:()=>h("all"),type:"button",children:"All"}),Object.values(G).filter(n=>n.id!=="city"&&n.id!=="custom"&&n.id!=="lodging").map(n=>e.jsx("button",{className:`filter-btn ${p===n.id?"active":""}`,onClick:()=>h(n.id),type:"button",children:n.icon},n.id)),e.jsxs("label",{className:"mom-filter",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:n=>s(n.target.checked)}),"Mom's picks"]})]}),e.jsx("div",{className:"catalog-region",children:e.jsxs("label",{children:["Region focus",e.jsxs("select",{value:d,onChange:n=>y(n.target.value),children:[e.jsx("option",{value:"all",children:"All regions"}),Object.values(kt).map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]})}),e.jsxs("div",{className:"catalog-list",children:[f.map(n=>e.jsxs("div",{className:`catalog-item ${ne?"expanded":""}`,children:[e.jsxs("div",{className:"item-header",children:[e.jsx("span",{className:"item-icon",children:G[n.category]?.icon}),e.jsxs("div",{className:"item-info",children:[e.jsxs("strong",{children:[n.name,n.momMentioned&&e.jsxs("span",{className:"icon-mom",title:"Mom Mentioned This!",children:[" ","â¤ï¸"]})]}),e.jsx("small",{children:n.location})]}),e.jsx("button",{className:"add-btn-compact",onClick:()=>M(N?.id,n.id),title:`Add to Day ${N?.dayNumber}`,type:"button",children:"+"})]}),e.jsxs("div",{className:"item-stats-row",children:[n.rating&&e.jsxs("span",{className:"stat-badge rating",title:`${n.reviewCount?n.reviewCount.toLocaleString()+" reviews":"Rating"}`,children:["â˜… ",n.rating]}),n.price&&e.jsx("span",{className:"stat-badge price",title:n.priceRange||"Price level",children:n.price}),n.duration&&e.jsxs("span",{className:"stat-badge time",children:["â± ",je(n.duration)]}),n.waitTime&&e.jsxs("span",{className:"stat-badge wait",title:"Typical wait",children:["â³ ",n.waitTime]})]}),ne&&e.jsxs("div",{className:"item-expanded",children:[n.description&&e.jsx("p",{className:"exp-description",children:n.description}),e.jsxs("div",{className:"exp-info-grid",children:[n.address&&!n.private&&e.jsxs("a",{className:"exp-info-link",href:`https://maps.google.com/?q=${encodeURIComponent(n.address)}`,target:"_blank",rel:"noopener noreferrer",title:"Open in Google Maps",children:[e.jsx("span",{className:"exp-icon",children:"ðŸ“"}),e.jsx("span",{className:"exp-text",children:n.address.split(",")[0]})]}),n.phone&&!n.private&&e.jsxs("a",{className:"exp-info-link",href:`tel:${n.phone}`,children:[e.jsx("span",{className:"exp-icon",children:"ðŸ“ž"}),e.jsx("span",{className:"exp-text",children:n.phone})]}),n.hours&&e.jsxs("div",{className:"exp-info-item",children:[e.jsx("span",{className:"exp-icon",children:"ðŸ•"}),e.jsx("span",{className:"exp-text",children:n.hours})]}),n.parking&&e.jsxs("div",{className:"exp-info-item",children:[e.jsx("span",{className:"exp-icon",children:"ðŸ…¿ï¸"}),e.jsx("span",{className:"exp-text",children:n.parking})]})]}),n.paymentNote&&e.jsx("div",{className:"exp-note",children:n.paymentNote}),n.mustTry&&e.jsxs("div",{className:"exp-callout must-try",children:[e.jsx("strong",{children:"ðŸ½ Try:"})," ",n.mustTry]}),n.highlights&&n.highlights.length>0&&e.jsx("div",{className:"exp-highlights",children:n.highlights.slice(0,3).map((q,te)=>e.jsxs("span",{className:"highlight-chip",children:["âœ“ ",q]},te))}),n.tip&&e.jsxs("div",{className:"exp-callout tip",children:[e.jsx("strong",{children:"ðŸ’¡"})," ",n.tip]}),n.momQuote&&e.jsxs("div",{className:"exp-mom-quote",children:['â¤ï¸ "',n.momQuote,'"']}),e.jsxs("div",{className:"exp-links-row",children:[n.website&&e.jsx("a",{href:n.website,target:"_blank",rel:"noopener noreferrer",className:"exp-link",children:"ðŸŒ Website"}),n.coordinates&&!n.private&&e.jsx("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${n.coordinates[0]},${n.coordinates[1]}`,target:"_blank",rel:"noopener noreferrer",className:"exp-link",children:"ðŸ—º Directions"}),n.yelpRating&&!n.private&&e.jsxs("a",{href:`https://www.yelp.com/search?find_desc=${encodeURIComponent(n.name)}&find_loc=${encodeURIComponent(n.location)}`,target:"_blank",rel:"noopener noreferrer",className:"exp-link yelp",title:`Yelp: ${n.yelpRating}/5`,children:[e.jsx("span",{style:{color:"#d32323"},children:"â—"})," Yelp"," ",n.yelpRating]}),n.googleRating&&!n.private&&e.jsxs("a",{href:`https://www.google.com/maps/search/${encodeURIComponent(n.name+" "+n.location)}`,target:"_blank",rel:"noopener noreferrer",className:"exp-link google",title:`Google: ${n.googleRating}/5`,children:[e.jsx("span",{style:{color:"#4285f4"},children:"â—"})," Google"," ",n.googleRating]})]}),n.tags&&n.tags.length>0&&e.jsx("div",{className:"exp-tags",children:n.tags.map(q=>e.jsx("span",{className:"tag-pill",children:q},q))}),n.photoSpot&&e.jsxs("div",{className:"exp-photo-spot",children:["ðŸ“¸ Best shot: ",n.photoSpot]})]}),!ne&&e.jsxs("div",{className:"item-collapsed-actions",children:[n.mustTry&&e.jsxs("span",{className:"collapsed-hint",children:["ðŸ½ ",n.mustTry.substring(0,30),"..."]}),e.jsx("button",{type:"button",className:"ghost-btn-sm",onClick:()=>A(n),children:"Details â†’"})]})]},n.id)),o.trim()&&e.jsxs("div",{className:"web-search-promo",children:[e.jsx("p",{children:f.length===0?"No local matches.":"Not seeing it?"}),e.jsx("p",{className:"no-results",children:"Use the Custom tab to search places and add one."})]}),!o.trim()&&f.length===0&&e.jsx("p",{className:"no-results",children:"No activities match your filters."})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"custom-place-form",children:[e.jsx("h4",{children:"Add a place"}),e.jsx("p",{children:"Type a place name and pick a result."}),e.jsx("input",{type:"text",className:"search-input",placeholder:"Search places (e.g., Mike's Pastry Boston)",value:I,onChange:n=>F(n.target.value)}),T&&e.jsx("p",{className:"no-results",children:"Searchingâ€¦"}),!T&&I.trim()&&E.length===0&&e.jsx("p",{className:"no-results",children:"No results."}),E.length>0&&e.jsx("div",{className:"catalog-list",children:E.map(n=>e.jsxs("div",{className:"catalog-item custom-item",children:[e.jsxs("button",{type:"button",className:"item-main",onClick:()=>{ie&&(v({dayId:N?.id,name:Se(n.displayName)||I.trim(),location:_e(n.displayName),coordinates:n.coordinates}),he())},children:[e.jsx("span",{className:"item-icon",children:G.custom?.icon}),e.jsxs("div",{className:"item-info",children:[e.jsx("strong",{children:Se(n.displayName)||I.trim()}),e.jsx("small",{children:n.displayName})]})]}),e.jsx("div",{className:"item-actions",children:e.jsx("button",{className:"add-btn",type:"button",disabled:!ie,onClick:()=>{ie&&(v({dayId:N?.id,name:Se(n.displayName)||I.trim(),location:_e(n.displayName),coordinates:n.coordinates}),he())},children:"Add"})})]},n.id))})]}),e.jsxs("div",{className:"custom-activities-list",children:[e.jsx("h5",{children:"Your custom library"}),L.length===0&&e.jsx("p",{className:"no-results",children:"No custom places yet."}),L.map(n=>e.jsxs("div",{className:"catalog-item custom-item",children:[e.jsxs("button",{type:"button",className:"item-main",onClick:()=>A(n),children:[e.jsx("span",{className:"item-icon",children:G[n.category]?.icon||"*"}),e.jsxs("div",{className:"item-info",children:[e.jsx("strong",{children:n.name}),e.jsx("small",{children:n.location})]})]}),e.jsxs("div",{className:"item-actions",children:[e.jsx("button",{className:"add-btn",onClick:()=>M(N?.id,n.id),type:"button",children:"Add"}),e.jsx("button",{type:"button",className:"ghost-btn",onClick:()=>A(n),children:"Details"}),e.jsx("button",{type:"button",className:"ghost-btn",onClick:()=>R(n),children:"Delete"})]})]},n.id))]})]})]})}const Ae={name:"",location:"",address:"",category:"custom",description:"",duration:"",price:"",rating:"",notes:"",tags:"",website:"",phone:""};function zt({isOpen:t,onClose:a,onSave:o,initialData:l,days:p,defaultDayId:h}){if(!t)return null;const[d,y]=r.useState(Ae),[u,s]=r.useState(h||""),[f,N]=r.useState(!1),[M,A]=r.useState(!1),C=async k=>{const R=k||(d.location?`${d.name} ${d.location}`:d.name);if(R){A(!0);try{const I=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(R)}`)).json();if(I&&I.length>0){const F=I[0];y(E=>({...E,location:E.location||F.display_name.split(",")[0],coordinates:[Number(F.lat),Number(F.lon)]}))}else k||alert("No location found for this name.")}catch(L){console.error(L),k||alert("Search failed.")}finally{A(!1)}}};r.useEffect(()=>{const k=l?{...Ae,...l,tags:Array.isArray(l.tags)?l.tags.join(", "):l.tags||""}:Ae;if(y(k),s(h||p?.[0]?.id||""),l?.name&&!l.coordinates&&!l.location){const R=setTimeout(()=>C(l.name),100);return()=>clearTimeout(R)}},[t,l,h,p]);const v=r.useMemo(()=>Object.values(G).filter(k=>k.id!=="city"),[]),g=k=>R=>{y(L=>({...L,[k]:R.target.value}))},b=async()=>{if(d.name.trim()){N(!0);try{await o({...d,duration:d.duration?Number(d.duration):null,rating:d.rating?Number(d.rating):null,tags:d.tags?d.tags.split(",").map(k=>k.trim()).filter(Boolean):[],dayId:u}),a()}finally{N(!1)}}};return e.jsx("div",{className:"modal-overlay",onClick:a,role:"presentation",children:e.jsxs("div",{className:"modal modal-wide",role:"dialog","aria-modal":"true",onClick:k=>k.stopPropagation(),children:[e.jsxs("header",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsx("span",{className:"modal-eyebrow",children:"Custom place"}),e.jsx("h2",{children:l?"Edit custom place":"Add a custom place"}),e.jsx("p",{children:"Save the details you actually need while planning."})]}),e.jsx("button",{type:"button",className:"icon-btn",onClick:a,"aria-label":"Close custom place",children:"x"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"modal-grid",children:[e.jsxs("label",{children:["Place name",e.jsx("input",{value:d.name,onChange:g("name"),placeholder:"e.g., Mike's Pastry"})]}),e.jsxs("label",{children:["Location",e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("input",{style:{flex:1},value:d.location,onChange:g("location"),placeholder:"e.g., Boston, MA"}),e.jsx("button",{type:"button",className:"btn-outline",onClick:()=>C(),disabled:M,children:M?"...":"ðŸ”"})]})]}),e.jsxs("label",{className:"span-2",children:["Address (optional)",e.jsx("input",{value:d.address,onChange:g("address"),placeholder:"Full address for directions"})]}),e.jsxs("label",{children:["Phone (optional)",e.jsx("input",{value:d.phone,onChange:g("phone"),placeholder:"(207) 555-1234"})]}),e.jsxs("label",{children:["Category",e.jsx("select",{value:d.category,onChange:g("category"),children:v.map(k=>e.jsxs("option",{value:k.id,children:[k.icon," ",k.name]},k.id))})]}),e.jsxs("label",{children:["Duration (hours)",e.jsx("input",{value:d.duration,onChange:g("duration"),placeholder:"1.5"})]}),e.jsxs("label",{children:["Price range",e.jsx("input",{value:d.price,onChange:g("price"),placeholder:"$$"})]}),e.jsxs("label",{children:["Rating",e.jsx("input",{value:d.rating,onChange:g("rating"),placeholder:"4.8"})]}),e.jsxs("label",{className:"span-2",children:["Description",e.jsx("textarea",{value:d.description,onChange:g("description"),placeholder:"Why this place matters"})]}),e.jsxs("label",{className:"span-2",children:["Notes",e.jsx("textarea",{value:d.notes,onChange:g("notes"),placeholder:"Reservations, parking tips, best time to go"})]}),e.jsxs("label",{className:"span-2",children:["Tags (comma separated)",e.jsx("input",{value:d.tags,onChange:g("tags"),placeholder:"lobster, sunset, photo"})]}),e.jsxs("label",{className:"span-2",children:["Website or booking link",e.jsx("input",{value:d.website,onChange:g("website"),placeholder:"https://"})]})]})}),e.jsxs("div",{className:"modal-actions",children:[e.jsxs("div",{className:"day-select",children:[e.jsx("label",{htmlFor:"day-select-custom",children:"Add to day"}),e.jsx("select",{id:"day-select-custom",value:u,onChange:k=>s(k.target.value),children:p.map(k=>e.jsxs("option",{value:k.id,children:["Day ",k.dayNumber,": ",k.location||k.label]},k.id))})]}),e.jsx("button",{type:"button",className:"btn-outline",onClick:a,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:b,disabled:f,children:f?"Saving...":"Save place"})]})]})})}function Gt({activity:t,onOpenDetails:a}){const{attributes:o,listeners:l,setNodeRef:p,transform:h,transition:d,isDragging:y}=nt({id:t.id}),u={transform:it.Transform.toString(h),transition:d,opacity:y?.6:1};return e.jsxs("div",{ref:p,style:u,className:"board-card",children:[e.jsxs("button",{type:"button",className:"activity-main",onClick:()=>a(t),children:[e.jsx("span",{className:"activity-icon",children:G[t.category]?.icon||"*"}),e.jsxs("div",{className:"activity-info",children:[e.jsx("strong",{children:t.name}),e.jsx("small",{children:t.location})]})]}),e.jsx("button",{type:"button",className:"drag-handle",...o,...l,"aria-label":"Drag",children:"::"})]})}function Qt({day:t,activities:a,selectedDayId:o,onSelectDay:l,onOpenDetails:p}){const h=`day:${t.id}`,{setNodeRef:d}=Nt({id:h});return e.jsxs("section",{className:`board-column ${t.id===o?"active":""}`,onClick:()=>l(t.id),children:[e.jsxs("header",{className:"board-column-header",children:[e.jsxs("div",{children:[e.jsxs("h4",{children:["Day ",t.dayNumber]}),e.jsx("p",{children:t.location||t.label})]}),e.jsx("span",{className:"board-count",children:a.length})]}),e.jsx("div",{className:"board-list",ref:d,children:e.jsxs(ot,{items:a.map(y=>y.id),strategy:st,children:[a.length===0&&e.jsx("p",{className:"board-empty",children:"Drop activities here."}),a.map(y=>e.jsx(Gt,{activity:y,onOpenDetails:p},y.id))]})})]})}function Jt({trip:t,selectedDayId:a,onSelectDay:o,getActivity:l,onUpdateTripDays:p,onOpenDetails:h}){const d=r.useMemo(()=>t.days.reduce((u,s)=>(u[s.id]=s.activities.map(f=>l(f)).filter(Boolean),u),{}),[t.days,l]),y=(u,s)=>typeof u=="string"&&u.startsWith("day:")?u.replace("day:",""):s.find(f=>f.activities.includes(u))?.id;return e.jsx("div",{className:"board-view",children:e.jsx(et,{collisionDetection:tt,onDragEnd:({active:u,over:s})=>{s&&u.id!==s.id&&p(f=>{const N=f.days.map(b=>({...b,activities:[...b.activities],schedule:b.schedule?{...b.schedule}:{}})),M=y(u.id,N),A=y(s.id,N);if(!M||!A)return f;const C=N.find(b=>b.id===M),v=N.find(b=>b.id===A);if(!C||!v)return f;const g=C.activities.indexOf(u.id);if(g<0)return f;if(M===A){const b=v.activities.indexOf(s.id);if(b<0)return f;C.activities=at(C.activities,g,b)}else{C.activities.splice(g,1);const b=v.activities.indexOf(s.id),k=b>=0?b:v.activities.length;v.activities.splice(k,0,u.id),C.schedule?.[u.id]&&(v.schedule=v.schedule||{},v.schedule[u.id]=C.schedule[u.id],delete C.schedule[u.id])}return{...f,days:N}})},children:e.jsx("div",{className:"board-grid",children:t.days.map(u=>e.jsx(Qt,{day:u,activities:d[u.id]||[],selectedDayId:a,onSelectDay:o,onOpenDetails:h},u.id))})})})}const Xt=[{value:"arrival",label:"Arrival"},{value:"drive",label:"Drive day"},{value:"explore",label:"Explore"},{value:"relaxed",label:"Relaxed"},{value:"departure",label:"Departure"},{value:"custom",label:"Custom"}];function Zt({activity:t,index:a,dayId:o,onRemove:l,onOpenDetails:p}){const{attributes:h,listeners:d,setNodeRef:y,transform:u,transition:s,isDragging:f}=nt({id:t.id}),N={transform:it.Transform.toString(u),transition:s,opacity:f?.6:1};return e.jsxs("div",{ref:y,style:N,className:`activity-card ${t.isCustom?"custom":""}`,children:[e.jsx("span",{className:"activity-order",children:a+1}),e.jsx("button",{className:"drag-handle",type:"button","aria-label":"Drag to reorder",...h,...d,children:"::"}),e.jsxs("button",{type:"button",className:"activity-main",onClick:()=>p(t),children:[e.jsx("span",{className:"activity-icon",children:G[t.category]?.icon??"*"}),e.jsxs("div",{className:"activity-info",children:[e.jsxs("strong",{children:[t.name,t.momMentioned&&e.jsx("span",{className:"mom-badge",children:"*"})]}),e.jsx("small",{children:t.location})]})]}),e.jsx("button",{className:"remove-btn",onClick:()=>l(o,t.id),type:"button",children:"x"})]})}function ea({trip:t,selectedDay:a,selectedDayId:o,selectedDayActivities:l,selectedDayActivityIds:p,dayRoute:h,dayLoad:d,dayLoadLabel:y,onSelectDay:u,onAddDay:s,onRemoveDay:f,onDuplicateDay:N,onUpdateDay:M,onReorderActivities:A,onRemoveActivity:C,onOpenDetails:v}){return e.jsxs("section",{className:"trip-builder",children:[e.jsxs("div",{className:"day-tabs",children:[t.days.map(g=>e.jsxs("button",{className:`day-tab ${g.id===o?"active":""}`,onClick:()=>u(g.id),type:"button",children:[e.jsxs("span",{className:"day-num",children:["D",g.dayNumber]}),e.jsx("span",{className:"day-loc",children:g.location||"..."}),e.jsx("span",{className:"day-count",children:g.activities.length})]},g.id)),e.jsx("button",{className:"add-day-btn",onClick:s,type:"button",children:"+"})]}),a&&e.jsxs("div",{className:"day-content",children:[e.jsxs("div",{className:"day-header",children:[e.jsxs("div",{children:[e.jsxs("h2",{children:["Day ",a.dayNumber]}),e.jsxs("p",{className:"day-load",children:[y," | ",d]})]}),e.jsxs("div",{className:"day-actions",children:[e.jsx("select",{value:a.type||"custom",onChange:g=>M(a.id,{type:g.target.value}),className:"day-type-select",children:Xt.map(g=>e.jsx("option",{value:g.value,children:g.label},g.value))}),e.jsx("button",{type:"button",className:"ghost-btn",onClick:()=>N(a.id),children:"Duplicate"}),t.days.length>1&&e.jsx("button",{type:"button",className:"ghost-btn",onClick:()=>f(a.id),children:"Remove"})]})]}),e.jsxs("label",{className:"field",children:["Day location (optional)",e.jsx("input",{type:"text",value:a.location,onChange:g=>M(a.id,{location:g.target.value}),placeholder:"City / area (e.g., Portland, ME)",className:"location-input"})]}),e.jsx("textarea",{value:a.notes,onChange:g=>M(a.id,{notes:g.target.value}),placeholder:"Notes for this day: reservations, timing, backup options",className:"day-notes"}),e.jsxs("div",{className:"activities-list",children:[e.jsxs("h3",{children:["Activities (",l.length,")"]}),l.length===0?e.jsx("p",{className:"empty-msg",children:"Add activities from the catalog or your custom list."}):e.jsx(et,{collisionDetection:tt,onDragEnd:({active:g,over:b})=>{if(!b||g.id===b.id)return;const k=p.indexOf(g.id),R=p.indexOf(b.id);k<0||R<0||A(a.id,k,R)},children:e.jsx(ot,{items:p,strategy:st,children:l.map((g,b)=>e.jsx(Zt,{activity:g,index:b,dayId:a.id,onRemove:C,onOpenDetails:v},g.id))})}),e.jsxs("div",{className:"drive-summary",children:[e.jsxs("div",{className:"drive-header",children:[e.jsx("h3",{children:"Driving"}),!h&&e.jsx("span",{className:"drive-meta",children:"Add two or more pinned stops."})]}),h?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"drive-totals",children:["Total: ",e.jsx("strong",{children:Ne(h.distance_m)})," |"," ",e.jsx("strong",{children:we(h.duration_s)})]}),h.legs?.length>0&&e.jsx("div",{className:"drive-legs",children:h.legs.map((g,b)=>e.jsxs("div",{className:"drive-leg",children:[e.jsxs("span",{className:"drive-leg-title",children:[g.from," -> ",g.to]}),e.jsxs("span",{className:"drive-leg-meta",children:[Ne(g.distance_m)," |"," ",we(g.duration_s)]})]},b))})]}):e.jsx("div",{className:"drive-empty",children:"No driving route yet."})]})]})]})]})}function ta({bounds:t}){const a=Ze();return r.useEffect(()=>{!t||t.length<1||a.fitBounds(t,{paddingTopLeft:[32,80],paddingBottomRight:[32,32]})},[a,t]),null}const Te={standard:{name:"Standard",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attr:"&copy; OpenStreetMap"},light:{name:"Light",url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attr:"&copy; OpenStreetMap &copy; CARTO"},dark:{name:"Dark",url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attr:"&copy; OpenStreetMap &copy; CARTO"},terrain:{name:"Terrain",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attr:"Tiles &copy; Esri"}};function aa({mapActivities:t,dayRoutes:a,selectedDayId:o,selectedDayBounds:l,tripRouteTotals:p,routesLoading:h,routesError:d,costPerMile:y,onCostChange:u,estimatedTripCost:s,onResetTrip:f,googleMapsUrl:N,weatherUrl:M}){const[v,g]=r.useState("light"),[b,k]=r.useState(450),[R,L]=r.useState(!1),I=r.useRef(null),F=r.useRef(0),E=r.useRef(0),w=r.useRef(null),T=b>=600;r.useEffect(()=>{const j=V=>{if(!R)return;const W=F.current-V.clientX,$=Math.max(360,Math.min(720,E.current+W));k($)},D=()=>{L(!1)};return R?(document.addEventListener("mousemove",j),document.addEventListener("mouseup",D),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",D),document.body.style.cursor="",document.body.style.userSelect=""}},[R]);const _=j=>{j.preventDefault(),L(!0),F.current=j.clientX,E.current=b};return r.useEffect(()=>{if(!w.current)return;const j=w.current;requestAnimationFrame(()=>{j.invalidateSize()})},[b]),r.useEffect(()=>{if(!I.current||!w.current)return;const j=w.current,D=new ResizeObserver(()=>{requestAnimationFrame(()=>{j.invalidateSize()})});return D.observe(I.current),()=>D.disconnect()},[]),r.useEffect(()=>{if(!w.current||!t||t.length===0)return;const D=t[t.length-1]?.coordinates;if(!Array.isArray(D)||D.length<2)return;const V=w.current;requestAnimationFrame(()=>{V.setView(D,Math.max(V.getZoom(),11))})},[t]),e.jsxs("aside",{className:"map-panel",ref:I,style:{width:`${b}px`,minWidth:"360px",maxWidth:"720px",position:"relative"},children:[e.jsx("div",{className:"map-resize-handle",onMouseDown:_,role:"separator","aria-label":"Resize map panel"}),e.jsxs("div",{className:"map-header",children:[e.jsxs("div",{className:"map-title",children:[e.jsx("h3",{children:"Trip map"}),T?e.jsxs("div",{className:"map-metrics-expanded",children:[e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{className:"metric-label",children:"Activities"}),e.jsxs("span",{className:"metric-value",children:[t.length," pins"]})]}),e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{className:"metric-label",children:"Trip Distance"}),e.jsx("span",{className:"metric-value",children:Ne(p.distance_m)})]}),e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{className:"metric-label",children:"Drive Time"}),e.jsx("span",{className:"metric-value",children:we(p.duration_s)})]}),s!=null&&e.jsxs("div",{className:"metric-item",children:[e.jsx("span",{className:"metric-label",children:"Estimated Cost"}),e.jsx("span",{className:"metric-value",children:$e(s)})]}),h&&e.jsx("div",{className:"metric-item status",children:e.jsx("span",{className:"metric-value",children:"Calculating routes..."})}),d&&e.jsx("div",{className:"metric-item status error",children:e.jsx("span",{className:"metric-value",children:d})})]}):e.jsxs("div",{className:"map-metrics",children:[e.jsxs("span",{className:"map-stat",children:[t.length," pins"]}),e.jsxs("span",{className:"map-stat",children:["Trip: ",Ne(p.distance_m)," |"," ",we(p.duration_s)]}),s!=null&&e.jsxs("span",{className:"map-stat",children:["Est: ",$e(s)]}),h&&e.jsx("span",{className:"map-stat",children:"Calculating routes..."}),d&&e.jsx("span",{className:"map-stat error",children:d})]})]}),e.jsxs("div",{className:`map-controls ${T?"expanded":""}`,children:[e.jsx("select",{className:"style-select",value:v,onChange:j=>g(j.target.value),"aria-label":"Map style",children:Object.entries(Te).map(([j,D])=>e.jsxs("option",{value:j,children:[D.name," Map"]},j))}),e.jsxs("label",{className:"cost-input",children:[T&&e.jsx("span",{className:"input-label",children:"Cost per mile"}),e.jsx("span",{className:"input-prefix",children:"$/mi"}),e.jsx("input",{value:y,onChange:j=>u(j.target.value),inputMode:"decimal",placeholder:"0.00"})]}),N&&e.jsx("a",{className:"btn-primary btn-sm",href:N,target:"_blank",rel:"noreferrer",children:"Navigate Day â†—"}),M&&e.jsx("a",{className:"ghost-btn",href:M,target:"_blank",rel:"noreferrer",children:"Forecast â†—"})]})]}),e.jsx("div",{className:"map-container",children:e.jsxs(ze,{center:[43.5,-71.5],zoom:7,style:{height:"100%",width:"100%"},whenCreated:j=>{w.current=j},children:[l&&e.jsx(ta,{bounds:l}),e.jsx(Ge,{url:Te[v].url,attribution:Te[v].attr}),Object.values(a).map(j=>e.jsx(Qe,{positions:j.line,pathOptions:{color:Mt(j.dayNumber),weight:j.dayId===o?5:3,opacity:j.dayId===o?.9:.35}},`route-${j.dayId}`)),t.map((j,D)=>e.jsx(Je,{position:j.coordinates,children:e.jsxs(Xe,{children:[e.jsxs("strong",{children:["Day ",j.dayNumber,": ",j.name]}),e.jsx("br",{}),j.location]})},`${j.id}-${D}`))]},`map-${Math.round(b)}`)})]})}const We="mmt-cost-per-mile";function oa({trip:t,setTrip:a,customActivities:o,setCustomActivities:l}){const[p,h]=r.useState(t.days[0]?.id||"day-1"),[d,y]=r.useState("catalog"),[u,s]=r.useState("all"),[f,N]=r.useState("all"),[M,A]=r.useState(""),[C,v]=r.useState(!1),[g,b]=r.useState(null),[k,R]=r.useState(null),[L,I]=r.useState("day"),[F,E]=r.useState(()=>{try{return localStorage.getItem(We)||""}catch{return""}});r.useEffect(()=>{try{localStorage.setItem(We,F)}catch{}},[F]),r.useEffect(()=>{t.days.length&&(t.days.find(c=>c.id===p)||h(t.days[0].id))},[t.days,p]);const w=r.useMemo(()=>t.days.find(c=>c.id===p)||t.days[0],[t.days,p]),T=r.useCallback(c=>Ee(c)||o[c]||null,[o]),_=r.useMemo(()=>w?w.activities.map(c=>T(c)).filter(Boolean):[],[w,T]),j=r.useMemo(()=>{const c=[];t?.startLocation&&c.push(t.startLocation),t?.endLocation&&c.push(t.endLocation),(t?.days||[]).forEach(m=>{m?.location&&c.push(m.location),m?.label&&c.push(m.label)}),Object.values(o||{}).forEach(m=>{m?.location&&c.push(m.location)});const i=new Set;return c.forEach(m=>{Ht(m).forEach(x=>i.add(x))}),i.size===0?[]:_t(Array.from(i))},[t?.startLocation,t?.endLocation,t?.days,o]),D=r.useMemo(()=>{const c=[];t?.startLocation&&c.push(t.startLocation),t?.endLocation&&c.push(t.endLocation),(t?.days||[]).forEach(m=>{m?.location&&c.push(m.location),m?.label&&c.push(m.label),m?.notes&&c.push(m.notes)});const i=c.join(" ").toLowerCase();return i.includes("canada")||i.includes("montreal")||i.includes("quÃ©bec")||i.includes("quebec")||i.includes(" qc")||i.includes(",qc")},[t?.startLocation,t?.endLocation,t?.days]),V=r.useMemo(()=>w?.activities||[],[w]),W=r.useMemo(()=>{let c=rt.filter(i=>i.category!=="city"&&i.category!=="lodging");if(u!=="all"&&(c=c.filter(i=>i.category===u)),f!=="all"&&(c=c.filter(i=>i.region===f)),C&&(c=c.filter(i=>i.momMentioned)),M.trim()){const i=M.toLowerCase();c=c.filter(m=>m.name.toLowerCase().includes(i)||m.location?.toLowerCase().includes(i)||m.description?.toLowerCase().includes(i)||m.tags?.some(x=>x.toLowerCase().includes(i)))}return c},[u,f,C,M]),$=r.useCallback((c,i)=>{c&&a(m=>({...m,days:m.days.map(x=>x.id!==c||x.activities.includes(i)?x:{...x,activities:[...x.activities,i]})}))},[a]),Q=r.useCallback((c,i)=>{a(m=>({...m,days:m.days.map(x=>{if(x.id!==c)return x;const S={...x.schedule||{}};return delete S[i],{...x,activities:x.activities.filter(O=>O!==i),schedule:S}})}))},[a]),J=r.useCallback((c,i,m)=>{i!==m&&a(x=>({...x,days:x.days.map(S=>S.id!==c?S:{...S,activities:at(S.activities,i,m)})}))},[a]),me=r.useCallback((c,i)=>{a(m=>({...m,days:m.days.map(x=>x.id===c?{...x,...i}:x)}))},[a]),ne=r.useCallback((c,i,m)=>{a(x=>({...x,days:x.days.map(S=>{if(S.id!==c)return S;const O={...S.schedule||{}},H=O[i]||{},z={...m};if(z.duration!==void 0){const Z=Number(z.duration);z.duration=Number.isFinite(Z)?Z:0}if(z.bufferMinutes!==void 0){const Z=Number(z.bufferMinutes);z.bufferMinutes=Number.isFinite(Z)?Z:0}return O[i]={...H,...z},{...S,schedule:O}})}))},[a]),ie=r.useCallback(c=>{a(i=>({...i,days:i.days.map(m=>{if(m.id!==c)return m;const x=m.activities.map(H=>T(H)).filter(Boolean),S=m.startTime||"09:00",O=Lt({activities:x,startTime:S,bufferMinutes:20});return{...m,schedule:O,startTime:S}})}))},[T,a]),ke=r.useCallback(()=>{a(c=>{const i=c.days.length+1;return{...c,days:[...c.days,{id:`day-${i}`,dayNumber:i,label:`Day ${i}`,location:"",activities:[],notes:"",type:"explore",lodging:null,startTime:"09:00",schedule:{}}]}})},[a]),he=r.useCallback(c=>{t.days.length<=1||a(i=>({...i,days:He(i.days.filter(m=>m.id!==c))}))},[t.days.length,a]),n=r.useCallback(c=>{a(i=>{const m=i.days.findIndex(O=>O.id===c);if(m<0)return i;const x={...i.days[m],activities:[...i.days[m].activities],schedule:i.days[m].schedule?{...i.days[m].schedule}:{}},S=[...i.days];return S.splice(m+1,0,x),{...i,days:He(S)}})},[a]),q=r.useCallback(()=>{window.confirm("Clear the entire trip builder?")&&(a(Ot({name:"My Custom Trip",startLocation:"",endLocation:"",dayCount:5,style:"balanced"})),h("day-1"))},[a]),te=r.useCallback(async({dayId:c,name:i,location:m,coordinates:x})=>{const S=String(i||"").trim();if(!S)return;const O=String(m||"").trim(),H=`custom-${Date.now()}`,z=`${S} ${O||"New England"}`.trim();let Z=Array.isArray(x)?x:null;if(!Z)try{Z=await De(z)}catch{}const yt={id:H,name:S,location:O,category:"custom",description:"",duration:null,price:"",rating:null,notes:"",tags:[],website:"",momMentioned:!1,isCustom:!0,source:"custom",coordinates:Z,googleMapsUrl:`https://www.google.com/maps/search/${encodeURIComponent(z)}`};l(xt=>({...xt,[H]:yt})),c&&$(c,H)},[$,l]),X=r.useCallback(c=>{window.confirm("Delete this custom place everywhere?")&&(l(i=>{const m={...i};return delete m[c.id],m}),a(i=>({...i,days:i.days.map(m=>({...m,activities:m.activities.filter(x=>x!==c.id)}))})),g?.id===c.id&&b(null))},[g,l,a]),se=r.useCallback(c=>{R(c),b(null)},[]),ae=r.useCallback(c=>{const i=k;if(!i)return;const m=i.isCustom?i.id:`custom-${i.id}`,x={...i,...c,id:m,isCustom:!0,momMentioned:i.momMentioned,momQuote:i.momQuote,private:i.private};l(S=>({...S,[m]:x})),!i.isCustom&&i.id!==m&&a(S=>({...S,days:S.days.map(O=>({...O,activities:O.activities.map(H=>H===i.id?m:H)}))})),R(null)},[k,l,a]),re=r.useCallback(c=>(c?.activities||[]).map(i=>T(i)).filter(i=>i?.category!=="city").filter(i=>i?.coordinates&&Array.isArray(i.coordinates)).map(i=>({id:i.id,name:i.name,coordinates:i.coordinates})),[T]),{dayRoutes:le,routesLoading:Me,routesError:pe,baseCoordsByLabel:ee}=Tt({trip:t,getActivityWaypoints:re}),ge=le[p]||null,fe=r.useMemo(()=>{let c=0,i=0;return Object.values(le).forEach(m=>{c+=m?.distance_m||0,i+=m?.duration_s||0}),{distance_m:c,duration_s:i}},[le]),P=r.useMemo(()=>{const c=Number(String(F).trim());return Number.isFinite(c)&&c>0?c:null},[F]),K=fe.distance_m/1609.344,U=P?K*P:null,Y=r.useMemo(()=>{const c=[];return t.days.forEach(i=>{i.activities.forEach(m=>{const x=T(m);x?.coordinates&&x?.category!=="city"&&c.push({...x,dayNumber:i.dayNumber})})}),c},[t.days,T]),ce=r.useMemo(()=>t.days.findIndex(c=>c.id===p),[t.days,p]),de=r.useMemo(()=>{if(!w)return null;const c=w?.type==="drive",i=(w?.location||"").trim()||null,m=ce>0?(t.days[ce-1]?.location||"").trim():null,x=c?m:i,S=[];return x&&ee[x]&&S.push(ee[x]),S.push(...re(w).map(O=>O.coordinates)),c&&i&&ee[i]&&i!==x&&S.push(ee[i]),S.length?S:null},[w,ce,t.days,ee,re]),ut=r.useMemo(()=>{if(!de||de.length===0)return null;let c=0,i=0,m=0;return de.forEach(x=>{if(!Array.isArray(x)||x.length<2)return;const S=Number(x[0]),O=Number(x[1]);!Number.isFinite(S)||!Number.isFinite(O)||(c+=S,i+=O,m+=1)}),m===0?null:[c/m,i/m]},[de]),mt=r.useMemo(()=>{if(!w)return null;const c=H=>H.coordinates&&Array.isArray(H.coordinates)?`${H.coordinates[0]},${H.coordinates[1]}`:`${H.name} ${H.location||""}`.trim(),i=_;if(i.length===0&&!w.location)return null;let m=w.location||"";i.length>0&&(m=c(i[0]));let x=w.location||"";i.length>0&&(x=c(i[i.length-1]));const S=i.length>2?i.slice(1,-1).map(c):[],O=new URLSearchParams({api:"1",origin:m,destination:x,travelmode:"driving"});return S.length&&O.set("waypoints",S.join("|")),`https://www.google.com/maps/dir/?${O.toString()}`},[w,_]),ht=r.useMemo(()=>w?.location?`https://www.google.com/search?q=${encodeURIComponent(`weather ${w.location}`)}`:null,[w]),pt=w?.schedule||{},gt=_.reduce((c,i)=>{const m=pt[i.id]?.duration??i.duration??0;return c+(Number(m)||0)},0),ft=ge?ge.duration_s/3600:0,ue=gt+ft;let be="Easy day";ue>=9?be="Ambitious day":ue>=7?be="Full day":ue>=5&&(be="Balanced day");const bt=ue>0?`Est. ${je(ue)}`:"No timing yet";return e.jsxs("div",{className:"builder-layout",children:[e.jsx(Kt,{searchMode:d,onModeChange:y,searchQuery:M,onSearchChange:A,catalogFilter:u,onFilterChange:s,regionFilter:f,onRegionFilterChange:N,showMomOnly:C,onToggleMomOnly:v,filteredCatalog:W,selectedDay:w,onAddActivity:$,onOpenDetails:b,customActivities:o,onQuickAddCustomPlace:te,allowedStateAbbrs:j,allowCanadaPlaces:D,placeSearchCenter:ut,onDeleteCustom:X}),e.jsxs("div",{className:"planner-column",children:[e.jsxs("div",{className:"planner-view-toggle",children:[e.jsx("button",{type:"button",className:`mode-btn ${L==="day"?"active":""}`,onClick:()=>I("day"),children:"Focused Day"}),e.jsx("button",{type:"button",className:`mode-btn ${L==="board"?"active":""}`,onClick:()=>I("board"),children:"All Days Board"})]}),L==="day"?e.jsx(ea,{trip:t,selectedDay:w,selectedDayId:p,selectedDayActivities:_,selectedDayActivityIds:V,dayRoute:ge,dayLoad:bt,dayLoadLabel:be,onSelectDay:h,onAddDay:ke,onRemoveDay:he,onDuplicateDay:n,onUpdateDay:me,onUpdateSchedule:ne,onAutoSchedule:ie,onReorderActivities:J,onRemoveActivity:Q,onOpenDetails:b}):e.jsx(Jt,{trip:t,selectedDayId:p,onSelectDay:h,getActivity:T,onUpdateTripDays:a,onOpenDetails:b})]}),e.jsx(aa,{mapActivities:Y,dayRoutes:le,selectedDayId:p,selectedDayBounds:de,tripRouteTotals:fe,routesLoading:Me,routesError:pe,costPerMile:F,onCostChange:E,estimatedTripCost:U,onResetTrip:q,googleMapsUrl:mt,weatherUrl:ht}),g&&e.jsx(Vt,{activity:g,days:t.days,selectedDayId:p,onClose:()=>b(null),onAddToDay:$,onRemoveFromDay:Q,onEditCustom:se,onDeleteCustom:X}),k&&e.jsx(zt,{isOpen:!0,onClose:()=>R(null),onSave:ae,initialData:k,days:t.days,defaultDayId:p})]})}const lt=[{id:"moms-original",name:"Mom's Original Route",emoji:"ðŸ’•",source:"MMTrip.txt",description:"The full experienceâ€”coast, mountains, city, and countryside. Based on Tere's original planning document.",duration:"7-9 days",totalMiles:"~780 miles",driveTime:"~16 hours total",flyIn:"Boston (BOS)",flyOut:"Albany (ALB)",vibe:"Classic road trip with flexibility built in",bestFor:["First-timers","Want it all","Full experience"],countries:["USA","Canada"],states:["MA","NH","ME","VT","QC","NY"],days:[{dayNumber:1,label:"Arrive Boston",location:"Boston, MA",type:"arrival",notes:"Use arrival day and perhaps next day for touring the city and eating some LOBSTA!",suggestedActivities:["landmark-freedom-trail","lobster-neptune"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:2,label:"Boston Exploration",location:"Boston, MA",type:"explore",notes:"The city is FULL of history, of course.",suggestedActivities:["landmark-freedom-trail"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:3,label:"Coastal Drive to Portland",location:"Portland, ME",type:"drive",driveTime:"2-3.5 hours (depending on route)",notes:"Drive up the coast to Portlandâ€”stay 1 night. Take Route 1 for harbor towns!",suggestedActivities:["drive-route-1-coast","town-ogunquit","town-kennebunkport","lobster-clam-shack","lobster-chauncey","town-portland-old-port"],lodging:"lodge-press-portland",flexible:!0},{dayNumber:4,label:"Mountains & Vermont",location:"Chelsea, VT",type:"drive",driveTime:"3.5-4 hours (with stops)",notes:"Through the Kancamagus Highway to Sally's Vermont property.",suggestedActivities:["drive-kancamagus","hike-sabbaday-falls","foliage-hancock-overlook","landmark-albany-covered-bridge","hike-sallys-property"],lodging:"lodge-sallys",flexible:!0},{dayNumber:5,label:"Vermont Day",location:"Chelsea, VT",type:"explore",notes:"We can do some serious walking/hiking just on Sally's property alone.",suggestedActivities:["hike-sallys-property","foliage-chelsea-vermont"],lodging:"lodge-sallys",flexible:!0},{dayNumber:6,label:"Vermont to Montreal",location:"Montreal, QC",type:"drive",driveTime:"2.5-3 hours (with Burlington stop)",notes:"No specific plans for Burlington, just a nice stopping place. Explore Montreal.",suggestedActivities:["food-cold-hollow","food-ben-jerrys","landmark-notre-dame"],lodging:"lodge-petit-montreal",flexible:!0},{dayNumber:7,label:"Montreal Exploration",location:"Montreal, QC",type:"explore",notes:"Explore Montreal. Bagels, smoked meat, Mount Royal, poutine!",suggestedActivities:["food-st-viateur","food-schwartzs","hike-mount-royal","landmark-notre-dame","food-la-banquise"],lodging:"lodge-petit-montreal",flexible:!0},{dayNumber:8,label:"Adirondacks to Saratoga",location:"Saratoga Springs, NY",type:"drive",driveTime:"~4 hours (with Lake Placid detour)",notes:"Drive to Saratoga Springs via Lake Placid (optional). Fly out of Albany.",suggestedActivities:["foliage-lake-placid","drive-whiteface"],lodging:"lodge-adelphi-saratoga",flexible:!0},{dayNumber:9,label:"Departure",location:"Albany, NY",type:"departure",notes:"Fly home from Albanyâ€”or drive back east toward Stockbridge/Boston.",suggestedActivities:[],flexible:!0}],alternatives:[{name:"Berkshires Finish",description:"Continue to Stockbridge, MA for Ice Glen & Laura's Tower hikes before returning to Boston",modifiesDay:8,activities:["hike-ice-glen"],flyOut:"Boston (BOS)"},{name:"Finger Lakes Extension",description:"Explore the Finger Lakes area for wineries and waterfalls",addsDays:1,activities:[],flyOut:"Albany (ALB)"}]},{id:"coastal-lobster",name:"Coastal Lobster Focus",emoji:"ðŸ¦ž",source:"research",description:"More time on the Maine coast, maximize lobster consumption, skip the Montreal detour.",duration:"6-7 days",totalMiles:"~450 miles",driveTime:"~10 hours total",flyIn:"Boston (BOS)",flyOut:"Boston (BOS)",vibe:"Slow and savory, harbor-hopping",bestFor:["Lobster lovers","Coastal vibes","Less driving"],countries:["USA"],states:["MA","NH","ME","VT"],days:[{dayNumber:1,label:"Arrive Boston",location:"Boston, MA",type:"arrival",notes:"Arrive and immediately get lobster at Neptune Oyster.",suggestedActivities:["lobster-neptune"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:2,label:"Southern Maine Coast",location:"Boston â†’ Kennebunkport, ME",type:"drive",driveTime:"1.5-2.5 hours",notes:"Take the slow coastal Route 1, hit every harbor town.",suggestedActivities:["town-portsmouth","lobster-chauncey","town-ogunquit","hike-marginal-way","town-kennebunkport","lobster-clam-shack"],flexible:!0},{dayNumber:3,label:"Portland Food Day",location:"Kennebunkport â†’ Portland, ME",type:"drive",driveTime:"30 min",notes:"All the lobster spots, all the foodie destinations.",suggestedActivities:["lobster-eventide","town-portland-old-port","food-duckfat","lobster-highroller","landmark-portland-head-light","lobster-bite-into"],lodging:"lodge-press-portland",flexible:!0},{dayNumber:4,label:"Northern Maine Coast",location:"Portland â†’ Camden, ME",type:"drive",driveTime:"2 hours",notes:"Optional extension north for McLoons and Camden.",suggestedActivities:["lobster-mcloons","town-camden","hike-mount-battie"],flexible:!0},{dayNumber:5,label:"Mountains & Vermont",location:"Camden â†’ Chelsea, VT",type:"drive",driveTime:"4 hours",notes:"Cut across to Vermont for fall colors.",suggestedActivities:["drive-kancamagus","hike-sallys-property"],lodging:"lodge-sallys",flexible:!0},{dayNumber:6,label:"Return to Boston",location:"Chelsea â†’ Boston, MA",type:"drive",driveTime:"2.5 hours",notes:"Head back to Boston for departure.",suggestedActivities:[],flexible:!0},{dayNumber:7,label:"Departure",location:"Boston, MA",type:"departure",notes:"Fly home from Boston.",suggestedActivities:[],flexible:!0}],alternatives:[]},{id:"foliage-chaser",name:"Foliage Chaser Route",emoji:"ðŸ",source:"research",description:"Optimized for peak fall colors. Chase the foliage up the mountains.",duration:"6-7 days",totalMiles:"~600 miles",driveTime:"~12 hours total",flyIn:"Boston (BOS)",flyOut:"Albany (ALB)",vibe:"Leaf-peeping paradise, hiking focused",bestFor:["Fall color enthusiasts","Hikers","Photographers"],countries:["USA"],states:["MA","NH","VT","NY"],days:[{dayNumber:1,label:"Arrive Boston",location:"Boston, MA",type:"arrival",suggestedActivities:["landmark-freedom-trail"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:2,label:"White Mountains",location:"Boston â†’ North Conway, NH",type:"drive",driveTime:"2.5 hours",notes:"Peak foliage at elevation! The Kancamagus is THE place.",suggestedActivities:["drive-kancamagus","foliage-hancock-overlook","hike-sabbaday-falls","landmark-albany-covered-bridge"],flexible:!0},{dayNumber:3,label:"Vermont Colors",location:"North Conway â†’ Chelsea, VT",type:"drive",driveTime:"2 hours",suggestedActivities:["hike-sallys-property","foliage-chelsea-vermont","drive-route-100"],lodging:"lodge-sallys",flexible:!0},{dayNumber:4,label:"Vermont Exploration",location:"Chelsea, VT",type:"explore",suggestedActivities:["hike-sallys-property","food-cold-hollow","food-ben-jerrys"],lodging:"lodge-sallys",flexible:!0},{dayNumber:5,label:"Adirondacks Peak",location:"Chelsea â†’ Lake Placid, NY",type:"drive",driveTime:"2.5 hours",notes:"Adirondacks peak earlyâ€”huge foliage payoff!",suggestedActivities:["foliage-lake-placid","drive-whiteface"],lodging:"lodge-mirror-lake-inn",flexible:!0},{dayNumber:6,label:"Saratoga & Departure",location:"Lake Placid â†’ Saratoga â†’ Albany",type:"drive",driveTime:"2 hours",suggestedActivities:[],flexible:!0}],alternatives:[]},{id:"city-culture",name:"Cities & Culture Route",emoji:"ðŸ™ï¸",source:"research",description:"Focus on Boston and Montreal with light scenic driving in between.",duration:"6-7 days",totalMiles:"~500 miles",driveTime:"~9 hours total",flyIn:"Boston (BOS)",flyOut:"Montreal (YUL)",vibe:"Urban exploration with countryside breaks",bestFor:["City lovers","Food & culture","Less hiking"],countries:["USA","Canada"],states:["MA","ME","VT","QC"],days:[{dayNumber:1,label:"Arrive Boston",location:"Boston, MA",type:"arrival",suggestedActivities:["lobster-neptune"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:2,label:"Boston Deep Dive",location:"Boston, MA",type:"explore",suggestedActivities:["landmark-freedom-trail"],lodging:"lodge-godfrey-boston",flexible:!0},{dayNumber:3,label:"Portland Day Trip",location:"Boston â†’ Portland â†’ Boston or Burlington",type:"drive",driveTime:"2 hours each way",suggestedActivities:["town-portland-old-port","lobster-eventide","food-duckfat"],flexible:!0},{dayNumber:4,label:"Vermont Crossing",location:"Boston â†’ Burlington, VT",type:"drive",driveTime:"3.5 hours",suggestedActivities:["food-cold-hollow"],flexible:!0},{dayNumber:5,label:"Montreal Arrival",location:"Burlington â†’ Montreal, QC",type:"drive",driveTime:"1.5 hours",suggestedActivities:["landmark-notre-dame"],lodging:"lodge-petit-montreal",flexible:!0},{dayNumber:6,label:"Montreal Full Day",location:"Montreal, QC",type:"explore",suggestedActivities:["food-st-viateur","food-schwartzs","hike-mount-royal","food-la-banquise"],lodging:"lodge-petit-montreal",flexible:!0},{dayNumber:7,label:"Departure",location:"Montreal, QC",type:"departure",notes:"Fly home from Montreal.",suggestedActivities:[],flexible:!0}],alternatives:[]},{id:"blank-canvas",name:"Start From Scratch",emoji:"âœ¨",source:"custom",description:"Build your own adventure! Start with a blank slate and add whatever you want.",duration:"You decide",totalMiles:"TBD",driveTime:"TBD",flyIn:"Your choice",flyOut:"Your choice",vibe:"Complete freedom",bestFor:["Control enthusiasts","Unique trips","Customizers"],countries:[],states:[],days:[{dayNumber:1,label:"Day 1",location:"",type:"custom",suggestedActivities:[],flexible:!0},{dayNumber:2,label:"Day 2",location:"",type:"custom",suggestedActivities:[],flexible:!0},{dayNumber:3,label:"Day 3",location:"",type:"custom",suggestedActivities:[],flexible:!0}],alternatives:[]}];function sa(t){return lt.find(a=>a.id===t)}const na="https://miihwxxgqyyotptiihej.supabase.co",ct="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1paWh3eHhncXl5b3RwdGlpaGVqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY4ODg0MDEsImV4cCI6MjA4MjQ2NDQwMX0.lq2BH0iG1891KyvhCcJ0cHJunuLRTcDtk2W1jvQ0V5w",ve=!!ct,oe=ve?wt(na,ct):null,Oe="mmt_shared_trip",dt="mmt-2025-maine";async function ia(t=dt){if(!oe)return{data:null,error:new Error("Supabase not configured")};const{data:a,error:o}=await oe.from(Oe).select("id,state,updated_at").eq("id",t).maybeSingle();return{data:a,error:o}}async function Ve(t,a=dt){if(!oe)return{data:null,error:new Error("Supabase not configured")};const{data:o,error:l}=await oe.from(Oe).upsert({id:a,state:t},{onConflict:"id"}).select("id,state,updated_at").single();return{data:o,error:l}}function ra(t,a){if(!oe)return{unsubscribe:()=>{}};const o=oe.channel(`shared-trip:${t}`).on("postgres_changes",{event:"*",schema:"public",table:Oe,filter:`id=eq.${t}`},l=>{a?.(l)}).subscribe();return{unsubscribe:()=>{oe.removeChannel(o)}}}function la(t){try{const a=localStorage.getItem(t);if(a)return a;const o=globalThis.crypto?.randomUUID?.()||`client-${Date.now()}-${Math.random().toString(16).slice(2)}`;return localStorage.setItem(t,o),o}catch{return`client-${Date.now()}-${Math.random().toString(16).slice(2)}`}}function ca(t){try{const a=localStorage.getItem(t);if(!a)return null;const o=JSON.parse(a);if(Le(o))return o;localStorage.removeItem(t)}catch{}return null}function qe(t,a){try{localStorage.setItem(t,JSON.stringify(a))}catch{}}function da(t){try{const a=localStorage.getItem(t);return a?JSON.parse(a):{}}catch{return{}}}function Ue(t,a){try{localStorage.setItem(t,JSON.stringify(a))}catch{}}function ua(t){try{const a=localStorage.getItem(t);return a?JSON.parse(a):[]}catch{return[]}}function ma(t,a){try{localStorage.setItem(t,JSON.stringify(a))}catch{}}function ha(t,{name:a,emoji:o="+",source:l="custom"}={}){const p=a||t.name||"Custom Trip";return{id:`custom-${Date.now()}`,name:p,emoji:o,source:l,description:`Saved from ${new Date().toLocaleDateString()}`,duration:`${t.days.length} days`,totalMiles:"TBD",driveTime:"TBD",flyIn:"",flyOut:"",vibe:"Personalized plan",bestFor:["Custom"],countries:[],states:[],days:t.days.map(h=>({dayNumber:h.dayNumber,label:h.label,location:h.location,type:h.type,notes:h.notes,suggestedActivities:h.activities,lodging:h.lodging||null,flexible:!0})),alternatives:[]}}function pa(t,a){const o=Array.isArray(a)?a:[];return[...t,...o]}const Be="mmt-2025-trip",Re="mmt-custom-activities",Ye="mmt-custom-templates",ga="mmt-2025-client-id",xe="mmt-2025-maine";function fa(){const t=r.useMemo(()=>ca(Be),[]),[a,o]=r.useState(()=>t?"builder":"moms"),[l,p]=r.useState(()=>da(Re)),[h,d]=r.useState(()=>ua(Ye)),[y,u]=r.useState(ve?"syncing":"offline"),s=r.useMemo(()=>pa(lt,h),[h]),[f,N]=r.useState(()=>{if(t)return t;const E=sa("moms-original");return Fe(E)||Dt({dayCount:7,name:"My New England Trip"})}),M=r.useMemo(()=>It(f.days),[f.days]),A=r.useMemo(()=>{const E=B.stops.reduce((w,T)=>w+T.activities.length,0);return{days:B.stops.length,activities:E}},[]),C=a==="moms"?A:M,v=r.useMemo(()=>la(ga),[]),[g,b]=r.useState(!1),k=r.useRef(f),R=r.useRef(l);r.useEffect(()=>{g||(k.current=f,R.current=l)},[f,l,g]),r.useEffect(()=>{ma(Ye,h)},[h]),r.useEffect(()=>{if(!ve)return;let E=!1,w=null;async function T(){const{data:_,error:j}=await ia(xe);if(E)return;if(j){console.warn("Supabase fetch shared trip failed:",j),b(!0);return}const D=_?.state?.trip,V=_?.state?.customActivities;Le(D)&&D.days.length&&N(D),V&&typeof V=="object"&&p(W=>({...W,...V})),_?.state?.initialized||await Ve({initialized:!0,trip:k.current,customActivities:R.current,updatedBy:v,updatedAt:Date.now()},xe),w=ra(xe,W=>{const $=W?.new?.state;if(!$||$?.updatedBy&&$.updatedBy===v)return;const Q=$?.trip;Le(Q)&&Q.days.length&&(N(Q),qe(Be,Q));const J=$?.customActivities;J&&typeof J=="object"&&(p(J),Ue(Re,J))}),b(!0),u("synced")}return T(),()=>{E=!0,w?.unsubscribe?.()}},[v]),r.useEffect(()=>{if(qe(Be,f),Ue(Re,l),!ve||!g)return;u("syncing");const E=setTimeout(()=>{Ve({initialized:!0,trip:f,customActivities:l,updatedBy:v,updatedAt:Date.now()},xe).then(()=>{u("synced")}).catch(w=>{console.warn("Supabase upsert shared trip failed:",w),u("offline")})},600);return()=>clearTimeout(E)},[f,l,g,v]);const L=E=>{const w=s.find(T=>T.id===E);w&&N(Fe(w))},I=()=>{const E=window.prompt("Name this template",f.name||"Custom Trip");if(!E)return;const w=ha(f,{name:E});d(T=>[...T,w])},F=()=>{L("moms-original"),o("builder")};return e.jsxs("div",{className:"app",children:[e.jsx(jt,{activeView:a,onViewChange:o,tripStats:C,templates:s,selectedTemplateId:f.templateId,onLoadTemplate:E=>{L(E),o("builder")},onSaveTemplate:I,syncStatus:y}),e.jsx("main",{className:"main",children:a==="moms"?e.jsx(At,{onCopyToBuilder:F}):e.jsx(oa,{trip:f,setTrip:N,customActivities:l,setCustomActivities:p})}),e.jsx("footer",{className:"footer",children:e.jsx("p",{children:"Created with love and a lot of lobster. Build the trip that feels right."})})]})}try{const t=document.getElementById("root");if(!t)throw new Error("Root element not found");vt.createRoot(t).render(e.jsx(r.StrictMode,{children:e.jsx(fa,{})}))}catch(t){console.error("Failed to mount React app:",t),document.body.innerHTML+=`<div style="color: red; padding: 20px;">Mount Error: ${t.message}</div>`}
